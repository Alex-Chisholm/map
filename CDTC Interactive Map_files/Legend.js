// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
require({cache:{"esri/widgets/Legend/LegendViewModel":function(){define("../../chunks/tslib.es6 ../../intl ../../core/Accessor ../../core/Collection ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/get ../../views/2d/layers/features/layerAdapters/featureReductionUtils ./support/ActiveLayerInfo ../../intl/locale".split(" "),function(r,H,P,A,q,F,B,J,
N,G,y,d,f,e){const g=A.ofType(f),h=new Set("esri.layers.BuildingSceneLayer esri.layers.CSVLayer esri.layers.FeatureLayer esri.layers.GeoJSONLayer esri.layers.GeoRSSLayer esri.layers.GroupLayer esri.layers.HeatmapLayer esri.layers.ImageryLayer esri.layers.ImageryTileLayer esri.layers.MapImageLayer esri.layers.OGCFeatureLayer esri.layers.OrientedImageryLayer esri.layers.PointCloudLayer esri.layers.StreamLayer esri.layers.SceneLayer esri.layers.SubtypeGroupLayer esri.layers.TileLayer esri.layers.VoxelLayer esri.layers.WFSLayer esri.layers.WMSLayer esri.layers.WMTSLayer esri.layers.WCSLayer esri.layers.LinkChartLayer esri.layers.knowledgeGraph.KnowledgeGraphSublayer".split(" ")),
x=["view.basemapView.baseLayerViews","view.groundView.layerViews","view.layerViews","view.basemapView.referenceLayerViews"];H=class extends P{constructor(k){super(k);this._layerViewByLayerId={};this._layerInfosByLayerViewId={};this._activeLayerInfosByLayerViewId={};this._activeLayerInfosWithNoParent=new A;this.activeLayerInfos=new g;this.keepCacheOnDestroy=this.hideLayersNotInCurrentView=this.groundLegendVisible=this.basemapLegendVisible=!1;this.respectLayerVisibility=!0;this.layerInfos=[];this.view=
null}initialize(){this.addHandles(q.watch(()=>this.view,()=>this._viewHandles(),q.initial),"view");this.addHandles(e.onLocaleChange(()=>this._refresh()))}destroy(){this._destroyViewActiveLayerInfos();this.view=null}get state(){return this.view?.ready?"ready":"disabled"}_viewHandles(){this.removeHandles("state");this.view&&this.addHandles(q.watch(()=>this.state,()=>this._stateHandles(),q.initial),"state")}_stateHandles(){this._resetAll();"ready"===this.state&&this._watchPropertiesAndAllLayerViews()}_resetAll(){this.removeHandles(["all-layer-views",
"legend-properties"]);this._destroyViewActiveLayerInfos();this.activeLayerInfos.removeAll()}_destroyViewActiveLayerInfos(){Object.keys(this._activeLayerInfosByLayerViewId).forEach(this._destroyViewActiveLayerInfo,this)}_destroyViewActiveLayerInfo(k){this.removeHandles(k);const l=this._activeLayerInfosByLayerViewId[k];delete this._activeLayerInfosByLayerViewId[k];l?.parent&&l.parent.children.remove(l)}_watchPropertiesAndAllLayerViews(){var {view:k}=this;k&&({allLayerViews:k}=k,k.length&&this._refresh(),
this.addHandles(k.on("change",l=>this._propertiesChangeHandle()),"all-layer-views"),this.addHandles(q.watch(()=>[this.layerInfos,this.basemapLegendVisible,this.groundLegendVisible],()=>this._propertiesChangeHandle()),"legend-properties"))}_propertiesChangeHandle(){this._destroyViewActiveLayerInfos();this._refresh()}_refresh(){this._layerInfosByLayerViewId={};this.activeLayerInfos.removeAll();this._generateLayerViews().filter(this._filterLayerViewsByLayerInfos,this).filter(this._isLayerViewSupported,
this).forEach(this._generateActiveLayerInfo,this);this._sortActiveLayerInfos(this.activeLayerInfos)}_sortActiveLayerInfos(k){const l=this.view;if(!(2>k.length)&&l){var n=[];k.forEach(E=>{if(!E.parent){var I=E.layer.parent;(I=(I=I&&"uid"in I&&this._layerViewByLayerId[I.uid])&&this._activeLayerInfosByLayerViewId[I.uid])&&k.includes(I)&&(n.push(E),E.parent=I,I.children.add(E),this._sortActiveLayerInfos(I.children))}});k.removeMany(n);var z={};l.allLayerViews.forEach((E,I)=>z[E.layer.uid]=I);k.sort((E,
I)=>(z[I.layer.uid]||0)-(z[E.layer.uid]||0))}}_generateLayerViews(){const k=[];x.filter(this._filterLayerViews,this).map(l=>y.get(this,l)).filter(l=>null!=l).forEach(this._collectLayerViews("layerViews",k));return k}_filterLayerViews(k){const l=!this.groundLegendVisible&&"view.groundView.layerViews"===k;return!(!this.basemapLegendVisible&&("view.basemapView.baseLayerViews"===k||"view.basemapView.referenceLayerViews"===k))&&!l}_collectLayerViews(k,l){const n=z=>{z&&z.forEach(E=>{l.push(E);n(E[k])});
return l};return n}_filterLayerViewsByLayerInfos(k){const l=this.layerInfos;return l&&l.length?l.some(n=>this._hasLayerInfo(n,k)):!0}_hasLayerInfo(k,l){const n=this._isLayerUIDMatching(k.layer,l.layer.uid);n&&(this._layerInfosByLayerViewId[l.uid]=k);return n}_isLayerUIDMatching(k,l){return k&&(k.uid===l||this._hasLayerUID(k.layers,l))}_hasLayerUID(k,l){return k&&k.some(n=>this._isLayerUIDMatching(n,l))}_isLayerViewSupported(k){return h.has(k.layer.declaredClass)?(this._layerViewByLayerId[k.layer.uid]=
k,!0):!1}_generateActiveLayerInfo(k){this._isLayerActive(k)?this._buildActiveLayerInfo(k):(this.removeHandles(k.uid),this.addHandles(q.watch(()=>[k.legendEnabled,k.layer?.legendEnabled],()=>this._layerActiveHandle(k)),k.uid))}_layerActiveHandle(k){this._isLayerActive(k)&&(this.removeHandles(k.uid),this._buildActiveLayerInfo(k))}_isLayerActive(k){return this.respectLayerVisibility?k.legendEnabled&&k.layer?.legendEnabled:!0}_buildActiveLayerInfo(k){const l=k.layer,n=k.uid;var z=this._layerInfosByLayerViewId[n];
let E=this._activeLayerInfosByLayerViewId[n];E||(E=new f({layer:l,layerView:k,title:void 0!==z?.title&&z.layer.uid===l.uid?z.title:l.title,view:this.view,respectLayerVisibility:this.respectLayerVisibility,hideLayersNotInCurrentView:this.hideLayersNotInCurrentView,keepCacheOnDestroy:this.keepCacheOnDestroy,sublayerIds:z?.sublayerIds||[]}),this._activeLayerInfosByLayerViewId[n]=E);E.parent=this._activeLayerInfosByLayerViewId[(l.parent&&"uid"in l.parent?this._layerViewByLayerId[l.parent?.uid]:null)?.uid];
if(!this.hasHandles(n)){z=q.watch(()=>l.title,K=>this._titleHandle(K,E));var I=q.watch(()=>[l.opacity,"renderer"in l&&l.renderer,"pointSymbol"in l&&l.pointSymbol,"lineSymbol"in l&&l.lineSymbol,"polygonSymbol"in l&&l.polygonSymbol],()=>this._constructLegendElements(E)),c=q.when(()=>!0===this.view?.stationary,()=>this._scaleHandle(E),q.initial);const b=q.watch(()=>k.layer?d.getEffectiveFeatureReduction(k.layer,k.view):null,()=>this._constructLegendElements(E)),v=q.watch(()=>k.updating,()=>{null!=k.layer&&
null!=d.getEffectiveFeatureReduction(k.layer,k.view)&&this._constructLegendElements(E)}),D=q.watch(()=>"effect"in l&&l.effect,()=>this._constructLegendElements(E)),p=q.when(()=>this.view?.timeZone,()=>this._constructLegendElements(E),q.initial);z=[z,I,c,b,v,D,p];this.respectLayerVisibility&&(I=q.watch(()=>k.legendEnabled,K=>this._legendEnabledHandle(K,E)),c=q.watch(()=>l.legendEnabled,K=>this._legendEnabledHandle(K,E)),z.push(I,c));this.addHandles(z,n)}E.isScaleDriven||this._constructLegendElements(E);
this._addActiveLayerInfo(E)}_titleHandle(k,l){l.title=k;this._constructLegendElements(l)}_legendEnabledHandle(k,l){k?this._addActiveLayerInfo(l):this._removeActiveLayerInfo(l)}_scaleHandle(k){(k.isScaleDriven||k.hideLayersNotInCurrentView)&&this._constructLegendElements(k)}_addActiveLayerInfo(k){const {layerView:l,layer:n}=k;if(this._isLayerActive(l)&&!this.activeLayerInfos.includes(k)){var z=k.parent;z?(z.children.includes(k)||z.children.push(k),this._sortActiveLayerInfos(z.children)):(z=this.layerInfos?.some(E=>
E.layer.uid===n.uid),n.parent&&"uid"in n.parent&&!z?this._activeLayerInfosWithNoParent.add(k):(this.activeLayerInfos.add(k),this._sortActiveLayerInfos(this.activeLayerInfos)));if(this._activeLayerInfosWithNoParent.length){const E=[];this._activeLayerInfosWithNoParent.forEach(I=>{var c=I.layer.parent;if(c=this._activeLayerInfosByLayerViewId[(c&&"uid"in c?this._layerViewByLayerId[c?.uid]:null)?.uid])E.push(I),I.parent=c});E.length&&(this._activeLayerInfosWithNoParent.removeMany(E),E.forEach(I=>this._addActiveLayerInfo(I)))}}}_removeActiveLayerInfo(k){const l=
k.parent;l?l.children.remove(k):this.activeLayerInfos.remove(k)}_constructLegendElements(k){const l=k.layer;"featureCollections"in l&&l.featureCollections?k.buildLegendElementsForFeatureCollections(l.featureCollections):"featureReduction"in l&&l.featureReduction&&"renderer"in l.featureReduction&&("binning"===l.featureReduction.type||"cluster"===l.featureReduction.type)&&(!this.view||l.featureReduction.maxScale<=this.view.scale)?k.buildLegendElementsForFeatureReduction(l.featureReduction):"renderer"in
l&&l.renderer&&!("sublayers"in l)?k.buildLegendElementsForRenderer(l.renderer):"url"in l&&l.url?k.buildLegendElementsForTools():k.children.forEach(n=>this._constructLegendElements(n))}};r.__decorate([F.property({type:g})],H.prototype,"activeLayerInfos",void 0);r.__decorate([F.property()],H.prototype,"basemapLegendVisible",void 0);r.__decorate([F.property()],H.prototype,"groundLegendVisible",void 0);r.__decorate([F.property()],H.prototype,"hideLayersNotInCurrentView",void 0);r.__decorate([F.property()],
H.prototype,"keepCacheOnDestroy",void 0);r.__decorate([F.property()],H.prototype,"respectLayerVisibility",void 0);r.__decorate([F.property()],H.prototype,"layerInfos",void 0);r.__decorate([F.property({readOnly:!0})],H.prototype,"state",null);r.__decorate([F.property()],H.prototype,"view",void 0);return H=r.__decorate([G.subclass("esri.widgets.Legend.LegendViewModel")],H)})},"esri/views/2d/layers/features/layerAdapters/featureReductionUtils":function(){define(["exports"],function(r){r.getEffectiveFeatureReduction=
function(H,P){return(H=H.featureReduction)&&"selection"!==H.type?!("maxScale"in H&&H.maxScale)||H.maxScale<P.scale?H:null:null};Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/ActiveLayerInfo":function(){define("require ../../../chunks/tslib.es6 ../../../Color ../../../intl ../../../kernel ../../../request ../../../symbols ../../../core/Accessor ../../../core/arrayUtils ../../../core/Collection ../../../core/jsonMap ../../../core/Logger ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/screenUtils ../../../core/urlUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/PropertyOrigin ../../../layers/effects/EffectView ../../../layers/effects/jsonUtils ../../../layers/support/ExportImageParameters ../../../layers/support/layerUtils ../../../layers/support/rasterFormats/pixelRangeUtils ../../../renderers/support/jsonUtils ../../../renderers/support/rendererConversion ../../../renderers/visualVariables/support/SizeVariableLegendOptions ../../../symbols/support/cimSymbolUtils ../../../symbols/support/previewUtils ../../../symbols/support/renderUtils ../../../symbols/support/symbolUtils ../../../symbols/support/utils ./clusterUtils ./colorRampUtils ./heatmapRampUtils ./relationshipRampUtils ./sizeRampUtils ./utils ../../smartMapping/support/utils ../../../symbols/SimpleMarkerSymbol ../../../symbols/SimpleFillSymbol ../../../intl/messages ../../../intl/substitute".split(" "),
function(r,H,P,A,q,F,B,J,N,G,y,d,f,e,g,h,x,k,l,n,z,E,I,c,b,v,D,p,K,M,Q,R,Z,X,u,m,w,S,U,W,ea,ja,aa,la){function V(a){return"esri.renderers.SimpleRenderer"===a.declaredClass}function ba(a){return"esri.renderers.ClassBreaksRenderer"===a.declaredClass}function da(a){return"esri.renderers.UniqueValueRenderer"===a.declaredClass}function ca(a){return"esri.renderers.HeatmapRenderer"===a.declaredClass}function na(a){return"esri.renderers.PointCloudClassBreaksRenderer"===a.declaredClass}function pa(a){return"esri.renderers.PointCloudStretchRenderer"===
a.declaredClass}function sa(a){return"esri.renderers.PointCloudUniqueValueRenderer"===a.declaredClass}function ua(a){return"esri.renderers.DotDensityRenderer"===a.declaredClass}function ya(a){return"esri.renderers.PieChartRenderer"===a.declaredClass}function wa(a){return"esri.layers.SubtypeGroupLayer"===a.declaredClass}function Ea(a){return"esri.layers.MapImageLayer"===a.declaredClass}function Fa(a){a="authoringInfo"in a?a?.authoringInfo:null;return"univariate-color-size"===a?.type&&"above-and-below"===
a?.univariateTheme}async function xa(a,t){const C=await aa.fetchMessageBundle("esri/widgets/Legend/t9n/Legend");"previewTemplateAriaLabel"!==a||t||(a="previewAriaLabel");return la.substitute(C[a],{label:t})}const Aa=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i,Va=new y.JSONMap({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"}),Ka=new ea({size:6,outline:{color:[128,128,128,.5],width:.5}}),
Wa=new ja({style:"solid"}),Xa=new ea({style:"path",path:"M10,5 L5,0 0,5 M5,0 L5,15",size:15,outline:{width:1,color:[85,85,85,1]}});let Ba={};A=class extends J{constructor(a){super(a);this._hasSizeRamp=this._hasOpacityRamp=this._hasColorRamp=!1;this._webStyleSymbolCache=new Map;this._dotDensityUrlCache=new Map;this._scaleDrivenSizeVariable=null;this._hasClusterSizeVariable=!1;this.children=new G;this.layer=this.layerView=null;this.legendElements=[];this.parent=null;this.keepCacheOnDestroy=this.hideLayersNotInCurrentView=
!1;this.respectLayerVisibility=!0;this.sublayerIds=[];this.view=this.title=null}initialize(){const a=()=>this.notifyChange("ready");this.addHandles([e.on(()=>this.children,"change",t=>{const {added:C,removed:L}=t;C.forEach(O=>{const T=`activeLayerInfo-ready-watcher-${O.layer.uid}`;this.addHandles(e.watch(()=>O.ready,a,e.initial),T)});L.forEach(O=>this.removeHandles(O.layer.uid));a()})]);this.keepCacheOnDestroy||(Ba={})}destroy(){this._scaleDrivenSizeVariable=this._dotDensityUrlCache=this._webStyleSymbolCache=
null;this.keepCacheOnDestroy||(Ba=null)}get effectList(){const a=this.layer;let t=null;"effect"in a&&a.effect&&(t=new z.EffectView,t.effect=a.effect,t.endTransitions(),t.scale=this.scale);return t}get opacity(){const a=this.layer.opacity,t=this.parent?.opacity;var C=this.layer.parent;C=C&&"uid"in C?this._getParentLayerOpacity(C):null;return null!=t?t*a:null!=C?C*a:a}get ready(){return null===this.layer?!0:0<this.children.length?this._isGroupActive():0<this.legendElements.length}get scale(){return this.view?.scale??
0}get isScaleDriven(){const a=this.layer;if(null===a)return!1;if("effect"in a&&a.effect&&Array.isArray(a.effect))return!0;if("featureReduction"in a&&a.featureReduction){if("cluster"===a.featureReduction.type)return!0;if("binning"===a.featureReduction.type&&"renderer"in a.featureReduction&&a.featureReduction.renderer)return this._isRendererScaleDriven(a.featureReduction.renderer)}return"renderer"in a&&a.renderer?this._isRendererScaleDriven(a.renderer):this._isLayerScaleDriven(this.layer)}get version(){return this._get("version")+
1}async buildLegendElementsForFeatureCollections(a){if(this.hideLayersNotInCurrentView&&!await this._isLayerInCurrentView())this.legendElements=[],this.notifyChange("ready");else{a=Array.from(a,t=>{if(c.isFeatureLayer(t))return this._getRendererLegendElements(t.renderer,{title:t.title});if(t.featureSet?.features.length){var C=t.layerDefinition,L=C?.drawingInfo;L=L&&v.fromJSON(L.renderer);C=Va.read(C.geometryType);return L?this._getRendererLegendElements(L,{title:t.name,geometryType:C}):(d.getLogger(this).warn("drawingInfo not available!"),
null)}return null});try{const t=[],C=await Promise.allSettled(a);for(const L of C)if("fulfilled"===L.status)for(const O of L.value??[])t.push(O);this.legendElements=t;this.notifyChange("ready")}catch(t){d.getLogger(this).warn("error while building legend for layer!",t)}}}async buildLegendElementsForRenderer(a){try{this.legendElements=(this.hideLayersNotInCurrentView?await this._isLayerInCurrentView():1)?await this._getRendererLegendElements(a):[],this.notifyChange("ready")}catch(t){d.getLogger(this).warn("error while building legend for layer!",
t)}}async buildLegendElementsForFeatureReduction(a){try{this.legendElements=(this.hideLayersNotInCurrentView?await this._isLayerInCurrentView():1)?await this._getLegendElementsForFeatureReduction(a):[],this.notifyChange("ready")}catch(t){d.getLogger(this).warn("error while building legend for layer!",t)}}async buildLegendElementsForTools(){const a=this.layer;if("esri.layers.VoxelLayer"===a.declaredClass)this._constructLegendElementsForVoxelLayer();else if("esri.layers.WMTSLayer"===a.declaredClass)this._constructLegendElementsForWMTSlayer();
else if("esri.layers.WMSLayer"===a.declaredClass)await this._constructLegendElementsForWMSSublayers();else if("esri.layers.BuildingSceneLayer"===a.declaredClass)await this._constructLegendElementsForBuildingSceneLayer();else if(Ea(a)||"esri.layers.TileLayer"===a.declaredClass||wa(a))await this._constructLegendElementsForSublayers();else{this.removeHandles("imageryLayers-watcher");var t="default";if("esri.layers.ImageryLayer"===a.declaredClass){t=a?.rasterFunction?.functionName||"default";const C=
a.bandIds?.length?a.bandIds.join(""):"###";t=t+"_"+C}"esri.layers.ImageryTileLayer"!==a.declaredClass&&await this._getLegendLayers(`${a.uid}-${t}`).then(async C=>{this.legendElements=[];this.notifyChange("ready");C=C.map(async L=>{if("esri.layers.ImageryLayer"===a.declaredClass){const O=e.watch(()=>["renderingRule"in a&&a.rasterFunction,a.bandIds],()=>f.debounce(async()=>{Ba["default"]=null;a.renderer?await this.buildLegendElementsForRenderer(a.renderer):await this.buildLegendElementsForTools()})());
this.addHandles(O,"imageryLayers-watcher")}(L=this._generateSymbolTableElementForLegendLayer(L))&&L.infos.length&&("esri.layers.ImageryLayer"===a.declaredClass&&(L.title=a.title),this.legendElements.push(L));this.notifyChange("ready")});await Promise.allSettled(C)}).catch(C=>{d.getLogger(this).warn("Request to server for legend has failed!",C)})}}async _isLayerInCurrentView(){const a=this.layer,t=this.layerView,C=t&&"createQuery"in t&&"queryFeatureCount"in t;if(!(C||t&&"createQuery"in a&&"queryFeatureCount"in
a))return!0;await e.whenOnce(()=>!t.updating);const L=C?"createQuery"in t&&t.createQuery():"createQuery"in a&&a.createQuery();if(!L)return!0;L.geometry=this.view.extent;return 0!==(C?"queryFeatureCount"in t&&await t.queryFeatureCount(L):"queryFeatureCount"in a&&await a.queryFeatureCount(L))}_getParentLayerOpacity(a){let t=1;const C=a.parent;C&&"uid"in C&&(t=this._getParentLayerOpacity(C));return a.opacity*t}_isGroupActive(){return this.children.some(a=>a.ready)}_isRendererScaleDriven(a){return"dot-density"===
a.type||Aa.test("valueExpression"in a?a.valueExpression:null)||("visualVariables"in a?a.visualVariables:null)?.some(t=>this._isScaleDrivenSizeVariable(t))?!0:this._hasScaleDrivenSymbols(a)}_hasScaleDrivenSymbols(a){switch(a.type){case "simple":return this._isScaleDrivenSymbol(a.symbol);case "class-breaks":return this._isScaleDrivenSymbol(a.defaultSymbol)||a.classBreakInfos.some(t=>this._isScaleDrivenSymbol(t.symbol));case "unique-value":return this._isScaleDrivenSymbol(a.defaultSymbol)||!!a.uniqueValueInfos?.some(t=>
this._isScaleDrivenSymbol(t.symbol))}return!1}_isScaleDrivenSymbol(a){if("cim"===a?.type){const {primitiveOverrides:t,minScale:C,maxScale:L}=a.data;a=t?.some(O=>/\$view\.scale/.test(O.valueExpressionInfo?.expression||""))??!1;return null!=C||null!=L||a}return!1}_isScaleDrivenSizeVariable(a){if(a&&"size"!==a.type)return!1;const t=a.minSize,C=a.maxSize;return"object"===typeof t&&t&&this._isScaleDrivenSizeVariable(t)||"object"===typeof C&&C&&this._isScaleDrivenSizeVariable(C)?!0:!!a.expression||Aa.test(a.valueExpression)}_isLayerScaleDriven(a){if("minScale"in
a&&0<a.minScale||"maxScale"in a&&0<a.maxScale)return!0;if("sublayers"in a&&a.sublayers)return a.sublayers.some(C=>this._isLayerScaleDriven(C));const t=a.parent;if(!1===a.loaded&&t&&Ea(t)&&"source"in a&&a.source&&"map-layer"===a.source.type)for(const C of t.sourceJSON.layers??[])if(C.id===a.source.mapLayerId&&(0<C.minScale||0<C.maxScale))return!0;return!1}async _constructLegendElementsForVoxelLayer(){this.legendElements=[];this.removeHandles("voxel-style-watcher");this.removeHandles("voxel-current-variable");
const a=this.layer;this.addHandles(e.watch(()=>a.currentVariableId,()=>this._constructLegendElementsForVoxelLayer()),"voxel-current-variable");this.addHandles(e.watch(()=>a.getVariableStyles(),()=>this._constructLegendElementsForVoxelLayer()),"voxel-style-watcher");var t=a.getVariableStyle(null);const C=[];if(t)if(t.uniqueValues?.length){const O=[];t.uniqueValues.forEach(T=>{T.enabled&&O.push({label:T.label||`${T.value}`,value:T.value,symbol:new ja({color:T.color,outline:null})})});O.length&&C.push({type:"symbol-table",
title:t.label,infos:O})}else if(t.transferFunction){const {colorStops:O,stretchRange:T}=t.transferFunction,Y=O.toArray().reverse(),fa=T.map((ka,ha)=>`${0===ha?U.specialCharsLessThan:U.specialCharsGreaterThan} ${W.formatNumberLabel(ka)}`).reverse(),qa=Y.map(ka=>({color:ka.color,value:null,label:null}));qa[0].label=fa[0];qa[qa.length-1].label=fa[1];C.push({type:"color-ramp",title:t.label,infos:qa,preview:R.renderColorRampPreviewHTML(Y.map(ka=>ka.color),{ariaLabel:await xa("previewColorRampAriaLabel")})})}const L=
a.opacity;t=C.reduce((O,T)=>[...O,...this._getAllInfos(T)],[]).filter(O=>!!O?.symbol).map(O=>this._getSymbolPreview(O,L));await Promise.allSettled(t);this.legendElements=C;this.notifyChange("ready")}_constructLegendElementsForWMTSlayer(){this.legendElements=[];this.removeHandles("wmts-activeLayer-watcher");const a=this.layer.activeLayer;this.addHandles(e.watch(()=>{const {layer:C}=this;return C&&"activeLayer"in C&&C.activeLayer},()=>this._constructLegendElementsForWMTSlayer()),"wmts-activeLayer-watcher");
const t=a.styleId?a.styles?.find(({id:C})=>C===a.styleId)?.legendUrl:void 0;t&&(this.legendElements=[{type:"symbol-table",title:a.title,infos:[{src:t,opacity:this.opacity}]}]);this.notifyChange("ready")}async _constructLegendElementsForWMSSublayers(){this.legendElements=[];this.removeHandles("wms-sublayers-watcher");const a=this.layer;let t=null;if(a.customParameters||a.customLayerParameters)t={...a.customParameters,...a.customLayerParameters};this.addHandles(e.watch(()=>{const {layer:C}=this;return C&&
"sublayers"in C&&C.sublayers},()=>this._constructLegendElementsForWMSSublayers()),"wms-sublayers-watcher");this.legendElements=await this._generateLegendElementsForWMSSublayers(a.sublayers,t);this.notifyChange("ready")}async _generateLegendElementsForWMSSublayers(a,t){const C=this.layer,L=[];this.addHandles(a.on("change",()=>this._constructLegendElementsForWMSSublayers()),"wms-sublayers-watcher");const O=this.sublayerIds?.map(T=>C.findSublayerById(T))?.filter(N.isSome)??[];a=O.length?O:a.toArray();
for(const T of a)if(a=e.watch(()=>[T.title,T.visible,T.legendEnabled],()=>this._constructLegendElementsForWMSSublayers()),this.addHandles(a,"wms-sublayers-watcher"),!this.respectLayerVisibility||T.visible&&T.legendEnabled)a=await this._generateSymbolTableElementForWMSSublayer(T,t),a?.infos.length&&L.unshift(a);return L}async _generateSymbolTableElementForWMSSublayer(a,t){return!a.legendUrl&&a.sublayers?(t=(await this._generateLegendElementsForWMSSublayers(a.sublayers,t)).filter(C=>C),{type:"symbol-table",
title:a.title,infos:t}):this._generateSymbolTableElementForLegendUrl(a,t)}async _generateSymbolTableElementForLegendUrl(a,t){let C=a.legendUrl;if(C){var L={type:"symbol-table",title:a.title||a.name||String(a.id??""),infos:[]};t&&(C=h.addQueryParameters(C,t));t=null;a=a.layer?.opacity;try{if(t=(await F(C,{responseType:"image"})).data)t.style.opacity=a}catch{}L.infos.push({src:C,preview:t,opacity:a});return L}}_getLegendLayers(a,t){const C=Ba&&Ba[a];return C?Promise.resolve(C):this._legendRequest(t).then(L=>
{L=L.layers;return Ba[a]=L})}_legendRequest(a){var t=this.layer;a={f:"json",dynamicLayers:a};if("esri.layers.ImageryLayer"===t.declaredClass){var C=t.exportImageServiceParameters.rasterFunction;C&&(a.renderingRule=JSON.stringify(C.functionDefinition?.toJSON()||C.toJSON()));t.bandIds&&(a.bandIds=t.bandIds.join());if(t.raster||t.viewId||t.customParameters){const {raster:L,viewId:O,customParameters:T}=t;a={raster:L,viewId:O,...a,...T}}}C=t.url.replace(/(\/)+$/,"");"version"in t&&10.01<=+t.version?(t=
C.indexOf("?"),C=-1<t?C.substring(0,t)+"/legend"+C.substring(t):C+"/legend"):(t=C.toLowerCase().indexOf("/rest/"),t=C.substring(0,t)+C.substring(t+5,C.length),C="https://utility.arcgis.com/sharing/tools/legend?soapUrl\x3d"+encodeURI(t)+"\x26returnbytes\x3dtrue");return F(C,{query:a}).then(L=>L.data)}async _constructLegendElementsForBuildingSceneLayer(){this.legendElements=[];this.removeHandles("sublayers-watcher");const a=this.layer;this.addHandles(e.watch(()=>a.sublayers,()=>this._constructLegendElementsForBuildingSceneLayer()),
"sublayers-watcher");try{this.legendElements=await this._generateLegendElementsForBuildingSublayers(a.sublayers,this.opacity),this.notifyChange("ready")}catch(t){d.getLogger(this).warn("Request to server for legend has failed!",t)}}async _generateLegendElementsForBuildingSublayers(a,t){let C=[];this.addHandles(a.on("change",()=>this._constructLegendElementsForBuildingSceneLayer()),"sublayers-watcher");a=a.toArray();for(const O of a)if(a=e.watch(()=>["renderer"in O&&O.renderer,O.opacity,O.title,O.visible],
()=>this._constructLegendElementsForBuildingSceneLayer()),this.addHandles(a,"sublayers-watcher"),!this.respectLayerVisibility||O.visible){a=null!=O?.opacity?O.opacity:null;var L=null!=a?a*t:t;"building-group"===O.type?(a={type:"symbol-table",title:O.title,infos:[]},L=await this._generateLegendElementsForBuildingSublayers(O.sublayers,L),a.infos.push(...L),C=[a,...C]):O.renderer&&(C=[...(await this._getRendererLegendElements(O.renderer,{title:O.title,opacity:L,sublayer:O})),...C])}return C.filter(O=>
!!O&&("infos"in O&&O.infos?0<O.infos.length:!0))}async _constructLegendElementsForSublayers(){this.legendElements=[];this.removeHandles("sublayers-watcher");const a=this.layer;if(Ea(a)||"esri.layers.TileLayer"===a.declaredClass||wa(a)){this.addHandles(e.watch(()=>a.sublayers,()=>this._constructLegendElementsForSublayers),"sublayers-watcher");try{this.legendElements=await this._generateLegendElementsForSublayers(a.sublayers,this.opacity),this.notifyChange("ready")}catch(t){d.getLogger(this).warn("Request to server for legend has failed!",
t)}}}async _generateLegendElementsForSublayers(a,t,C){const L=this.layer;let O=[];this.addHandles(a.on("change",()=>this._constructLegendElementsForSublayers()),"sublayers-watcher");a=a.toArray();!C&&this.sublayerIds&&this.sublayerIds.length&&(a=wa(L)?this.sublayerIds.map(T=>L.findSublayerForSubtypeCode(T)).filter(N.isSome):this.sublayerIds.map(T=>L.findSublayerById(T)).filter(N.isSome));for(const T of a)if(a=e.watch(()=>[T.renderer,T.opacity,T.title,T.visible,T.legendEnabled],()=>this._constructLegendElementsForSublayers()),
this.addHandles(a,"sublayers-watcher"),!this.respectLayerVisibility||T.visible&&T.legendEnabled&&this._isSublayerInScale(T)){a=null!=T?.opacity?T.opacity:null;a=null!=a?a*t:t;const Y="sublayers"in T?T.originIdOf("renderer")>n.OriginId.SERVICE&&!T.sublayers:!0;T.renderer&&Y?(await T.load(),O=[...(await this._getRendererLegendElements(T.renderer,{title:T.title,opacity:a,sublayer:T})),...O]):"sublayers"in T&&(a=await this._generateSymbolTableElementForSublayer(T,a,C))&&O.unshift(a)}return O.filter(T=>
!!T&&("infos"in T&&T.infos?0<T.infos.length:!0))}async _generateSymbolTableElementForSublayer(a,t,C){if(!C){C=new Map;var L=this.layer,O=a.source;let T=null;if(O&&("map-layer"!==O.type||O.mapLayerId!==a.id||O.gdbVersion&&O.gdbVersion!==("gdbVersion"in L&&L.gdbVersion))||a.originIdOf("renderer")>n.OriginId.SERVICE||a.originIdOf("labelingInfo")>n.OriginId.SERVICE||a.originIdOf("labelsVisible")>n.OriginId.SERVICE)O=new I.ExportImageParameters({layer:this.layer}),T=O.hasDynamicLayers?O.dynamicLayers:
null,O.destroy();(await this._getLegendLayers(T||`${L.uid}-default`,T)).forEach(Y=>C.set(Y.layerId,Y))}L=C.get(a.id);return(!L||L?.subLayerIds&&L.defaultVisibility)&&a.sublayers?(t=await this._generateLegendElementsForSublayers(a.sublayers,t,C),{type:"symbol-table",title:a.title,infos:t}):this._generateSymbolTableElementForLegendLayer(L,a,t)}_generateSymbolTableElementForLegendLayer(a,t,C){if(!a?.legend||this.respectLayerVisibility&&!this._isLegendLayerInScale(a,t))return null;var L=t?.renderer;let O=
t?.title||a.layerName;L&&(!t||t?.originIdOf("renderer")>n.OriginId.SERVICE)&&(L=t?.title||this._getRendererTitle(L,t))&&(O&&"string"!==typeof L&&"title"in L&&(L.title=O),O=L);const T={type:"symbol-table",title:O,legendType:a.legendType||null,infos:[]},Y=t?this._sanitizeLegendForSublayer(a.legend.slice(),t):a.legend;a.legendGroups&&0<a.legendGroups.length?a.legendGroups.forEach(fa=>{const qa={type:"symbol-table",title:fa.heading,legendType:a.legendType||null,infos:this._generateSymbolTableElementInfosForLegendLayer(Y.filter(ka=>
ka.groupId===fa.id),a.layerId,C)};0<qa.infos?.length&&T.infos.push(qa)}):T.infos=this._generateSymbolTableElementInfosForLegendLayer(Y,a.layerId,C);return 0<T.infos.length?T:null}_generateSymbolTableElementInfosForLegendLayer(a,t,C){return a.map(L=>{let O=L.url;if(L.imageData&&0<L.imageData.length)O=`data:image/png;base64,${L.imageData}`;else if(0!==O.indexOf("http"))O=q.addTokenParameter(`${this.layer.url}/${t}/images/${O}`);else return null;return{label:L.label,src:O,opacity:null==C?this.opacity:
C,width:L.width,height:L.height}}).filter(N.isSome)}_isSublayerInScale(a){const t=a.minScale||0;a=a.maxScale||0;return 0<t&&t<this.scale||a>this.scale?!1:!0}_isLegendLayerInScale(a,t){t=t||this.layer;let C=null,L=null,O=!0;!t.minScale&&0!==t.minScale||!t.maxScale&&0!==t.maxScale?(0===a.minScale&&t.tileInfo&&(C=t.tileInfo.lods[0].scale),0===a.maxScale&&t.tileInfo&&(L=t.tileInfo.lods[t.tileInfo.lods.length-1].scale)):(C=Math.min(t.minScale,a.minScale)||t.minScale||a.minScale,L=Math.max(t.maxScale,a.maxScale));
if(0<C&&C<this.scale||L>this.scale)O=!1;return O}_sanitizeLegendForSublayer(a,t){if("version"in this.layer&&10.1>+this.layer.version||0===a.length)return a;t=t.renderer;let C=0,L=null;a.some(O=>O.values)&&a.some((O,T)=>{O.values||(C=T,L=O,L.label||(L.label="others"));return null!=L});t?"unique-value"===t.type?L&&(a.splice(C,1),a.push(L)):"class-breaks"===t.type&&(L&&a.splice(C,1),a.reverse(),L&&a.push(L)):L&&(a.splice(C,1),a.push(L));return a}async _getRendererLegendElements(a,t={}){var C=this.view;
C=V(a)||ba(a)||da(a)||ca(a)||ua(a)||ya(a)?"2d"===C.type||D.isSupportedRenderer3D(a):"raster-stretch"===a.type||"raster-colormap"===a.type||"raster-shaded-relief"===a.type||na(a)||pa(a)||sa(a)||"vector-field"===a.type||"flow"===a.type;if(!C)return d.getLogger(this).warn(`Renderer of type '${a.type}' not supported!`),[];if(na(a)||pa(a)||sa(a)||"esri.renderers.PointCloudRGBRenderer"===a.declaredClass)return this._constructPointCloudRendererLegendElements(a,t);if(ua(a))return this._constructDotDensityRendererLegendElements(a);
a=await this._loadRenderer(a);return ya(a)?this._constructPieChartRendererLegendElements(a):this._constructRendererLegendElements(a,t)}async _getLegendElementsForFeatureReduction(a){let t=null;"binning"===a.type?t=a.renderer:"cluster"===a.type&&(t=this._getClusterRenderer(a));return t?this._getRendererLegendElements(t):[]}_getPointCloudRendererTitle(a){return(a.legendOptions?.title||a.field)??""}async _constructPointCloudRendererLegendElements(a,t={}){var C=t.title;t=[];let L=null;var O=null;if(na(a))L=
{type:"symbol-table",title:C||this._getPointCloudRendererTitle(a),infos:[]},a.colorClassBreakInfos.forEach(T=>{L.infos.unshift({label:T.label||T.minValue+" - "+T.maxValue,value:[T.minValue,T.maxValue],symbol:this._getAppliedCloneSymbol(Ka,T.color)})});else if(pa(a)){O=a.stops;let T=null;if(O?.length&&(1===O.length&&(T=O[0].color),!T)){const Y=O[0].value,fa=O[O.length-1].value;null!=Y&&null!=fa&&(T=u.getColorFromPointCloudStops(Y+(fa-Y)/2,O))}L={type:"symbol-table",title:null,infos:[{label:null,value:null,
symbol:this._getAppliedCloneSymbol(Ka,T||Ka.color)}]};O=u.getRampStopsForPointCloud(a.stops??[])??[];O={type:"color-ramp",title:C||this._getPointCloudRendererTitle(a),infos:O,preview:R.renderColorRampPreviewHTML(O.map(Y=>Y.color),{ariaLabel:await xa("previewColorRampAriaLabel")})}}else sa(a)&&(L={type:"symbol-table",title:C||this._getPointCloudRendererTitle(a),infos:[]},a.colorUniqueValueInfos?.forEach(T=>{L.infos.push({label:T.label||T.values.join(", "),value:T.values.join(", "),symbol:this._getAppliedCloneSymbol(Ka,
T.color)})}));L&&L.infos.length&&t.push(L);O&&O.infos.length&&t.push(O);C=t.reduce((T,Y)=>[...T,...(Y.infos??[])],[]).filter(T=>!!T.symbol).map(T=>this._getSymbolPreview(T,this.opacity,{symbolConfig:{applyColorModulation:!!a.colorModulation}}));await Promise.allSettled(C);return t}async _getElementInfoForDotDensity(a,t){const {color:C,label:L,valueExpressionTitle:O}=t,{backgroundColor:T,outline:Y,dotSize:fa}=a;t=this.effectList?.effects.map(ha=>ha.toJSON());var qa=E.effectFunctionsFromJSON(t);t=await xa("previewTemplateAriaLabel",
L||O);qa=fa+"-"+C+"-"+T+"-"+(Y&&JSON.stringify(Y.toJSON()))+"-"+qa;const ka=this._dotDensityUrlCache;a=ka.has(qa)?ka.get(qa):R.renderDotDensityPreviewHTML(a,C,{ariaLabel:t});ka.set(qa,a);t=Q.renderSymbol([[{shape:{type:"image",x:0,y:0,width:a.width,height:a.height,src:a.src},fill:null,stroke:null,offset:[0,0]}]],[a.width,a.height],{effectView:this.effectList,ariaLabel:t});return{opacity:1,src:a.src,preview:t,width:a.width,height:a.height}}async _constructDotDensityRendererLegendElements(a){var t=
a.calculateDotValue(this.view.scale);t={type:"symbol-table",title:{value:t&&Math.round(t),unit:a.legendOptions?.unit||""},infos:[]};for(const C of a.attributes){const L=await this._getElementInfoForDotDensity(a,C);L.label=C.label||C.valueExpressionTitle||C.field;t.infos.push(L)}return[t]}async _constructPieChartRendererLegendElements(a){const t=this.layer.opacity,C=[];let L=null;const O=a.outline;a.attributes.forEach(fa=>{const qa=new ea({color:fa.color,outline:O});C.push({label:fa.label||fa.valueExpressionTitle||
fa.field,symbol:qa})});var T=C.length?[...C]:[];if(a.othersCategory?.color&&0!==a.othersCategory?.threshold){var Y=new ea({color:a.othersCategory.color,outline:O});L=a.othersCategory.label||"Other";C.push({label:L,symbol:Y})}a.defaultColor?.a&&(Y=new ea({color:a.defaultColor,outline:O}),C.push({label:a.defaultLabel,symbol:Y}));Y=await this._getVisualVariableLegendElements(a,this.layer)||[];C.length&&(Y.unshift({type:"symbol-table",title:null,infos:C}),T=T.filter(fa=>fa.label!==L).map(fa=>fa.symbol.color).filter(Boolean),
T=R.renderPieChartPreviewHTML(T,{holePercentage:a.holePercentage,backgroundColor:a.backgroundFillSymbol?.color,effectList:this.effectList,outline:O,ariaLabel:await xa("previewPieChartAriaLabel")}),Y.unshift({type:"pie-chart-ramp",title:this._getRendererTitle(a,this.layer),infos:C,preview:T}));a=Y.reduce((fa,qa)=>[...fa,...this._getAllInfos(qa)],[]).filter(fa=>!!fa?.symbol&&!fa?.preview).map(fa=>this._getSymbolPreview(fa,t,{effectList:this.effectList}));await Promise.allSettled(a);return Y}async _constructRendererLegendElements(a,
t={}){const {title:C,sublayer:L}=t,O=L||this.layer;this._hasSizeRamp=this._hasOpacityRamp=this._hasColorRamp=!1;this._scaleDrivenSizeVariable=null;const T=await this._getVisualVariableLegendElements(a,O)||[],Y={type:"symbol-table",title:C||this._getRendererTitle(a,O),infos:[]};let fa=null,qa=!1;const ka=new Set;if("flow"!==a.type||this._hasSizeRamp)if("univariate-color-size"===("authoringInfo"in a?a?.authoringInfo:null)?.type){var ha=C,oa=Fa(a)?"univariate-above-and-below-ramp":"univariate-color-size-ramp",
ra=T.findIndex(ia=>"color-ramp"===ia.type);ra=-1!==ra?T.splice(ra,1)[0]:null;var ma=T.findIndex(ia=>"size-ramp"===ia.type);ma=-1!==ma?T.splice(ma,1)[0]:null;var va=[];ra&&(ha=ra.title,va.push(ra));ma&&(ha=ma.title,va.push(ma));0<va.length&&T.push({type:oa,title:ha,infos:va})}else if(ca(a))ha=m.getHeatmapRampStops(a),T.push({type:"heatmap-ramp",title:C||this._getRendererTitle(a,O),infos:ha,preview:R.renderColorRampPreviewHTML(ha.map(ia=>ia.color),{effectList:this.effectList,ariaLabel:await xa("previewColorRampAriaLabel")})});
else if(da(a)){if((oa=a&&a.authoringInfo)&&"relationship"===oa.type){const {numClasses:ia,field1:ta,field2:za}=oa;oa=oa.focus;if(ia&&ta&&za){ma=[ta,za];ra=w.getRotationAngleForFocus(oa)||0;for(ha of ma){const {field:Na,normalizationField:Ga,label:La}=ha;ma=La||{field:this._getFieldAlias(Na,O),normField:Ga&&this._getFieldAlias(Ga,O)};va=Xa.clone();va.angle=ra;Y.infos.push({label:ma,symbol:va});ka.add(va);ra+=90}ha=w.getRelationshipRampElement({focus:oa,numClasses:ia,infos:a.uniqueValueInfos??[]});
T.unshift(ha)}}else if("esri.layers.ImageryLayer"===this.layer.declaredClass||"esri.layers.ImageryTileLayer"===this.layer.declaredClass)a.uniqueValueInfos?.forEach(ia=>{ia.symbol&&Y.infos.push({label:ia.label||ia.value,value:ia.value,symbol:ia.symbol})});else{const {field:ia,field2:ta,field3:za,fieldDelimiter:Na,valueExpression:Ga,defaultSymbol:La}=a,Ya=!(!ia&&!Ga||!ta&&!za),Ca=[];a.uniqueValueGroups?.forEach(Qa=>{const Oa={type:"symbol-table",title:Qa.heading,infos:[]};Qa.classes?.forEach(Da=>{const {symbol:Ra,
values:Za}=Da;if(Ra){var Ha=[],Ia=[];for(const $a of Za??[]){const {value:Sa,value2:Ta,value3:Ua}=$a,Ja=[],Ma=[];if(ia||Ga)Ja.push(Sa),Ma.push(this._getDomainName(ia,Sa,O));ta&&(Ja.push(Ta),Ma.push(this._getDomainName(ta,Ta,O)));za&&(Ja.push(Ua),Ma.push(this._getDomainName(za,Ua,O)));Ha.push(Ya?Ja.join(Na||""):Ja[0]);Ia.push(Ma.join(" - "))}Ha=Ha.join(", ");Da=Da.label;Da||(Ia=Ia.filter(Boolean),Da=Ia.length?Ia.join(", "):Ha);Oa.infos.push({label:Da,value:Ha,symbol:Ra})}});Oa.infos.length&&Ca.push(Oa)});
Ca.length&&(ha=Ca[0],1===Ca.length&&"title"in ha&&!ha.title?Y.infos.push(...(ha.infos??[])):(La&&(Ca.push({type:"symbol-table",infos:[{label:a.defaultLabel||"others",symbol:La}]}),qa=!0),Y.infos.push(...Ca)),C||a.legendOptions?.title||a.valueExpressionTitle||(Y.title=null))}a.defaultSymbol&&!qa&&(Y.infos.push({label:a.defaultLabel||"others",symbol:a.defaultSymbol}),qa=!0)}else if(ba(a))fa=this._isUnclassedRenderer(a),fa&&this._hasSizeRamp||(a.classBreakInfos.forEach(ia=>{ia.symbol&&Y.infos.unshift({label:ia.label||
(fa?null:ia.minValue+" - "+ia.maxValue),value:[ia.minValue,ia.maxValue],symbol:ia.symbol})}),fa&&(Y.title=null),this._updateInfosForClassedSizeRenderer(a,Y.infos)),a.defaultSymbol&&!fa&&(Y.infos.push({label:a.defaultLabel||"others",symbol:a.defaultSymbol}),qa=!0);else if("raster-stretch"===a.type)if("esri.layers.ImageryTileLayer"===this.layer.declaredClass||"esri.layers.WCSLayer"===this.layer.declaredClass)ha=await this._constructTileImageryStretchRendererElements(a),"stretch-ramp"===ha.type?T.push(ha):
Y.infos=ha;else{ha=this.layer;a.statistics?.length&&(ra=a.statistics[0],U.isRasterBandStatistics(ra)?(oa=ra.min,ra=ra.max):[oa,ra]=ra);ma=[];ma=ha.serviceRasterInfo;if(ha.rasterFunction)try{ma=await ha.generateRasterInfo(ha.rasterFunction)}catch{}va=b.getPixelValueRange(ma.pixelType);if(1===ma.bandCount)ha=ha.bandIds?.[0]||0,oa=null!=oa?oa:ma.statistics?ma.statistics[ha].min:va[0],ra=null!=ra?ra:ma.statistics?ma.statistics[ha].max:va[1],oa||ra?T.push(await this._getStretchLegendElements(a,{min:oa,
max:ra})):this._getServerSideLegend();else if(ha.bandIds&&1===ha.bandIds.length)oa=null!=oa?oa:ma.statistics?ma.statistics[ha.bandIds[0]].min:va[0],ra=null!=ra?ra:ma.statistics?ma.statistics[ha.bandIds[0]].max:va[1],oa||ra?T.push(await this._getStretchLegendElements(a,{min:oa,max:ra})):this._getServerSideLegend();else if(3<=ma.bandCount){const {bandInfos:ia}=ma;({bandIds:oa}=ha);ia.length>=ma.bandCount?3===oa?.length?(ma=oa.map(ta=>ia[ta].name),Y.infos=this._createSymbolTableElementMultiBand(ma)):
"lerc"===ha.format?(ma=[0,1,2].map(ta=>ia[ta].name),Y.infos=this._createSymbolTableElementMultiBand(ma)):this._getServerSideLegend():"lerc"===ha.format?(ma=["band1","band2","band3"],Y.infos=this._createSymbolTableElementMultiBand(ma)):this._getServerSideLegend()}else this._getServerSideLegend()}else if("raster-colormap"===a.type)a.colormapInfos.forEach(ia=>{Y.infos.push({label:ia.label,value:ia.value,symbol:this._getAppliedCloneSymbol(Wa,ia.color)})});else if(V(a)){ha=a.symbol;switch(t.geometryType){case "point":ha=
"pointSymbol"in O?O.pointSymbol:null;break;case "polyline":ha="lineSymbol"in O?O.lineSymbol:null;break;case "polygon":ha="polygonSymbol"in O?O.polygonSymbol:null}oa=this._hasClusterSizeVariable&&this._getClusterSymbol()||!this._hasSizeRamp;a.symbol&&oa&&Y.infos.push({label:a.label,symbol:ha})}else"vector-field"===a.type?(a.outputUnit&&(this.title="("+a.toJSON().outputUnit+")"),Y.title=a.attributeField,ha=a.getClassBreakInfos(),ha?.length?ha.forEach(ia=>{Y.infos.push({label:ia.minValue+" - "+ia.maxValue,
symbol:ia.symbol})}):Y.infos.push({label:a.attributeField,symbol:a.getDefaultSymbol()})):"raster-shaded-relief"===a.type&&T.push(await this._getStretchLegendElements(a,{min:0,max:255}));else ha=await U.getSymbolForFlowRenderer(a),Y.infos.push({label:null,symbol:ha});const Pa=a.defaultSymbol;!Pa||qa||V(a)||fa&&!this._hasColorRamp&&!this._hasSizeRamp&&!this._hasOpacityRamp||T.push({type:"symbol-table",infos:[{label:a.defaultLabel||"others",symbol:Pa}]});Y.infos.length&&T.unshift(Y);const ab=null==t.opacity?
this.opacity:t.opacity,bb=this._isTallSymbol("visualVariables"in a?a.visualVariables:null),cb="esri.layers.ImageryLayer"===this.layer.declaredClass||"esri.layers.ImageryTileLayer"===this.layer.declaredClass;t=T.reduce((ia,ta)=>[...ia,...this._getAllInfos(ta)],[]).filter(ia=>!!ia?.symbol).filter(ia=>{if("cim"===ia.symbol.type){const {minScale:ta,maxScale:za}=ia.symbol.data;if(ta&&ta<this.scale||za&&za>this.scale)return!1}return!0}).map(ia=>this._getSymbolPreview(ia,ab,{isDefault:ia.symbol===Pa,applyScaleDrivenSize:!ka.has(ia.symbol),
symbolConfig:{isTall:bb,isSquareFill:cb},effectList:ka.has(ia.symbol)?null:this.effectList}));a=null;await Promise.allSettled(t);return T}_getServerSideLegend(){setTimeout(()=>this.buildLegendElementsForTools(),0)}_getAllInfos(a){const t=a?.infos;return t?t.reduce((C,L)=>C.concat(this._getAllInfos(L)),[]):[a]}async _constructTileImageryStretchRendererElements(a){const t=this.layer,C=t.symbolizer.rasterInfo??t.raster.rasterInfo;var L;if(L=a?.statistics?.length?a.statistics:C?.statistics){var O=L[0];
U.isRasterBandStatistics(O)?(L=O.min,O=O.max):[L,O]=O}else O=b.getPixelValueRange(C.pixelType),L=O[0],O=O[1];t.hasStandardTime()&&(L=t.getStandardTimeValue(L),O=t.getStandardTimeValue(O));if(1===C.bandCount||1===t.bandIds?.length)return this._getStretchLegendElements(a,{min:L,max:O});a=(t?.bandIds?.length?t.bandIds:Array.from(Array(Math.min(C.bandCount,3)).keys())).map(T=>C.bandInfos[T].name);3>a.length?a.push(a[1]):3<a.length&&a.splice(3);return this._createSymbolTableElementMultiBand(a)}async _getStretchLegendElements(a,
t){a=u.getStretchRampStops(a.colorRamp,t);return{type:"stretch-ramp",title:"",infos:a,preview:R.renderColorRampPreviewHTML(a.map(C=>C.color),{ariaLabel:await xa("previewColorRampAriaLabel")})}}_getClusterSymbol(){var a=this.layer;const t=(a="featureReduction"in a&&a.featureReduction)&&"symbol"in a&&a.renderer;return t&&!0!==t?.authoringInfo?.isAutoGenerated?null:a&&"symbol"in a?a.symbol:null}async _getSizeLegendElement(a,t,C,L){return{type:"size-ramp",title:this._hasClusterSizeVariable?this._getClusterTitle(t):
a,infos:await S.getRampStops(C,t,await U.getMedianColor(C),this.scale,this.view,L,this._hasClusterSizeVariable?this._getClusterSymbol():null)}}_createSymbolTableElementMultiBand(a){const t=[],C=["red","green","blue"];a.forEach((L,O)=>{t.push({label:{colorName:C[O],bandName:L},src:U.rgbImgSource[O],opacity:this.opacity??1})});return t}_updateInfosForClassedSizeRenderer(a,t){const C=a.authoringInfo&&"class-breaks-size"===a.authoringInfo.type,L=a.classBreakInfos.some(O=>Z.isVolumetricSymbol(O.symbol));
if(C&&L){const O=S.realWorldMaxSize;a=a.classBreakInfos.length;const T=(O-S.realWorldMinSize)/(1<a?a-1:a);t.forEach((Y,fa)=>{Y.size=O-T*fa})}}_isTallSymbol(a){let t=!1,C=!1;if(a)for(let L=0;L<a.length&&(!t||!C);L++){const O=a[L];"size"===O.type&&("height"===O.axis&&(t=!0),"width-and-depth"===O.axis&&(C=!0))}return t&&C}async _getSymbolPreview(a,t,C){var L=!C?.isDefault&&null==a.size&&this._hasSizeRamp?g.px2pt(M.SymbolSizeDefaults.size):a.size;this._scaleDrivenSizeVariable&&C?.applyScaleDrivenSize&&
({getSize:L}=await new Promise((O,T)=>r(["../../../renderers/visualVariables/support/visualVariableUtils"],O,T)),L=L(this._scaleDrivenSizeVariable,null,{view:this.view.type,scale:this.scale,shape:"simple-marker"===a.symbol.type?a.symbol.style:null}));return R.renderPreviewHTML(a.symbol,{size:L,opacity:t,scale:!1,symbolConfig:C?.symbolConfig,effectView:C?.effectList,style:"legend",cimOptions:{allowScalingUp:!C?.isDefault&&this._hasSizeRamp||!(!this._scaleDrivenSizeVariable||!C?.applyScaleDrivenSize),
viewParams:this.isScaleDriven?{viewingMode:"2d"===this.view?.type?"map":this.view?.viewingMode,scale:this.view?.scale}:null},ariaLabel:a.label&&"string"!==typeof a.label?null:await xa("previewTemplateAriaLabel",a.label)}).then(O=>{a.preview=O;return a}).catch(()=>{a.preview=null;return a})}_getClusterRenderer(a){this._hasClusterSizeVariable=!1;var t="renderer"in this.layer?this.layer.renderer:null;t=a.renderer?.clone()||t?.clone();const C=X.getEffectiveClusterSizeVariable(a,this.layerView,this.view);
if(C&&null!=t&&"visualVariables"in t&&!t.visualVariables?.some(L=>"size"===L.type&&"outline"!==L.target&&!Aa.test(L.valueExpression))){if("clusterMinSize"in a&&"clusterMaxSize"in a){const {clusterMinSize:L,clusterMaxSize:O}=a;C.legendOptions=new p({showLegend:L!==O})}t.visualVariables=(t.visualVariables||[]).concat([C]);this._hasClusterSizeVariable=!0}return t}async _loadRenderer(a){const t=[],C=a.clone(),L=await U.getMedianColor(C);if(ba(C)||da(C))a=(C.classBreakInfos||C.uniqueValueInfos).map(O=>
this._fetchSymbol(O.symbol,L).then(T=>{O.symbol=T}).catch(()=>{O.symbol=null})),Array.prototype.push.apply(t,a);t.push(this._fetchSymbol(C.symbol||C.defaultSymbol,C.defaultSymbol?null:L).then(O=>{this._applySymbolToRenderer(C,O,V(C))}).catch(()=>{this._applySymbolToRenderer(C,null,V(C))}));await Promise.allSettled(t);return C}_applySymbolToRenderer(a,t,C){C?a.symbol=t:a.defaultSymbol=t}async _fetchSymbol(a,t){if(!a)throw Error();if("web-style"===a.type){const C=this._webStyleSymbolCache;try{const L=
await ("2d"===this.view.type?a.fetchCIMSymbol({cache:C}):a.fetchSymbol({cache:C}));return this._getAppliedCloneSymbol(L,t)}catch{throw d.getLogger(this).warn("Fetching web-style failed!"),Error();}}return this._getAppliedCloneSymbol(a,t)}_getAppliedCloneSymbol(a,t){if(!a||!t)return a;a=a.clone();const C=t&&t.toRgba();a.type.includes("3d")?this._applyColorTo3dSymbol(a,C):"cim"===a.type?K.applyCIMSymbolColor(a,t):a.color&&(a.color=new P(C||a.color));return a}_applyColorTo3dSymbol(a,t){t&&a.symbolLayers.forEach(C=>
{C&&(C.material||(C.material={}),C.material.color=new P(t))})}async _getVisualVariableLegendElements(a,t){if(!("visualVariables"in a&&a.visualVariables)||"vector-field"===a.type)return null;var C=a.visualVariables,L=[];const O=[],T=[];for(const ka of C)"color"===ka.type?L.push(ka):"size"===ka.type?O.push(ka):"opacity"===ka.type&&T.push(ka);C=[...L,...O,...T];let Y;if(0===L.length&&ba(a)&&a.classBreakInfos&&1===a.classBreakInfos.length)var fa=(fa=a.classBreakInfos[0])&&fa.symbol;0===L.length&&V(a)&&
(fa=a.symbol);fa&&(fa.type.includes("3d")?(L=fa.symbolLayers.at(0),"water"===L.type?null!=L.color&&(Y=L.color):null!=L.material?.color&&(Y=L.material.color)):fa.url||(Y=fa.color));const qa=this.effectList;return(await Promise.all(C.map(async ka=>{if(!ka.legendOptions||!1!==ka.legendOptions.showLegend){const ha="flow"===a.type?ka.field:this._getRampTitle(ka,t);let oa=null;const ra=U.getDateFormatOptions(t,ka,this.view.timeZone);"color"===ka.type?(ka=await u.getRampStops(ka,null,ra)??[],oa={type:"color-ramp",
title:ha,infos:ka,preview:R.renderColorRampPreviewHTML(ka.map(ma=>ma.color),{effectList:qa,ariaLabel:await xa("previewColorRampAriaLabel")})},this._hasColorRamp||(this._hasColorRamp=0<ka.length)):"size"===ka.type&&"outline"!==ka.target?Aa.test(ka.valueExpression)?this._hasClusterSizeVariable||(this._scaleDrivenSizeVariable=ka):(oa=await this._getSizeLegendElement(ha,ka,a,ra),this._hasSizeRamp||(this._hasSizeRamp=!(null==oa.infos||!oa.infos.length))):"opacity"===ka.type&&(ka=await u.getRampStops(ka,
Y,ra)??[],oa={type:"opacity-ramp",title:ha,infos:ka,preview:R.renderColorRampPreviewHTML(ka.map(ma=>ma.color),{effectList:qa,ariaLabel:await xa("previewColorRampAriaLabel")})},this._hasOpacityRamp||(this._hasOpacityRamp=0<ka.length));return oa&&oa.infos?oa:null}}))).filter(N.isSome)}_getDomainName(a,t,C){return a&&"function"!==typeof a?(C=(a="getField"in C&&C.getField?.(a))&&"getFieldDomain"in C&&C.getFieldDomain?C.getFieldDomain(a.name):null,"coded-value"===C?.type?C.getName(t):null):null}_getClusterTitle(a){var t=
this.layer;a=a.field;if("featureReduction"in t&&t.featureReduction&&"cluster"===t.featureReduction.type&&(t=t.featureReduction,t=(t="popupTemplate"in t&&t.popupTemplate)&&t.fieldInfos))for(const C of t)if(C.fieldName===a)return"cluster_count"===a?C.label||{showCount:!0}:C.label;return{showCount:!0}}_getRampTitle(a,t){let C=a.field,L=a.normalizationField,O=!1,T=!1,Y=!1;var fa=null;C="function"===typeof C?null:C;L="function"===typeof L?null:L;fa=a.legendOptions?.title;if(null==fa)if(a.valueExpressionTitle)fa=
a.valueExpressionTitle;else{if("renderer"in t&&t.renderer&&"authoringInfo"in t.renderer&&t.renderer.authoringInfo?.visualVariables)for(a=t.renderer.authoringInfo.visualVariables,fa=0;fa<a.length;fa++){const qa=a[fa];if("color"===qa.type){if("ratio"===qa.style){O=!0;break}if("percent"===qa.style){T=!0;break}if("percent-of-total"===qa.style){Y=!0;break}}}fa={field:C&&this._getFieldAlias(C,t),normField:L&&this._getFieldAlias(L,t),ratio:O,ratioPercent:T,ratioPercentTotal:Y}}return fa}_getRendererTitle(a,
t){if(a.legendOptions?.title)return a.legendOptions.title;if(a.valueExpressionTitle)return a.valueExpressionTitle;var C=a.field;let L=null,O=null;ba(a)&&(L=a.normalizationField,O="percent-of-total"===a.normalizationType);C="function"===typeof C?null:C;L="function"===typeof L?null:L;if(da(a)){const {field2:T,field3:Y,fieldDelimiter:fa}=a;C=C&&this._getFieldAlias(C,t);T&&(C=`<${C}>${fa}<${this._getFieldAlias(T,t)}>`,Y&&(C=`${C}${fa}<${this._getFieldAlias(Y,t)}>`));return C}a=null;if(C||L)a={field:C&&
this._getFieldAlias(C,t),normField:L&&this._getFieldAlias(L,t),normByPct:O};return a}_getFieldAlias(a,t){let C=("popupTemplate"in t?t.popupTemplate:null)?.fieldInfos?.find(Y=>a===Y.fieldName),L=null;"getField"in t&&t.getField?L=t.getField(a):"fieldsIndex"in t&&t.fieldsIndex&&(L=t.fieldsIndex.get(a));let O=null;if(t="featureReduction"in t&&t.featureReduction)C??="popupTemplate"in t?t.popupTemplate?.fieldInfos?.find(Y=>a?.toLowerCase()===Y.fieldName?.toLowerCase()):void 0,"fields"in t&&t.fields&&(O=
t.fields.find(Y=>Y.name?.toLowerCase()===a?.toLowerCase()));t=C||L||O;let T=null;t&&(T=C?.label||L?.alias||O?.alias||"name"in t&&t.name||"fieldName"in t&&t.fieldName||null);return T}_isUnclassedRenderer(a){const t=a.visualVariables;let C=!1;ba(a)&&a.classBreakInfos&&1===a.classBreakInfos.length&&t&&(C=a.field?t.some(L=>!(!L||a.field!==L.field||(a.normalizationField||L.normalizationField)&&a.normalizationField!==L.normalizationField)):!!t.length);return C}};H.__decorate([x.property()],A.prototype,
"children",void 0);H.__decorate([x.property({readOnly:!0})],A.prototype,"effectList",null);H.__decorate([x.property()],A.prototype,"layerView",void 0);H.__decorate([x.property()],A.prototype,"layer",void 0);H.__decorate([x.property()],A.prototype,"legendElements",void 0);H.__decorate([x.property({readOnly:!0})],A.prototype,"opacity",null);H.__decorate([x.property()],A.prototype,"parent",void 0);H.__decorate([x.property({readOnly:!0,dependsOn:[]})],A.prototype,"ready",null);H.__decorate([x.property()],
A.prototype,"hideLayersNotInCurrentView",void 0);H.__decorate([x.property()],A.prototype,"keepCacheOnDestroy",void 0);H.__decorate([x.property()],A.prototype,"respectLayerVisibility",void 0);H.__decorate([x.property({readOnly:!0})],A.prototype,"scale",null);H.__decorate([x.property()],A.prototype,"sublayerIds",void 0);H.__decorate([x.property({readOnly:!0})],A.prototype,"isScaleDriven",null);H.__decorate([x.property()],A.prototype,"title",void 0);H.__decorate([x.property({readOnly:!0,dependsOn:["ready"],
value:0})],A.prototype,"version",null);H.__decorate([x.property()],A.prototype,"view",void 0);return A=H.__decorate([l.subclass("esri.widgets.Legend.support.ActiveLayerInfo")],A)})},"esri/layers/effects/EffectView":function(){define("exports ../../chunks/tslib.es6 ../../core/Accessor ../../core/has ../../core/lang ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/subclass ./parser ./utils".split(" "),function(r,H,P,A,q,F,B,J,N,G){function y(e){e=
N.parse(e)||[];var g=(g=e[0])?"type"in g:!1;return g?[{scale:-1,effects:e}]:e}function d(e,g,h){return e[0]?.effects&&g[0]?.effects?(-1===e[0]?.scale||-1===g[0]?.scale)&&(1<e.length||1<g.length)&&0>=h?!1:G.canInterpolateEffects(e[0].effects,g[0].effects):!0}function f(e,g,h){const x=e.length>g.length?e:g;e=e.length>g.length?g:e;var k=e[e.length-1];g=k?.scale??h;k=k?.effects??[];for(let l=e.length;l<x.length;l++)e.push({scale:g,effects:[...k]});for(g=0;g<x.length;g++)e[g].scale=-1===e[g].scale?h:e[g].scale,
x[g].scale=-1===x[g].scale?h:x[g].scale,G.normalizeEffects(e[g].effects,x[g].effects)}r.EffectView=class extends P{constructor(e){super(e);this._final=this._to=this._from=null;this._current=[];this._time=0;this.duration=A("mapview-transitions-duration");this.effects=[]}set effect(e){const g=this._get("effect");e=e||"";if(g!==e){this._set("effect",e);try{this._transitionTo(y(e))}catch(h){this._transitionTo([]),F.getLogger(this).warn("Invalid Effect",{effect:e,error:h})}}}get hasEffects(){return this.transitioning||
!!this.effects.length}set scale(e){this._updateForScale(e)}get transitioning(){return null!==this._to}canTransitionTo(e){try{return 0<this.scale&&d(this._current,y(e),this.scale)}catch{return!1}}transitionStep(e,g){this._applyTimeTransition(e);this._updateForScale(g)}endTransitions(){this._applyTimeTransition(this.duration)}_transitionTo(e){0<this.scale&&d(this._current,e,this.scale)?(this._final=e,this._to=q.clone(e),f(this._current,this._to,this.scale),this._from=q.clone(this._current),this._time=
0):(this._from=this._to=this._final=null,this._current=e);this._set("effects",this._current[0]?q.clone(this._current[0].effects):[])}_applyTimeTransition(e){if(this._to&&this._from&&this._current&&this._final){this._time+=e;e=Math.min(1,this._time/this.duration);for(let h=0;h<this._current.length;h++){const x=this._current[h],k=this._from[h],l=this._to[h];var g=k.scale;x.scale=g+(l.scale-g)*e;for(g=0;g<x.effects.length;g++)x.effects[g].interpolate(k.effects[g],l.effects[g],e)}1===e&&(this._current=
this._final,this._set("effects",this._current[0]?q.clone(this._current[0].effects):[]),this._from=this._to=this._final=null)}}_updateForScale(e){this._set("scale",e);if(0!==this._current.length){var g=this._current,h=this._current.length-1,x,k=1;if(1===g.length||e>=g[0].scale)var l=x=g[0].effects;else if(e<=g[h].scale)l=x=g[h].effects;else for(let n=0;n<h;n++){const z=g[n],E=g[n+1];if(z.scale>=e&&E.scale<=e){k=(e-z.scale)/(E.scale-z.scale);x=z.effects;l=E.effects;break}}for(e=0;e<this.effects.length;e++)this.effects[e].interpolate(x[e],
l[e],k)}}};H.__decorate([B.property()],r.EffectView.prototype,"_to",void 0);H.__decorate([B.property()],r.EffectView.prototype,"duration",void 0);H.__decorate([B.property({value:""})],r.EffectView.prototype,"effect",null);H.__decorate([B.property({readOnly:!0})],r.EffectView.prototype,"effects",void 0);H.__decorate([B.property({readOnly:!0})],r.EffectView.prototype,"hasEffects",null);H.__decorate([B.property({value:0})],r.EffectView.prototype,"scale",null);H.__decorate([B.property({readOnly:!0})],
r.EffectView.prototype,"transitioning",null);r.EffectView=H.__decorate([J.subclass("esri.layers.effects.EffectView")],r.EffectView);r.canInterpolateEffectStops=d;r.convertEffectToStops=y;r.normalizeEffectStops=f;Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/ExportImageParameters":function(){define("exports ../../chunks/tslib.es6 ../../core/Accessor ../../core/sql ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../geometry/support/scaleUtils ./commonProperties ./floorFilterUtils ./sublayerUtils".split(" "),
function(r,H,P,A,q,F,B,J,N,G,y,d,f){const e={visible:"visibleSublayers",definitionExpression:"layerDefs",labelingInfo:"hasDynamicLayers",labelsVisible:"hasDynamicLayers",opacity:"hasDynamicLayers",minScale:"visibleSublayers",maxScale:"visibleSublayers",renderer:"hasDynamicLayers",source:"hasDynamicLayers"};r.ExportImageParameters=class extends P{constructor(g){super(g);this.floors=null;this.scale=0}destroy(){this.layer=null}get dynamicLayers(){if(!this.hasDynamicLayers)return null;const g=this.visibleSublayers.map(h=>
{const x=d.getLayerFloorFilterClause(this.floors,h);return h.toExportImageJSON(x)});return g.length?JSON.stringify(g):null}get hasDynamicLayers(){return this.layer&&f.isExportDynamic(this.visibleSublayers,this.layer.serviceSublayers,this.layer.gdbVersion)}set layer(g){this._get("layer")!==g&&(this._set("layer",g),this.removeHandles("layer"),g&&this.addHandles([g.allSublayers.on("change",()=>this.notifyChange("visibleSublayers")),g.on("sublayer-update",h=>this.notifyChange(e[h.propertyName]))],"layer"))}get layers(){const g=
this.visibleSublayers;return g?g.length?"show:"+g.map(h=>h.id).join(","):"show:-1":null}get layerDefs(){const g=!!this.floors?.length,h=this.visibleSublayers.filter(x=>null!=x.definitionExpression||g&&null!=x.floorInfo);return h.length?JSON.stringify(h.reduce((x,k)=>{var l=d.getLayerFloorFilterClause(this.floors,k);l=A.sqlAnd(l,k.definitionExpression);null!=l&&(x[k.id]=l);return x},{})):null}get version(){this.commitProperty("layers");this.commitProperty("layerDefs");this.commitProperty("dynamicLayers");
this.commitProperty("timeExtent");const g=this.layer;g&&(g.commitProperty("dpi"),g.commitProperty("imageFormat"),g.commitProperty("imageTransparency"),g.commitProperty("gdbVersion"));return(this._get("version")||0)+1}get visibleSublayers(){const g=[];if(!this.layer)return g;var h=this.layer.sublayers;const x=this.scale,k=l=>{l.visible&&(0===x||G.isInScaleRange(x,l.minScale,l.maxScale))&&(l.sublayers?l.sublayers.forEach(k):g.unshift(l))};h&&h.forEach(k);h=this._get("visibleSublayers");return!h||h.length!==
g.length||h.some((l,n)=>g[n]!==l)?g:h}toJSON(){var g=this.layer;g={dpi:g.dpi,format:g.imageFormat,transparent:g.imageTransparency,gdbVersion:g.gdbVersion||null};this.hasDynamicLayers&&this.dynamicLayers?g.dynamicLayers=this.dynamicLayers:g={...g,layers:this.layers,layerDefs:this.layerDefs};return g}};H.__decorate([q.property({readOnly:!0})],r.ExportImageParameters.prototype,"dynamicLayers",null);H.__decorate([q.property()],r.ExportImageParameters.prototype,"floors",void 0);H.__decorate([q.property({readOnly:!0})],
r.ExportImageParameters.prototype,"hasDynamicLayers",null);H.__decorate([q.property()],r.ExportImageParameters.prototype,"layer",null);H.__decorate([q.property({readOnly:!0})],r.ExportImageParameters.prototype,"layers",null);H.__decorate([q.property({readOnly:!0})],r.ExportImageParameters.prototype,"layerDefs",null);H.__decorate([q.property({type:Number})],r.ExportImageParameters.prototype,"scale",void 0);H.__decorate([q.property(y.combinedViewLayerTimeExtentProperty)],r.ExportImageParameters.prototype,
"timeExtent",void 0);H.__decorate([q.property({readOnly:!0})],r.ExportImageParameters.prototype,"version",null);H.__decorate([q.property({readOnly:!0})],r.ExportImageParameters.prototype,"visibleSublayers",null);r.ExportImageParameters=H.__decorate([N.subclass("esri.layers.mixins.ExportImageParameters")],r.ExportImageParameters);Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/scaleUtils":function(){define(["exports","../../core/mathUtils","../../core/unitUtils"],
function(r,H,P){function A(q,F){F=P.getMetersPerUnitForSR(F);return q/(F*P.inchesPerMeter*96)}r.getExtentForScale=function(q,F){const B=q.extent;q=q.width-(q.padding?q.padding.left+q.padding.right:0);F=A(F,B.spatialReference);return B.clone().expand(F*q/B.width)};r.getResolutionForScale=A;r.getResolutionInMetersForScale=function(q){return q/(96*P.inchesPerMeter)};r.getScale=function(q,F){F=F||q.extent;q=q.width;const B=P.getMetersPerUnitForSR(F?.spatialReference);return F&&q?F.width/q*B*P.inchesPerMeter*
96:0};r.getScaleForResolution=function(q,F){F=P.getMetersPerUnitForSR(F);return q*F*P.inchesPerMeter*96};r.isInScaleRange=function(q,F,B){if(F=0===F||H.floatEqualAbsolute(q,F)||q<F)F=0===B||H.floatEqualAbsolute(q,B)||q>B;return F};Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/floorFilterUtils":function(){define(["exports"],function(r){function H(P,A){if(!P?.length)return null;P=P.filter(q=>""!==q).map(q=>`'${q}'`);P.push("''");return`${A} IN (${P.join(",")}) OR ${A} IS NULL`}
r.getFloorFilterClause=function(P){const A=P.layer;return"floorInfo"in A&&A.floorInfo?.floorField&&"floors"in P.view?H(P.view.floors,A.floorInfo.floorField):null};r.getLayerFloorFilterClause=function(P,A){return"floorInfo"in A&&A.floorInfo?.floorField?H(P,A.floorInfo.floorField):null};Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/sublayerUtils":function(){define(["exports","../../core/accessorSupport/PropertyOrigin"],function(r,H){function P(A,q){if(!A?.length||
null==q)return!0;q=q.slice().reverse().flatten(({sublayers:J})=>J&&J.toArray().reverse()).map(J=>J.id).toArray();if(A.length>q.length)return!1;let F=0;const B=q.length;for(const {id:J}of A){for(;F<B&&q[F]!==J;)F++;if(F>=B)return!1}return!0}r.isExportDynamic=function(A,q,F){return A.some(B=>{const J=B.source;return!(!J||"map-layer"===J.type&&J.mapLayerId===B.id&&(null==J.gdbVersion||J.gdbVersion===F))||B.originIdOf("renderer")>H.OriginId.SERVICE||B.originIdOf("labelingInfo")>H.OriginId.SERVICE||B.originIdOf("opacity")>
H.OriginId.SERVICE||B.originIdOf("labelsVisible")>H.OriginId.SERVICE})?!0:!P(A,q)};r.isSublayerOverhaul=function(A){return!!A&&A.some(q=>null!=q.minScale||null!=q.layerDefinition?.minScale)};r.shouldWriteSublayerStructure=function(A,q,F){return q.flatten(({sublayers:B})=>B).length!==A.length||A.some(B=>B.originIdOf("minScale")>F||B.originIdOf("maxScale")>F||B.originIdOf("renderer")>F||B.originIdOf("labelingInfo")>F||B.originIdOf("opacity")>F||B.originIdOf("labelsVisible")>F||B.originIdOf("source")>
F)?!0:!P(A,q)};Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/pixelRangeUtils":function(){define(["exports"],function(r){function H(A){return P[A]??[-3.4028234663852886E38,3.4028234663852886E38]}const P={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],f32:[-3.4028234663852886E38,3.4028234663852886E38],f64:[-Number.MAX_VALUE,Number.MAX_VALUE],unknown:void 0,c64:void 0,
c128:void 0};r.convertNoDataToMask=function(A,q,F){if(!(A.depthCount&&1<A.depthCount)){var {pixels:B,statistics:J,pixelType:N}=A,G=B[0].length,y=A.bandMasks??[];G=A.mask??(new Uint8Array(G)).fill(255);var d="f32"===N||"f64"===N,f=H(N),e=!1;for(let x=0;x<B.length;x++){const k="number"===typeof q?q:q[x];if(null==k)continue;var g=J?.[x]?.maxValue??f[1];if((J?.[x]?.minValue??f[0])>k+Number.EPSILON||g<k-Number.EPSILON)continue;g=y[x]||G.slice();const l=B[x];var h=F?.customFloatTolerance;if(d&&0!==h){h||=
9.999999E37<=Math.abs(k)?2E-7*Math.abs(k):"f32"===N?2**-23:Number.EPSILON;for(let n=0;n<l.length;n++)g[n]&&Math.abs(l[n]-k)<h&&(l[n]=0,g[n]=0,G[n]=0,e=!0)}else for(h=0;h<l.length;h++)g[h]&&l[h]===k&&(l[h]=0,g[h]=0,G[h]=0,e=!0);y[x]=g}e&&(A.bandMasks=A.bandMasks||1<A.pixels.length?y:null,A.mask=G);e&&"updateStatistics"in A&&A.updateStatistics()}};r.getIntegerPixelType=function(A,q){return null==A||null==q?"s32":0>A?-128<=A&&128>q?"s8":-32768<=A&&32768>q?"s16":"s32":256>q?"u8":65536>q?"u16":"u32"};
r.getPixelValueRange=H;r.isIntegerPixelType=function(A){return(A?.startsWith("s")||A?.startsWith("u"))??!1};Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/rendererConversion":function(){define(["exports","../../core/arrayUtils","../../core/has","../../core/Error","../../symbols/support/symbolConversion"],function(r,H,P,A,q){function F(G){return null==G||"simple"===G.type||"unique-value"===G.type||"class-breaks"===G.type||"dictionary"===G.type||"heatmap"===
G.type}function B(G,y){if(!y)return null;y=Array.isArray(y)?y:[y];if(0<y.length){const d=y.map(e=>e.details.symbol.type||e.details.symbol.declaredClass).filter(e=>!!e);d.sort();const f=[];d.forEach((e,g)=>{0!==g&&e===d[g-1]||f.push(e)});return new A("renderer-conversion-3d:unsupported-symbols",`Renderer contains symbols (${f.join(", ")}) which are not supported in 3D`,{renderer:G,symbolErrors:y})}return null}function J(G,y){const d={...q.defaultTo3DOptions,...y};y=G.uniqueValueInfos?.map(e=>q.to3D(e.symbol,
d).error).filter(H.isSome);const f=q.to3D(G.defaultSymbol,d);f.error&&y?.unshift(f.error);return B(G,y)}function N(G){const y=G.classBreakInfos.map(f=>q.to3D(f.symbol).error).filter(H.isSome),d=q.to3D(G.defaultSymbol);d.error&&y.unshift(d.error);return B(G,y)}r.isSupportedRenderer3D=F;r.validateTo3D=function(G,y){if(null==G)return null;if(!F(G))return new A("renderer-conversion-3d:unsupported-renderer",`Unsupported renderer of type '${G.type||G.declaredClass}'`,{renderer:G});switch(G.type){case "simple":return B(G,
q.to3D(G.symbol).error);case "unique-value":return J(G,y);case "class-breaks":return N(G)}return null};Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/cimSymbolUtils":function(){define(["exports","../../Color","../cim/utils"],function(r,H,P){function A(d){d=P.toCIMSymbolJSON(d);if("CIMTextSymbol"===d?.type)return d.height??0;let f=0;if(d?.symbolLayers)for(const e of d.symbolLayers)P.isCIMMarker(e)&&null!=e.size&&e.size>f?f=e.size:P.isCIMStroke(e)&&null!=e.width&&
e.width>f?f=e.width:P.isCIMFill(e);return f}function q(d,f,e,g){if(d)if("CIMTextSymbol"===d.type)null!=d.height&&(d.height*=f);else{if(e&&d.effects)for(const h of d.effects)J(h,f);if(d.symbolLayers)for(const h of d.symbolLayers)switch(h.type){case "CIMPictureMarker":case "CIMVectorMarker":F(h,f,g);break;case "CIMPictureStroke":case "CIMSolidStroke":!g?.preserveOutlineWidth&&h.width&&(h.width*=f);break;case "CIMPictureFill":h.height&&(h.height*=f);h.offsetX&&(h.offsetX*=f);h.offsetY&&(h.offsetY*=f);
break;case "CIMHatchFill":q(h.lineSymbol,f,!0,{...g,preserveOutlineWidth:!1}),h.offsetX&&(h.offsetX*=f),h.offsetY&&(h.offsetY*=f),h.separation&&(h.separation*=f)}}}function F(d,f,e){if(d&&(d.markerPlacement&&B(d.markerPlacement,f),d.offsetX&&(d.offsetX*=f),d.offsetY&&(d.offsetY*=f),d.anchorPoint&&"Absolute"===d.anchorPointUnits&&(d.anchorPoint={x:d.anchorPoint.x*f,y:d.anchorPoint.y*f}),d.size=null!=d.size?d.size*f:0,"CIMVectorMarker"===d.type&&d.markerGraphics))for(const g of d.markerGraphics)d.scaleSymbolsProportionally||
q(g.symbol,f,!0,e)}function B(d,f){P.isCIMMarkerStrokePlacement(d)&&d.offset&&(d.offset*=f);switch(d.type){case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineSameSize":d.customEndingOffset&&(d.customEndingOffset*=f);d.offsetAlongLine&&(d.offsetAlongLine*=f);if(d.placementTemplate&&d.placementTemplate.length){var e=d.placementTemplate.map(g=>g*f);d.placementTemplate=e}break;case "CIMMarkerPlacementAlongLineVariableSize":d.maxRandomOffset&&(d.maxRandomOffset*=f);d.placementTemplate&&
d.placementTemplate.length&&(e=d.placementTemplate.map(g=>g*f),d.placementTemplate=e);break;case "CIMMarkerPlacementOnLine":d.startPointOffset&&(d.startPointOffset*=f);break;case "CIMMarkerPlacementAtExtremities":d.offsetAlongLine&&(d.offsetAlongLine*=f);break;case "CIMMarkerPlacementAtRatioPositions":d.beginPosition&&(d.beginPosition*=f);d.endPosition&&(d.endPosition*=f);break;case "CIMMarkerPlacementPolygonCenter":d.offsetX&&(d.offsetX*=f);d.offsetY&&(d.offsetY*=f);break;case "CIMMarkerPlacementInsidePolygon":d.offsetX&&
(d.offsetX*=f),d.offsetY&&(d.offsetY*=f),d.stepX&&(d.stepX*=f),d.stepY&&(d.stepY*=f)}}function J(d,f){switch(d.type){case "CIMGeometricEffectArrow":case "CIMGeometricEffectDonut":d.width&&(d.width*=f);break;case "CIMGeometricEffectBuffer":d.size&&(d.size*=f);break;case "CIMGeometricEffectCut":d.beginCut&&(d.beginCut*=f);d.endCut&&(d.endCut*=f);d.middleCut&&(d.middleCut*=f);break;case "CIMGeometricEffectDashes":d.customEndingOffset&&(d.customEndingOffset*=f);d.offsetAlongLine&&(d.offsetAlongLine*=
f);if(d.dashTemplate&&d.dashTemplate.length){const e=d.dashTemplate.map(g=>g*f);d.dashTemplate=e}break;case "CIMGeometricEffectExtension":case "CIMGeometricEffectJog":case "CIMGeometricEffectRadial":d.length&&(d.length*=f);break;case "CIMGeometricEffectMove":d.offsetX&&(d.offsetX*=f);d.offsetY&&(d.offsetY*=f);break;case "CIMGeometricEffectOffset":case "CIMGeometricEffectOffsetTangent":d.offset&&(d.offset*=f);break;case "CIMGeometricEffectRegularPolygon":d.radius&&(d.radius*=f);break;case "CIMGeometricEffectTaperedPolygon":d.fromWidth&&
(d.fromWidth*=f);d.length&&(d.length*=f);d.toWidth&&(d.toWidth*=f);break;case "CIMGeometricEffectWave":d.amplitude&&(d.amplitude*=f),d.period&&(d.period*=f)}}function N(d,f){if(d){var e="CIMTextSymbol"===d.type?d.symbol:d;d="CIMPolygonSymbol"===d.type;if(e?.symbolLayers)for(const g of e.symbolLayers)if(!(g.colorLocked||d&&(P.isCIMStroke(g)||P.isCIMMarker(g)&&g.markerPlacement&&P.isCIMMarkerStrokePlacement(g.markerPlacement))))switch(g.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":g.tintColor&&
G(f,g.tintColor);break;case "CIMVectorMarker":g.markerGraphics?.forEach(h=>{N(h.symbol,f)});break;case "CIMSolidStroke":case "CIMSolidFill":G(f,g.color);break;case "CIMHatchFill":N(g.lineSymbol,f)}}}function G(d,f){for(const e of d)if(e.join(".")===f.join("."))return;d.push(f)}function y(d,f,e){if(d){var g="CIMTextSymbol"===d.type?d.symbol:d;d="CIMPolygonSymbol"===g?.type;if(g?.symbolLayers)for(const h of g.symbolLayers)if(!h.colorLocked){if(d)if(e){if({layersToColor:g}=e,(P.isCIMStroke(h)||P.isCIMMarker(h)&&
h.markerPlacement&&P.isCIMMarkerStrokePlacement(h.markerPlacement))&&"fill"===g||P.isCIMFill(h)&&"outline"===g)continue}else if(P.isCIMStroke(h)||P.isCIMMarker(h)&&h.markerPlacement&&P.isCIMMarkerStrokePlacement(h.markerPlacement))continue;g=f.toArray();switch(h.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":h.tintColor=g;break;case "CIMVectorMarker":h.markerGraphics?.forEach(x=>{y(x.symbol,f,e)});break;case "CIMSolidStroke":case "CIMSolidFill":h.color=g;break;case "CIMHatchFill":y(h.lineSymbol,
f,e)}}}}r.applyCIMSymbolColor=function(d,f,e){f instanceof H||(f=new H(f));(d=P.toCIMSymbolJSON(d))&&y(d,f,e)};r.applyCIMSymbolRotation=function(d,f,e=!1){d=P.toCIMSymbolJSON(d);e&&0!==f&&(f=360-f);if("CIMTextSymbol"===d?.type)d.angle=f;else if("CIMPointSymbol"===d?.type&&d.symbolLayers){e=f-(d.angle||0);for(const g of d.symbolLayers)if(P.isCIMMarker(g)){let h=g.rotation||0;h=g.rotateClockwise?h-e:h+e;g.rotation=h}d.angle=f}};r.getCIMSymbolColor=function(d){d=P.toCIMSymbolJSON(d);const f=[];N(d,f);
return f.length?new H(P.normalizeAlpha(f[0])):null};r.getCIMSymbolRotation=function(d,f=!1){d=P.toCIMSymbolJSON(d);return"CIMTextSymbol"===d?.type||"CIMPointSymbol"===d?.type?(d=d.angle,null!=d&&0!==d&&f?360-d:d??0):0};r.getCIMSymbolSize=A;r.getCIMSymbolType=function(d){d=P.toCIMSymbolJSON(d);if(!d)return null;switch(d.type){case "CIMPointSymbol":return"CIMPointSymbol";case "CIMLineSymbol":return"CIMLineSymbol";case "CIMPolygonSymbol":return"CIMPolygonSymbol";case "CIMTextSymbol":return"CIMTextSymbol";
case "CIMMeshSymbol":return"CIMMeshSymbol";default:return null}};r.scaleCIMMarker=F;r.scaleCIMSymbol=q;r.scaleCIMSymbolTo=function(d,f,e){if(d){var g=P.toCIMSymbolJSON(d);d=A(d);if(0===d){if(g)if("CIMTextSymbol"===g.type)g.height=f;else if(g.symbolLayers)for(const h of g.symbolLayers)switch(h.type){case "CIMPictureMarker":case "CIMVectorMarker":h.size=f;break;case "CIMPictureStroke":case "CIMSolidStroke":h.width=f}}else q(g,f/d,!1,e)}};Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})})},
"esri/symbols/support/previewUtils":function(){define(["exports","../../Color"],function(r,H){function P(A,q){return Math.round(Math.min(Math.max(A+191.25*q,0),255))}r.SymbolSizeDefaults=void 0;(function(A){A[A.size=22]="size";A[A.lineWidth=50]="lineWidth";A[A.maxSize=120]="maxSize";A[A.maxOutlineSize=80]="maxOutlineSize";A[A.tallSymbolWidth=20]="tallSymbolWidth"})(r.SymbolSizeDefaults||(r.SymbolSizeDefaults={}));r.adjustColorBrightness=function(A,q){if(null==A)return new H;if("type"in A&&("linear"===
A.type||"pattern"===A.type))return A;A=new H(A);return new H([P(A.r,q),P(A.g,q),P(A.b,q),A.a])};r.adjustColorComponentBrightness=P;r.getConeShapes=function(A,q){let F=q?r.SymbolSizeDefaults.tallSymbolWidth:A;q=q?4:6;F=F<=r.SymbolSizeDefaults.size?F-.5*q:F-q;q=.15*F;const B=F;A-=q;return[{type:"ellipse",cx:.5*F,cy:A,rx:.5*F,ry:q},{type:"path",path:[{command:"M",values:[.5*B,0]},{command:"L",values:[B,A]},{command:"L",values:[0,A]},{command:"Z",values:[]}]}]};r.getCubeShapes=function(A,q){let F=q?r.SymbolSizeDefaults.tallSymbolWidth:
A;var B=q?4:6;B=F=F<=r.SymbolSizeDefaults.size?F-.5*B:F-B;q=q?.35*F:.5*F;return[{type:"path",path:[{command:"M",values:[.5*B,0]},{command:"L",values:[B,.5*q]},{command:"L",values:[.5*B,q]},{command:"L",values:[0,.5*q]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*q]},{command:"L",values:[.5*B,q]},{command:"L",values:[.5*B,A]},{command:"L",values:[0,A-.5*q]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.5*B,q]},{command:"L",values:[.5*B,A]},{command:"L",
values:[B,A-.5*q]},{command:"L",values:[B,.5*q]},{command:"Z",values:[]}]}]};r.getCylinderShapes=function(A,q){var F=q?r.SymbolSizeDefaults.tallSymbolWidth:A;q=q?4:6;F=F<=r.SymbolSizeDefaults.size?F-.5*q:F-q;q=.5*F;const B=.15*F;A-=B;return[{type:"ellipse",cx:.5*F,cy:A,rx:q,ry:B},{type:"path",path:[{command:"M",values:[0,B]},{command:"L",values:[0,A]},{command:"L",values:[F,A]},{command:"L",values:[F,B]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*F,cy:B,rx:q,ry:B}]};r.getDiamondShapes=function(A){var q=
A;q=q<r.SymbolSizeDefaults.size?q-2:q-4;const F=Math.floor(A/10)-1||1;return[{type:"path",path:[{command:"M",values:[.45*q,0]},{command:"L",values:[q,.5*A-F]},{command:"L",values:[.45*q-F,.5*A+F]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*q,0]},{command:"L",values:[.45*q-F,.5*A+F]},{command:"L",values:[0,.5*A-F]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*A-F]},{command:"L",values:[.45*q-F,.5*A+F]},{command:"L",values:[.45*q,A]},{command:"Z",
values:[]}]},{type:"path",path:[{command:"M",values:[.45*q,A]},{command:"L",values:[q,.5*A-F]},{command:"L",values:[.45*q-F,.5*A+F]},{command:"Z",values:[]}]}]};r.getExtrudeSymbolShapes=function(A){const q=r.SymbolSizeDefaults.size;A*=.5;return[{type:"path",path:[{command:"M",values:[0,.35*q]},{command:"L",values:[.3*q,.7*q]},{command:"L",values:[.3*q,.7*q+A]},{command:"L",values:[0,.7*q+A-.35*q]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*q,.7*q]},{command:"L",values:[.3*
q,.7*q+A]},{command:"L",values:[q,A]},{command:"L",values:[q,0]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*q,0]},{command:"L",values:[q,0]},{command:"L",values:[.3*q,.7*q]},{command:"L",values:[0,.35*q]},{command:"Z",values:[]}]}]};r.getInvertedConeShapes=function(A){let q=A;q=q<r.SymbolSizeDefaults.size?q-3:q-6;const F=.15*q,B=q;return[{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[B,0]},{command:"L",values:[.5*B,A-F]},{command:"Z",values:[]}]},{type:"ellipse",
cx:.5*q,cy:0,rx:.5*q,ry:F}]};r.getPathSymbolShapes=function(A,q,F){var B=r.SymbolSizeDefaults.size;let J=B,N=B;1>A?J*=.75:1<A&&(N*=1.25);A=B;q&&F&&(J=N=A=B=0);return[{type:"path",path:[{command:"M",values:[A,0]},{command:"L",values:[F?A:.875*A,0]},{command:"L",values:[F?J-.5*A:0,N-.5*B]},{command:"L",values:[J-.5*A,N-.5*B]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[A,0]},{command:"L",values:[A,q?0:.125*B]},{command:"L",values:[J-.5*A,q?N-.5*B:B]},{command:"L",values:[J-.5*
A,N-.5*B]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[J-.5*A,N-.5*B]},{command:"L",values:[F?J-.5*A:0,N-.5*B]},{command:"L",values:[F?J-.5*A:0,q?N-.5*B:B]},{command:"L",values:[J-.5*A,q?N-.5*B:B]},{command:"Z",values:[]}]}]};r.getTetrahedronShapes=function(A){var q=A;q=q<r.SymbolSizeDefaults.size?q-1:q-2;return[{type:"path",path:[{command:"M",values:[.45*A,0]},{command:"L",values:[A,q]},{command:"L",values:[.45*A,.6*q]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",
values:[.45*A,0]},{command:"L",values:[.45*A,.6*q]},{command:"L",values:[0,q]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,q]},{command:"L",values:[.45*A,.6*q]},{command:"L",values:[A,q]},{command:"Z",values:[]}]}]};r.getWaterSymbolShapes=function(){return[{type:"path",path:"M80,80.2v-27c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4C8.3,59.3,5.7,58,3.9,56c-1.1-1.2-2.4-2.1-3.9-2.8v27"},
{type:"path",path:"M11,59.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8v-24c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-1.1-1.2-2.4-2.1-3.9-2.8v24c1.5,0.7,2.8,1.6,3.9,2.8C5.7,58,8.3,59.3,11,59.4z"},
{type:"path",path:"M11,35.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8V3.6c-1.5,0.7-2.8,1.6-3.9,2.8c-2.2,2.1-4.6,3.4-7.1,3.4s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6S42.5,9.9,40,9.9s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.5,0-5-1.3-7.1-3.4C2.8,5.3,1.4,4.3,0,3.6v25.6c1.5,0.7,2.8,1.6,3.9,2.8C5.7,34.1,8.3,35.3,11,35.4z"}]};
r.shapes={fill:[{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"}],squareFill:[{type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 Z"}],meshSymbol3DFill:[{type:"path",path:"M -10,-8 L 6,0 L 6,6 L -10,6 L -10,-8 Z"},{type:"path",path:"M -10,-8 L -7,-10 L 9,-2 L 6,0 L -10,-8 Z"},{type:"path",path:"M 6,0 L 9,-2 L 9,4 L 6,6 L 6,0 Z"}],pathSymbol3DLayer:[{type:"path",path:"M 3,12 L 12,0 L 11,-2 L -4,5 L -1,5 L 1,7 L 3,10 L 3,12 Z"},{type:"circle",cx:-2,cy:10,r:5}],extrudeSymbol3DLayer:[{type:"path",
path:"M -7,-5 L -2,0 L -2,7 L -7,3 L -7,-5 Z"},{type:"path",path:"M -2,0 L -2,7 L 10,-3 L 10,-10 L -2,0 Z"},{type:"path",path:"M -7,-5 L -2,0 L 10,-10 L -2,-10 L -7,-5 Z"}],cone:[{type:"path",path:"M 0,-10 L -8,5 L -4,6.5 L 0,7 L 4,6.5 L 8,5 Z"}],tallCone:[{type:"path",path:"M 0,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 0,-9 Z"}],invertedCone:[{type:"path",path:"M 0,7 L -8,-8 L 8,-8 Z"},{type:"path",path:"M -8,-8 L -4,-9.5 L 0,-10 L 4,-9.5 L 8,-8 L 4,-6.5 L 0,-6 L -4,-6.5 Z"}],cube:[{type:"path",
path:"M -10,-7 L 0,-12 L 10,-7 L 0,-2 L -10,-7 Z"},{type:"path",path:"M -10,-7 L 0,-2 L 0,12 L -10,7 L -10,-7 Z"},{type:"path",path:"M 0,-2 L 10,-7 L 10,7 L 0,12 L 0,-2 Z"}],tallCube:[{type:"path",path:"M -3.5,-8.5 L 0,-9.5 L 3.5,-8.5 L 0,-7.5 L -3.5,-8.5 Z"},{type:"path",path:"M -3.5,-8.5 L 0,-7.5 L 0,9 L -3.5,8 L -3.5,-8.5 Z"},{type:"path",path:"M 0,-7.5 L 3.5,-8.5 L 3.5,8 L 0,9 L 0,-7.5 Z"}],cylinder:[{type:"path",path:"M -8,-9 L -8,7 L -4,8.5 L 0,9 L 4,8.5 L 8,7 L 8,-9 Z"},{type:"ellipse",cx:0,
cy:-9,rx:8,ry:2}],tallCylinder:[{type:"path",path:"M -3.5,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 3.5,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:3.5,ry:1}],diamond:[{type:"path",path:"M 0,-10 L 10,-1 L -1,1 L 0,-10 Z"},{type:"path",path:"M 0,-10 L -1,1 L -8,-1 L 0,-10 Z"},{type:"path",path:"M -1,1 L 0,10 L -8,-1 L -1,1 Z"},{type:"path",path:"M -1,0 L 0,10 L 10,-1 L -1,1 Z"}],tetrahedron:[{type:"path",path:"M 0,-10 L 10,7 L 0,0 L 0,-10 Z"},{type:"path",path:"M 0,-10 L 0,0 L -8,7 L 0,-10 Z"},{type:"path",
path:"M 10,7 L 0,0 L -8,7 L 10,7 Z"}]};Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/renderUtils":function(){define("exports ../../kernel ../../request ../../core/colorUtils ../../core/Error ../../core/has ../../libs/maquette/projection ../../libs/maquette/projector ./svgUtils ./utils".split(" "),function(r,H,P,A,q,F,B,J,N,G){function y(e,g){f.append(e,g);f.detach(g)}function d(e,g,h){return e?P(e,{responseType:"image"}).then(x=>{x=x.data;const k=x.width,l=
x.height,n=k/l;let z=g;h&&(z=Math.min(z,Math.max(k,l)));return{image:x,width:1>=n?Math.ceil(z*n):z,height:1>=n?z:Math.ceil(z/n)}}):Promise.reject(new q("renderUtils: imageDataSize","href not provided."))}const f=J.createProjector();r.renderOnce=y;r.renderSymbol=function(e,g,h){const x=Math.ceil(g[0]),k=Math.ceil(g[1]);if(!e.some(l=>!!l.length))return null;g=h?.node||document.createElement("div");null!=h.opacity&&(g.style.opacity=h.opacity.toString());null!=h.effectView&&(g.style.filter=G.getCSSFilterFromEffectList(h.effectView));
y(g,()=>N.renderSVG(e,x,k,h));return g};r.tintImageWithColor=function(e,g,h,x,k){return d(e,g,k).then(l=>{const n=l.width??g,z=l.height??g;var E;if(E=l.image)E=h&&"ignore"!==x?"multiply"===x&&255===h.r&&255===h.g&&255===h.b&&1===h.a?!1:!0:!1;if(E){var I=l.image.width,c=l.image.height;F("edge")&&/\.svg$/i.test(e)&&(--I,--c);E=Math.ceil(n);var b=Math.ceil(z);var v=document.createElement("canvas");v.width=E;v.height=b;v.style.width=E+"px";v.style.height=b+"px";v=v.getContext("2d");v.clearRect(0,0,E,
b);E=v;E.drawImage(l.image,0,0,I,c,0,0,n,z);b=E.getImageData(0,0,n,z);v=[h.r/255,h.g/255,h.b/255,h.a];const p=A.toHSV(h);for(let K=0;K<b.data.length;K+=4){l=b.data;I=K;c=v;var D=p;switch(x){case "multiply":l[I]*=c[0];l[I+1]*=c[1];l[I+2]*=c[2];l[I+3]*=c[3];break;default:const M=A.toHSV({r:l[I],g:l[I+1],b:l[I+2]});M.h=D.h;M.s=D.s;M.v=M.v/100*D.v;D=A.toRGB(M);l[I]=D.r;l[I+1]=D.g;l[I+2]=D.b;l[I+3]*=c[3]}}E.putImageData(b,0,0);e=E.canvas.toDataURL("image/png")}else E=H.id?.findCredential(e),E?.token&&
(l=e.includes("?")?"\x26":"?",e=`${e}${l}token=${E.token}`);return{url:e,width:n,height:z}}).catch(()=>({url:e,width:g,height:g}))};Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/svgUtils":function(){define("exports ../../Color ../../core/has ../../core/maybe ../../core/libs/gl-matrix-2/factories/mat2df32 ../../core/libs/gl-matrix-2/math/mat2d ./gfxUtils ../../widgets/support/widgetUtils ../../widgets/support/jsxFactory".split(" "),function(r,H,P,A,q,F,B,J,N){function G(u,
m){u*=Z/180;return Math.abs(m*Math.sin(u))+Math.abs(m*Math.cos(u))}function y(u){return u.map(m=>`${m.command} ${m.values.join(" ")}`).join(" ").trim()}function d(u,m,w,S,U){if(u){if("circle"===u.type)return N.tsx("circle",{cx:u.cx,cy:u.cy,fill:m,"fill-rule":"evenodd",r:u.r,stroke:w.color,"stroke-dasharray":w.dashArray,"stroke-dashoffset":w.dashOffset,"stroke-linecap":w.cap,"stroke-linejoin":w.join,"stroke-miterlimit":"4","stroke-width":w.width});if("ellipse"===u.type)return N.tsx("ellipse",{cx:u.cx,
cy:u.cy,fill:m,"fill-rule":"evenodd",rx:u.rx,ry:u.ry,stroke:w.color,"stroke-dasharray":w.dashArray,"stroke-linecap":w.cap,"stroke-linejoin":w.join,"stroke-miterlimit":"4","stroke-width":w.width});if("rect"===u.type)return N.tsx("rect",{fill:m,"fill-rule":"evenodd",height:u.height,stroke:w.color,"stroke-dasharray":w.dashArray,"stroke-linecap":w.cap,"stroke-linejoin":w.join,"stroke-miterlimit":"4","stroke-width":w.width,width:u.width,x:u.x,y:u.y});if("image"===u.type)return N.tsx("image",{alt:U||"image",
height:u.height,href:u.src,preserveAspectRatio:"none",width:u.width,x:u.x,y:u.y});if("path"===u.type)return u="string"!==typeof u.path?y(u.path):u.path,N.tsx("path",{d:u,fill:m,"fill-rule":"evenodd",stroke:w.color,"stroke-dasharray":w.dashArray,"stroke-linecap":w.cap,"stroke-linejoin":w.join,"stroke-miterlimit":"4","stroke-width":w.width});if("text"===u.type)return A.assertIsSome(S),N.tsx("text",{"dominant-baseline":S.dominantBaseline,fill:m,"fill-rule":"evenodd","font-family":S.font.family,"font-size":S.font.size,
"font-style":S.font.style,"font-variant":S.font.variant,"font-weight":S.font.weight,kerning:S.kerning,rotate:S.rotate,stroke:w.color,"stroke-dasharray":w.dashArray,"stroke-linecap":w.cap,"stroke-linejoin":w.join,"stroke-miterlimit":"4","stroke-width":w.width,"text-anchor":S.align,"text-decoration":S.decoration,"text-rendering":p,x:u.x,y:u.y},u.text)}return null}function f(u){const m={fill:"none",pattern:null,linearGradient:null};if(u)if("type"in u&&"pattern"===u.type){var w=`patternId-${++v}`;m.fill=
`url(#${w})`;m.pattern={id:w,x:u.x,y:u.y,width:u.width,height:u.height,image:{x:0,y:0,width:u.width,height:u.height,href:u.src}}}else"type"in u&&"linear"===u.type?(w=`linearGradientId-${++D}`,m.fill=`url(#${w})`,m.linearGradient={id:w,x1:u.x1,y1:u.y1,x2:u.x2,y2:u.y2,stops:u.colors.map(S=>({offset:S.offset,color:S.color&&(new H(S.color)).toString()}))}):u&&(u=new H(u),m.fill=u.toString());return m}function e(u){const m={color:"none",width:1,cap:"butt",join:"4",dashArray:"none",dashOffset:"0"};u&&(null!=
u.width&&(m.width=u.width),u.cap&&(m.cap=u.cap),u.join&&(m.join=u.join.toString()),u.color&&(m.color=(new H(u.color)).toString()),u.dashArray&&(m.dashArray=u.dashArray),u.dashoffset&&(m.dashOffset=u.dashoffset),u.style&&!u.dashArray&&(m.dashArray=B.getDashArray(u).join(",")||"none"));return m}function g(u,m){const w={align:null,decoration:null,kerning:null,rotate:null,font:{style:null,variant:null,weight:null,size:null,family:null}};if(u){const S=u.alignBaseline;w.align=u.align;w.dominantBaseline=
"baseline"===S?"auto":"top"===S?"text-top":"bottom"===S?"hanging":S;w.decoration=u.decoration;w.kerning=u.kerning?"auto":"0";w.rotate=u.rotated?"90":"0";A.assertIsSome(m);w.font.style=m.style||"normal";w.font.variant=m.variant||"normal";w.font.weight=m.weight||"normal";w.font.size=m.size&&m.size.toString()||"10pt";w.font.family=m.family||"serif"}return w}function h(u){const {pattern:m,linearGradient:w}=u;return m?N.tsx("pattern",{height:m.height,id:m.id,patternUnits:"userSpaceOnUse",width:m.width,
x:m.x,y:m.y},N.tsx("image",{height:m.image.height,href:m.image.href,width:m.image.width,x:m.image.x,y:m.image.y})):w?(u=w.stops.map((S,U)=>N.tsx("stop",{key:`${U}-stop`,offset:S.offset,"stop-color":S.color})),N.tsx("linearGradient",{gradientUnits:"userSpaceOnUse",id:w.id,x1:w.x1,x2:w.x2,y1:w.y1,y2:w.y2},u)):null}function x(u,m){if(!u||0===u.length)return null;const w=[];for(const S of u){const {shape:U,fill:W,stroke:ea,font:ja}=S;u=f(W);const aa=e(ea),la="text"===U.type?g(U,ja):null;(u=d(U,u.fill,
aa,la))&&w.push(u)}return N.tsx("mask",{id:m,maskUnits:"userSpaceOnUse"},N.tsx("g",null,w))}function k(u,m,w,S,U){F.scale(u,F.identity(u),[m,w]);u[4]=u[4]*m-S*m+S;u[5]=u[5]*w-U*w+U;return u}function l(u,m){if(Q&&"left"in Q){null!=Q.left&&Q.left>u&&(Q.left=u);if(null==Q.right||Q.right<u)Q.right=u;if(null==Q.top||Q.top>m)Q.top=m;if(null==Q.bottom||Q.bottom<m)Q.bottom=m}else Q={left:u,bottom:m,right:u,top:m}}function n(u){const m=u.args,w=m.length;switch(u.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(u=
0;u<w;u+=2)l(m[u],m[u+1]);R.x=m[w-2];R.y=m[w-1];break;case "H":for(u=0;u<w;++u)l(m[u],R.y);R.x=m[w-1];break;case "V":for(u=0;u<w;++u)l(R.x,m[u]);R.y=m[w-1];break;case "m":u=0;"x"in R||(l(R.x=m[0],R.y=m[1]),u=2);for(;u<w;u+=2)l(R.x+=m[u],R.y+=m[u+1]);break;case "l":case "t":for(u=0;u<w;u+=2)l(R.x+=m[u],R.y+=m[u+1]);break;case "h":for(u=0;u<w;++u)l(R.x+=m[u],R.y);break;case "v":for(u=0;u<w;++u)l(R.x,R.y+=m[u]);break;case "c":for(u=0;u<w;u+=6)l(R.x+m[u],R.y+m[u+1]),l(R.x+m[u+2],R.y+m[u+3]),l(R.x+=m[u+
4],R.y+=m[u+5]);break;case "s":case "q":for(u=0;u<w;u+=4)l(R.x+m[u],R.y+m[u+1]),l(R.x+=m[u+2],R.y+=m[u+3]);break;case "A":for(u=0;u<w;u+=7)l(m[u+5],m[u+6]);R.x=m[w-2];R.y=m[w-1];break;case "a":for(u=0;u<w;u+=7)l(R.x+=m[u+5],R.y+=m[u+6])}}function z(u,m,w){const S=K[u.toLowerCase()];"number"===typeof S&&(S?m.length>=S&&(u={action:u,args:m.slice(0,m.length-m.length%S)},w.push(u),n(u)):(u={action:u,args:[]},w.push(u),n(u)))}function E(u){const m={x:0,y:0,width:0,height:0};if("circle"===u.type)m.x=u.cx-
u.r,m.y=u.cy-u.r,m.width=2*u.r,m.height=2*u.r;else if("ellipse"===u.type)m.x=u.cx-u.rx,m.y=u.cy-u.ry,m.width=2*u.rx,m.height=2*u.ry;else if("image"===u.type||"rect"===u.type)m.x=u.x,m.y=u.y,m.width=u.width,m.height=u.height;else if("path"===u.type){{const U=("string"!==typeof u.path?y(u.path):u.path).match(M),W=[];Q={};R={};if(U){u="";var w=[],S=U.length;for(let ea=0;ea<S;++ea){const ja=U[ea],aa=parseFloat(ja);isNaN(aa)?(u&&z(u,w,W),w=[],u=ja):w.push(aa)}z(u,w,W);u={x:0,y:0,width:0,height:0};Q&&"left"in
Q&&(u.x=Q.left,u.y=Q.top,u.width=Q.right-Q.left,u.height=Q.bottom-Q.top)}else u=null}m.x=u.x;m.y=u.y;m.width=u.width;m.height=u.height}return m}function I(u){const m={x:0,y:0,width:0,height:0};let w=null,S=Number.NEGATIVE_INFINITY,U=Number.NEGATIVE_INFINITY;for(const W of u)w?(w.x=Math.min(w.x,W.x),w.y=Math.min(w.y,W.y),S=Math.max(S,W.x+W.width),U=Math.max(U,W.y+W.height)):(w=m,w.x=W.x,w.y=W.y,S=W.x+W.width,U=W.y+W.height);w&&(w.width=S-w.x,w.height=U-w.y);return w}function c(u,m,w,S,U,W,ea,ja,aa){var la=
(ea&&W?G(W,m):m)/2,V=(ea&&W?G(W,w):w)/2;if(aa){var ba=aa[0];aa=aa[1];la=(ea&&W?G(W,ba):ba)/2;V=(ea&&W?G(W,aa):aa)/2}ba=u.width+S;var da=u.height+S;aa=q.create();ea=q.create();var ca=!1;if(U&&0!==ba&&0!==da){U=m!==w?m/w:ba/da;ca=m>w?m:w;let na=1,pa=1;isNaN(ca)||(1<U?(na=ca/ba,pa=ca/U/da):(pa=ca/da,na=ca*U/ba));F.multiply(ea,ea,k(aa,na,pa,la,V));ca=!0}U=u.x+(ba-S)/2;u=u.y+(da-S)/2;S=F.multiply;la-=U;V-=u;la=F.translate(aa,F.identity(aa),[la,V]);S.call(F,ea,ea,la);!ca&&(ba>m||da>w)&&(la=ba/m>da/w,m=
(la?m:w)/(la?ba:da),F.multiply(ea,ea,k(aa,m,m,U,u)));W&&(m=F.multiply,w=W%360*Math.PI/180,F.rotate(aa,F.identity(aa),w),W=Math.cos(w),w=Math.sin(w),ba=aa[4],da=aa[5],aa[4]=ba*W-da*w+u*w-U*W+U,aa[5]=da*W+ba*w-U*w-u*W+u,m.call(F,ea,ea,aa));ja&&(W=F.multiply,m=ja[0],ja=ja[1],ja=F.translate(aa,F.identity(aa),[m,ja]),W.call(F,ea,ea,ja));return`matrix(${ea[0]},${ea[1]},${ea[2]},${ea[3]},${ea[4]},${ea[5]})`}function b(u,m,w){u=u?.effects.find(ja=>"bloom"===ja.type);if(!u)return null;const {strength:S,radius:U}=
u;u=0<S?U:0;const W=(S+u)*m,ea=4*S+1;return N.tsx("filter",{filterUnits:"userSpaceOnUse",height:"300%",id:`bloom${w}`,width:"300%",x:"-100%",y:"-100%"},N.tsx("feMorphology",{in:"SourceGraphic",operator:"dilate",radius:(S+.5*u)*5**(m/100)*(.4+m/100),result:"dilate"}),N.tsx("feGaussianBlur",{in:"dilate",result:"blur",stdDeviation:W/25}),N.tsx("feGaussianBlur",{in:"blur",result:"intensityBlur",stdDeviation:W/50}),N.tsx("feComponentTransfer",{in:"SourceGraphic",result:"intensityBrightness"},N.tsx("feFuncR",
{slope:ea,type:"linear"}),N.tsx("feFuncG",{slope:ea,type:"linear"}),N.tsx("feFuncB",{slope:ea,type:"linear"})),N.tsx("feMerge",null,N.tsx("feMergeNode",{in:"intensityBlur"}),N.tsx("feMergeNode",{in:"intensityBrightness"}),N.tsx("feGaussianBlur",{stdDeviation:S/10})))}let v=0,D=0;J=P("android");const p=P("chrome")||J&&4<=J?"auto":"optimizeLegibility",K={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},M=/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g;let Q={},R={};const Z=Math.PI;let X=1;r.computeBBox=
I;r.generateFillAttributes=f;r.generateStrokeAttributes=e;r.generateTextAttributes=g;r.getBoundingBox=E;r.getTransformMatrix=c;r.renderDef=h;r.renderSVG=function(u,m,w,S={}){const U=[],W=[],ea=++X,ja=b(S.effectView,m,ea);var aa=null;ja&&(aa=S.effectView?.effects.find(ca=>"bloom"===ca.type),aa=(aa.strength?aa.strength+aa.radius/2:0)/3,aa=[Math.max(m+m*aa,10),Math.max(w+w*aa,10)]);for(let ca=0;ca<u.length;ca++){var la=u[ca];const na=[];var V=[],ba=0,da=0;let pa=0;for(const sa of la){const {shape:ua,
fill:ya,stroke:wa,font:Ea,offset:Fa}=sa;S.ignoreStrokeWidth||"text"===ua.type||(ba+=wa?.width||0);la=f(ya);const xa=e(wa),Aa="text"===ua.type?g(ua,Ea):null;U.push(h(la));na.push(d(ua,la.fill,xa,Aa,S.ariaLabel));V.push(E(ua));Fa&&(da+=Fa[0],pa+=Fa[1])}V=I(V);ba=c(V,m,w,ba,S.scale??!1,S.rotation,S.useRotationSize??!1,[da,pa],aa);da=null;S.masking&&(da=`mask-${ca}`,U.push(x(S.masking[ca],da)),da=`url(#${da})`);W.push(da?N.tsx("g",{mask:da},N.tsx("g",{transform:ba},na)):N.tsx("g",{transform:ba},na))}S.useRotationSize&&
S.rotation&&(m=G(S.rotation,m),w=G(S.rotation,w));ja&&(A.assertIsSome(aa),m=aa[0],w=aa[1]);return N.tsx("svg",{"aria-labelledby":S.ariaLabel,focusable:!1,height:w,role:"img",style:"display: block;",width:m,xmlns:"http://www.w3.org/2000/svg"},ja,N.tsx("defs",null,U),ja?N.tsx("g",{filter:`url(#bloom${ea})`},W):W)};r.renderShape=d;Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/gl-matrix-2/factories/mat2df32":function(){define(["exports"],function(r){function H(){const N=
new Float32Array(6);N[0]=1;N[3]=1;return N}function P(N){const G=new Float32Array(6);G[0]=N[0];G[1]=N[1];G[2]=N[2];G[3]=N[3];G[4]=N[4];G[5]=N[5];return G}function A(N,G,y,d,f,e){const g=new Float32Array(6);g[0]=N;g[1]=G;g[2]=y;g[3]=d;g[4]=f;g[5]=e;return g}function q(N,G){return new Float32Array(N,G,6)}function F(N,G,y,d){const f=G[d];G=G[d+1];N[d]=y[0]*f+y[2]*G+y[4];N[d+1]=y[1]*f+y[3]*G+y[5]}function B(N,G,y,d=0,f=0,e=2){for(f=f||G.length/e;d<f;d++)F(N,G,y,d*e)}const J=Object.freeze(Object.defineProperty({__proto__:null,
clone:P,create:H,createView:q,fromValues:A,transform:F,transformMany:B},Symbol.toStringTag,{value:"Module"}));r.clone=P;r.create=H;r.createView=q;r.fromValues=A;r.mat2df32=J;r.transform=F;r.transformMany=B;Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/gl-matrix-2/math/mat2d":function(){define(["exports","./common"],function(r,H){function P(c,b){c[0]=b[0];c[1]=b[1];c[2]=b[2];c[3]=b[3];c[4]=b[4];c[5]=b[5];return c}function A(c){c[0]=1;c[1]=0;c[2]=0;c[3]=1;c[4]=0;c[5]=
0;return c}function q(c,b,v,D,p,K,M){c[0]=b;c[1]=v;c[2]=D;c[3]=p;c[4]=K;c[5]=M;return c}function F(c,b){const v=b[0],D=b[1],p=b[2],K=b[3],M=b[4];b=b[5];let Q=v*K-D*p;if(!Q)return null;Q=1/Q;c[0]=K*Q;c[1]=-D*Q;c[2]=-p*Q;c[3]=v*Q;c[4]=(p*b-K*M)*Q;c[5]=(D*M-v*b)*Q;return c}function B(c){return c[0]*c[3]-c[1]*c[2]}function J(c,b,v){const D=b[0],p=b[1],K=b[2],M=b[3],Q=b[4];b=b[5];const R=v[0],Z=v[1],X=v[2],u=v[3],m=v[4];v=v[5];c[0]=D*R+K*Z;c[1]=p*R+M*Z;c[2]=D*X+K*u;c[3]=p*X+M*u;c[4]=D*m+K*v+Q;c[5]=p*m+
M*v+b;return c}function N(c,b,v){const D=b[0],p=b[1],K=b[2],M=b[3],Q=b[4];b=b[5];const R=Math.sin(v);v=Math.cos(v);c[0]=D*v+K*R;c[1]=p*v+M*R;c[2]=D*-R+K*v;c[3]=p*-R+M*v;c[4]=Q;c[5]=b;return c}function G(c,b,v){const D=b[1],p=b[2],K=b[3],M=b[4],Q=b[5],R=v[0];v=v[1];c[0]=b[0]*R;c[1]=D*R;c[2]=p*v;c[3]=K*v;c[4]=M;c[5]=Q;return c}function y(c,b,v){const D=b[0],p=b[1],K=b[2],M=b[3],Q=b[4];b=b[5];const R=v[0];v=v[1];c[0]=D;c[1]=p;c[2]=K;c[3]=M;c[4]=D*R+K*v+Q;c[5]=p*R+M*v+b;return c}function d(c,b){const v=
Math.sin(b);b=Math.cos(b);c[0]=b;c[1]=v;c[2]=-v;c[3]=b;c[4]=0;c[5]=0;return c}function f(c,b){c[0]=b[0];c[1]=0;c[2]=0;c[3]=b[1];c[4]=0;c[5]=0;return c}function e(c,b){c[0]=1;c[1]=0;c[2]=0;c[3]=1;c[4]=b[0];c[5]=b[1];return c}function g(c){return"mat2d("+c[0]+", "+c[1]+", "+c[2]+", "+c[3]+", "+c[4]+", "+c[5]+")"}function h(c){return Math.sqrt(c[0]**2+c[1]**2+c[2]**2+c[3]**2+c[4]**2+c[5]**2+1)}function x(c,b,v){c[0]=b[0]+v[0];c[1]=b[1]+v[1];c[2]=b[2]+v[2];c[3]=b[3]+v[3];c[4]=b[4]+v[4];c[5]=b[5]+v[5];
return c}function k(c,b,v){c[0]=b[0]-v[0];c[1]=b[1]-v[1];c[2]=b[2]-v[2];c[3]=b[3]-v[3];c[4]=b[4]-v[4];c[5]=b[5]-v[5];return c}function l(c,b,v){c[0]=b[0]*v;c[1]=b[1]*v;c[2]=b[2]*v;c[3]=b[3]*v;c[4]=b[4]*v;c[5]=b[5]*v;return c}function n(c,b,v,D){c[0]=b[0]+v[0]*D;c[1]=b[1]+v[1]*D;c[2]=b[2]+v[2]*D;c[3]=b[3]+v[3]*D;c[4]=b[4]+v[4]*D;c[5]=b[5]+v[5]*D;return c}function z(c,b){return c[0]===b[0]&&c[1]===b[1]&&c[2]===b[2]&&c[3]===b[3]&&c[4]===b[4]&&c[5]===b[5]}function E(c,b){const v=c[0],D=c[1],p=c[2],K=
c[3],M=c[4];c=c[5];const Q=b[0],R=b[1],Z=b[2],X=b[3],u=b[4];b=b[5];const m=H.getEpsilon();return Math.abs(v-Q)<=m*Math.max(1,Math.abs(v),Math.abs(Q))&&Math.abs(D-R)<=m*Math.max(1,Math.abs(D),Math.abs(R))&&Math.abs(p-Z)<=m*Math.max(1,Math.abs(p),Math.abs(Z))&&Math.abs(K-X)<=m*Math.max(1,Math.abs(K),Math.abs(X))&&Math.abs(M-u)<=m*Math.max(1,Math.abs(M),Math.abs(u))&&Math.abs(c-b)<=m*Math.max(1,Math.abs(c),Math.abs(b))}const I=Object.freeze(Object.defineProperty({__proto__:null,add:x,copy:P,determinant:B,
equals:E,exactEquals:z,frob:h,fromRotation:d,fromScaling:f,fromTranslation:e,identity:A,invert:F,mul:J,multiply:J,multiplyScalar:l,multiplyScalarAndAdd:n,rotate:N,scale:G,set:q,str:g,sub:k,subtract:k,translate:y},Symbol.toStringTag,{value:"Module"}));r.add=x;r.copy=P;r.determinant=B;r.equals=E;r.exactEquals=z;r.frob=h;r.fromRotation=d;r.fromScaling=f;r.fromTranslation=e;r.identity=A;r.invert=F;r.mat2d=I;r.mul=J;r.multiply=J;r.multiplyScalar=l;r.multiplyScalarAndAdd=n;r.rotate=N;r.scale=G;r.set=q;
r.str=g;r.sub=k;r.subtract=k;r.translate=y;Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/gfxUtils":function(){define("exports ../../assets ../../Color ../../request ../../core/LRUCache ../../core/screenUtils ./cimSymbolUtils".split(" "),function(r,H,P,A,q,F,B){function J(f){if(!f)return null;let e=null;switch(f.type){case "simple-fill":case "picture-fill":case "simple-marker":e=J(f.outline);break;case "simple-line":const g=F.pt2px(f.width);null!=f.style&&"none"!==
f.style&&0!==g&&(e={color:f.color,style:d(f.style),width:g,cap:f.cap,join:"miter"===f.join?F.pt2px(f.miterLimit):f.join},e.dashArray=N(e).join(",")||"none");break;default:e=null}return e}function N(f){if(!f?.style)return[];const {dashArray:e,style:g,width:h}=f;if("string"===typeof e&&"none"!==e)return e.split(",").map(l=>Number(l));const x=h??0,k=G.has(g)?G.get(g).map(l=>l*x):[];if("butt"!==f.cap)for(const [l,n]of k.entries())k[l]=1===l%2?n+x:Math.max(n-x,1);return k}const G=new Map([["dash",[4,3]],
["dashdot",[4,3,1,3]],["dot",[1,3]],["longdash",[8,3]],["longdashdot",[8,3,1,3]],["longdashdotdot",[8,3,1,3,1,3]],["shortdash",[4,1]],["shortdashdot",[4,1,1,1]],["shortdashdotdot",[4,1,1,1,1,1]],["shortdot",[1,1]],["solid",[]]]),y=new q.LRUCache(1E3),d=(()=>{const f={};return e=>{if(f[e])return f[e];const g=e.replaceAll("-","");return f[e]=g}})();P=new P([128,128,128]);r.defaultThematicColor=P;r.dekebabifyLineStyle=d;r.getDashArray=N;r.getFill=function(f){const e=f.style;let g=null;if(f)switch(f.type){case "simple-marker":"cross"!==
e&&"x"!==e&&(g=f.color);break;case "simple-fill":e&&"solid"!==e?"none"!==e&&(g={type:"pattern",x:0,y:0,src:H.getAssetUrl(`esri/symbols/patterns/${e}.png`),width:5,height:5}):g=f.color;break;case "picture-fill":g={type:"pattern",src:f.url,width:F.pt2px(f.width)*f.xscale,height:F.pt2px(f.height)*f.yscale,x:F.pt2px(f.xoffset),y:F.pt2px(f.yoffset)};break;case "text":g=f.color;break;case "cim":g=B.getCIMSymbolColor(f)}return g};r.getPatternUrlWithColor=function(f,e){const g=f+"-"+e;return void 0!==y.get(g)?
Promise.resolve(y.get(g)):A(f,{responseType:"image"}).then(h=>{h=h.data;const x=h.naturalWidth,k=h.naturalHeight,l=document.createElement("canvas");l.width=x;l.height=k;const n=l.getContext("2d");n.fillStyle=e;n.fillRect(0,0,x,k);n.globalCompositeOperation="destination-in";n.drawImage(h,0,0);h=l.toDataURL();y.put(g,h);return h})};r.getStroke=J;Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/utils":function(){define("require exports ../../Color ../../symbols ../../core/asyncUtils ../../core/has ../../core/screenUtils ../../core/libs/gl-matrix-2/factories/vec3f64 ../../layers/effects/jsonUtils ./cimSymbolUtils ./gfxUtils ./Symbol3DMaterial".split(" "),
function(r,H,P,A,q,F,B,J,N,G,y,d){function f(c){c=c.symbolLayers;if(!c)return null;let b=null;c.forEach(v=>{"object"===v.type&&v.resource?.href||(b="water"===v.type?v.color:v.material?v.material.color:null)});return b?new P(b):null}function e(c,b){if(null==b||null==c)return c;c=c.toRgba();c[3]*=b;return new P(c)}function g(c,b,v){if(c=c.symbolLayers){var D=p=>{b=b??p??(null!=v?I:null);return e(b,v)};c.forEach(p=>{if("object"!==p.type||!p.resource?.href||b)if("water"===p.type)p.color=D(p.color);else{const K=
D(null!=p.material?p.material.color:null);null==p.material?p.material=new d.Symbol3DMaterial({color:K}):p.material.color=K;null!=v&&"outline"in p&&null!=p.outline?.color&&(p.outline.color=e(p.outline.color,v))}})}}async function h(c,b){(c=c.symbolLayers)&&await q.forEach(c,async v=>x(v,b))}async function x(c,b){switch(c.type){case "extrude":c.size="number"===typeof b[2]?b[2]:0;break;case "icon":case "line":case "text":b=k(b);null!=b&&(c.size=b);break;case "path":const v=n(b,J.ONES,[c.width,void 0,
c.height]);c.width=E(b[0],c.width,1,v);c.height=E(b[2],c.height,1,v);break;case "object":await l(c,b)}}function k(c){for(const b of c)if("number"===typeof b)return b;return null}async function l(c,b){const {resourceSize:v,symbolSize:D}=await z(c),p=n(b,v,D);c.width=E(b[0],D[0],v[0],p);c.depth=E(b[1],D[1],v[1],p);c.height=E(b[2],D[2],v[2],p)}function n(c,b,v){for(let D=0;3>D;D++){const p=c[D];switch(p){case "symbol-value":return c=v[D],null!=c?c/b[D]:1;case "proportional":break;default:if(p&&b[D])return p/
b[D]}}return 1}async function z(c){var {computeObjectLayerResourceSize:b}=await new Promise((Q,R)=>r(["./symbolLayerUtils"],Q,R));b=await b(c,10);const {width:v,height:D,depth:p}=c;c=[v,p,D];let K=1;for(var M=0;3>M;M++){const Q=c[M];if(null!=Q){K=Q/b[M];break}}for(M=0;3>M;M++)null==c[M]&&(c[M]=b[M]*K);return{resourceSize:b,symbolSize:c}}function E(c,b,v,D){switch(c){case "proportional":return v*D;case "symbol-value":return null!=b?b:v;default:return c}}const I=new P("white");H.applyColorToSymbol=
function(c,b,v){if(c&&(b||null!=v))if(b&&=new P(b),A.isSymbol3D(c))g(c,b,v);else if(A.isSymbol2D(c)){if(b=b??c.color)c.color=e(b,v);null!=v&&"outline"in c&&c.outline?.color&&(c.outline.color=e(c.outline.color,v))}};H.applyOpacityToColor=e;H.applyRotationToSymbol=function(c,b,v){c&&null!=b&&(A.isSymbol3D(c)?(c=c.symbolLayers)&&c.forEach(D=>{if(D&&"object"===D.type)switch(v){case "tilt":D.tilt=(D.tilt??0)+b;break;case "roll":D.roll=(D.roll??0)+b;break;default:D.heading=(D.heading??0)+b}}):!A.isSymbol2D(c)||
"simple-marker"!==c.type&&"picture-marker"!==c.type&&"text"!==c.type||(c.angle+=b))};H.applySizesToSymbol=async function(c,b){if(c&&b){if(A.isSymbol3D(c))return h(c,b);if(A.isSymbol2D(c)&&(b=k(b),null!=b))switch(c.type){case "simple-marker":c.size=b;break;case "picture-marker":const v=c.width/c.height;1<v?(c.width=b,c.height=b*v):(c.width=b*v,c.height=b);break;case "simple-line":c.width=b;break;case "text":c.font.size=b}}};H.fetchWebStyleSymbol=async function(c,b){const v=await c.fetchSymbol(b);return v?
v:c.fetchCIMSymbol(b)};H.getCSSFilterFromEffectList=function(c){if(!c)return null;c=c.effects.filter(b=>"bloom"!==b.type).map(b=>b.toJSON());return N.effectFunctionsFromJSON(c)};H.getColorFromSymbol=function(c,b){if(!c)return null;let v=null;A.isSymbol3D(c)?v=f(c):A.isSymbol2D(c)&&(v="cim"===c.type?G.getCIMSymbolColor(c):c.color?new P(c.color):null);return v?e(v,b):null};H.getIconHref=function(c){return c.resource?.href??""};H.getSymbolOutlineSize=function(c){return c?A.isSymbol3D(c)?(c=(c=c.symbolLayers?.at(-1))&&
"outline"in c?c?.outline?.size:void 0,null!=c?c:0):B.px2pt(y.getStroke(c)?.width):0};H.isVolumetricSymbol=function(c){if(null==c||!("symbolLayers"in c)||null==c.symbolLayers)return!1;switch(c.type){case "point-3d":return c.symbolLayers.some(b=>"object"===b.type);case "line-3d":return c.symbolLayers.some(b=>"path"===b.type);case "polygon-3d":return c.symbolLayers.some(b=>"object"===b.type||"extrude"===b.type);default:return!1}};H.symbolHasExtrudeSymbolLayer=function(c){return null!=c&&"polygon-3d"===
c.type&&c.symbolLayers.some(b=>"extrude"===b.type)};Object.defineProperty(H,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/symbolUtils":function(){define("require exports ../../core/has ../../support/arcadeOnDemand ./gfxUtils ./previewUtils ./renderUtils ./utils ../../widgets/Legend/styles/support/relationshipUtils ../../widgets/Legend/support/relationshipRampUtils".split(" "),function(r,H,P,A,q,F,B,J,N,G){function y(x,k){if(k&&(x.style.filter=J.getCSSFilterFromEffectList(k),k=k.effects))for(const l of k)if("drop-shadow"===
l?.type){0>l.offsetX?x.style.marginLeft=`${Math.abs(l.offsetX)}px`:x.style.marginRight=`${l.offsetX}px`;break}}async function d(x,k){switch(x.type){case "web-style":var {previewWebStyleSymbol:l}=await new Promise((n,z)=>r(["./previewWebStyleSymbol"],n,z));return l(x,d,k);case "label-3d":case "line-3d":case "mesh-3d":case "point-3d":case "polygon-3d":return{previewSymbol3D:l}=await new Promise((n,z)=>r(["./previewSymbol3D"],n,z)),l(x,k);case "simple-marker":case "simple-line":case "simple-fill":case "picture-marker":case "picture-fill":case "text":return{previewSymbol2D:l}=
await new Promise((n,z)=>r(["./previewSymbol2D"],n,z)),l(x,k);case "cim":return{previewCIMSymbol:l}=await new Promise((n,z)=>r(["./previewCIMSymbol"],n,z)),l(x,k)}}function f(x){return x&&"opacity"in x?x.opacity*f(x.parent):1}function e(x){if(x)return"renderer"in x?x.renderer:void 0}let g=null;const h=[255,255,255];H.getDisplayedColor=async function(x,k){if(x){var {layer:l,sourceLayer:n}=x,z=f(l??n);if(null!=x.symbol&&(null==k||!0!==k.ignoreGraphicSymbol))return x="web-style"===x.symbol.type?await J.fetchWebStyleSymbol(x.symbol,
k):x.symbol.clone(),J.getColorFromSymbol(x,z);var E=k?.renderer??e(l)??e(n),I=E&&"getSymbolAsync"in E?await E.getSymbolAsync(x,k):void 0;if(I){I="web-style"===I.type?await J.fetchWebStyleSymbol(I,k):I.clone();I=J.getColorFromSymbol(I,z);if(!(E&&"visualVariables"in E)||"visualVariables"in E&&!E.visualVariables||"visualVariables"in E&&!E.visualVariables?.length)return I;"arcadeRequiredForVisualVariables"in E&&E.arcadeRequiredForVisualVariables&&null==k?.arcade&&(k={...k},k.arcade=await A.loadArcade());
var {getColor:c,getOpacity:b}=await new Promise((p,K)=>r(["../../renderers/visualVariables/support/visualVariableUtils"],p,K)),v=[],D=[];for(const p of E.visualVariables)switch(p.type){case "color":v.push(p);break;case "opacity":D.push(p)}E=(E=0<v.length?v[v.length-1]:null)?c(E,x,k):I;x=(I=0<D.length?D[D.length-1]:null)?b(I,x,k):null;null!=z&&(x=null!=x?x*z:z);return E?J.applyOpacityToColor(E,x):null}}};H.getDisplayedSymbol=async function(x,k){if(x){var l=x.sourceLayer,n=(null!=k&&(k.useSourceLayer??
!1)?l:x.layer)??l;l=f(n);if(null!=x.symbol&&(null==k||!0!==k.ignoreGraphicSymbol))return x="web-style"===x.symbol.type?await J.fetchWebStyleSymbol(x.symbol,{...k,cache:null!=k?k.webStyleCache:null}):x.symbol.clone(),J.applyColorToSymbol(x,null,l),x;var z=k?.renderer??e(n);if(n=z&&"getSymbolAsync"in z?await z.getSymbolAsync(x,k):null){n="web-style"===n.type?await n.fetchSymbol({...k,cache:null!=k?k.webStyleCache:null}):n.clone();if(!(z&&"visualVariables"in z&&z.visualVariables?.length))return J.applyColorToSymbol(n,
null,l),n;"arcadeRequiredForVisualVariables"in z&&z.arcadeRequiredForVisualVariables&&null==k?.arcade&&(k={...k},k.arcade=await A.loadArcade());var {getColor:E,getOpacity:I,getAllSizes:c,getRotationAngle:b}=await new Promise((Q,R)=>r(["../../renderers/visualVariables/support/visualVariableUtils"],Q,R)),v=[],D=[],p=[],K=[];for(var M of z.visualVariables)switch(M.type){case "color":v.push(M);break;case "opacity":D.push(M);break;case "rotation":K.push(M);break;case "size":M.target||p.push(M)}M=(M=!!v.length&&
v[v.length-1])?E(M,x,k):null;D=(D=!!D.length&&D[D.length-1])?I(D,x,k):null;null!=l&&(D=null!=D?D*l:l);J.applyColorToSymbol(n,M,D);p.length&&(l=c(p,x,k),await J.applySizesToSymbol(n,l));for(const Q of K)J.applyRotationToSymbol(n,b(Q,x,k),Q.axis);return n}}};H.getLegendLabel=async function(x,k,l){if(x){var {layer:n,sourceLayer:z}=x,E=l?.renderer??e(n)??e(z);if(!E)return null;if("visualVariables"in E&&E.visualVariables?.length){const {getRampStops:c}=await new Promise((p,K)=>r(["../../widgets/Legend/support/colorRampUtils"],
p,K)),{getRampStops:b}=await new Promise((p,K)=>r(["../../widgets/Legend/support/sizeRampUtils"],p,K)),{getDateFormatOptions:v}=await new Promise((p,K)=>r(["../../widgets/Legend/support/utils"],p,K));let D=null;for(const p of E.visualVariables){var I=k?v(n,p,k.timeZone):null;let K=null;switch(p.type){case "color":K=await c(p,null,I);break;case "opacity":K=await c(p);break;case "size":p.target||(K=await b(E,p,null,l?.scale||k?.scale,k,I))}if(K?.length&&(I=K.find((M,Q)=>{const R=x.attributes[p.field];
return 0===Q?R>=M.value:Q===K?.length-1?R<=M.value:M.value===R}))){D=I.label;break}}if(D)return D}switch(E.type){case "class-breaks":return k="getClassBreakInfo"in E?await E.getClassBreakInfo(x,l):null,k?.label??(k&&1<E.classBreakInfos?.length)?`${k.minValue} - ${k.maxValue}`:null;case "unique-value":return("getUniqueValueInfo"in E?await E.getUniqueValueInfo(x,l):null)?.label}return null}};H.renderColorRampPreviewHTML=function(x,k={}){var l="horizontal"===k.align;const n=k.width??(l?75:24),z=k.height??
(l?24:75);var E=k.gradient??!0,I=window.devicePixelRatio,c=n*I,b=z*I;I=document.createElement("canvas");I.width=c;I.height=b;I.ariaLabel=k.ariaLabel??null;I.style.width=`${n}px`;I.style.height=`${z}px`;const v=I.getContext("2d");var D=l?c:0;const p=l?0:b;if(E){const K=v.createLinearGradient(0,0,D,p);l=x.length;const M=1===l?0:1/(l-1);x.forEach((Q,R)=>K.addColorStop(R*M,Q.toString()));v.fillStyle=K;v.fillRect(0,0,c,b)}else{c=l?c/x.length:c;b=l?b:b/x.length;D=E=0;for(const K of x)v.fillStyle=K.toString(),
v.fillRect(E,D,c,b),E=l?E+c:0,D=l?0:D+b}x=document.createElement("div");x.style.width=`${n}px`;x.style.height=`${z}px`;y(x,k?.effectList);x.appendChild(I);return x};H.renderDotDensityPreviewHTML=function(x,k,l){const {backgroundColor:n,outline:z,dotSize:E}=x;var I=l?.swatchSize||F.SymbolSizeDefaults.size;const c=Math.round(I*I/Math.max(E,.5)**2*.8),b=window.devicePixelRatio;x=document.createElement("canvas");const v=I*b;x.width=v;x.height=v;x.style.width=`${x.width/b}px`;x.style.height=`${x.height/
b}px`;const D=x.getContext("2d");n&&(D.fillStyle=n.toCss(!0),D.fillRect(0,0,v,v),D.fill());D.fillStyle=k?.toCss(!0)??"";if(g&&g.length/2===c)for(k=0;k<2*c;k+=2)D.fillRect(g[k],g[k+1],E*b,E*b),D.fill();else for(g=[],k=0;k<2*c;k+=2){const p=Math.floor(Math.random()*(v-0+1)),K=Math.floor(Math.random()*(v-0+1));g.push(p,K);D.fillRect(p,K,E*b,E*b);D.fill()}z&&(z.color&&(D.strokeStyle=z.color.toCss(!0)),D.lineWidth=z.width,D.strokeRect(0,0,v,v));I=new Image(I,I);I.src=x.toDataURL();I.ariaLabel=l?.ariaLabel??
null;I.alt=l?.ariaLabel??"";return I};H.renderPieChartPreviewHTML=function(x,k={}){const l=k.radius||40;var n=2*Math.PI*l,z=x.length;const E=n/z,I=[],c=q.getStroke(k.outline);null!=c?.width&&(c.width*=2);(c||k.backgroundColor)&&I.push({shape:{type:"circle",cx:l,cy:l,r:l},fill:k.backgroundColor,stroke:c,offset:[0,0]});const b=k.values,v=b&&b.length===z&&100===b.reduce((p,K)=>p+K,0),D=[0];for(let p=0;p<z;p++){let K=null;v&&(K=b[p]*n/100,D.push(K+D[p]));I.push({shape:{type:"circle",cx:l,cy:l,r:l/2},
fill:[0,0,0,0],stroke:{width:l,dashArray:`${(K??E)/2} ${n}`,dashoffset:`-${v?D[p]/2:E/2*p}`,color:x[p]},offset:[0,0]})}z=null;x=2*l+(c?.width||0);if(n=k.holePercentage)c&&I.push({shape:{type:"circle",cx:l,cy:l,r:l*n},fill:null,stroke:c,offset:[0,0]}),z=x/2,z=[[{shape:{type:"circle",cx:z,cy:z,r:z},fill:h,stroke:c?{...c,color:h}:null,offset:[0,0]},{shape:{type:"circle",cx:z,cy:z,r:l*n},fill:[0,0,0],stroke:null,offset:[0,0]}]];return B.renderSymbol([I],[x,x],{effectView:k.effectList,ignoreStrokeWidth:!0,
masking:z,rotation:-90,ariaLabel:k.ariaLabel})};H.renderPreviewHTML=d;H.renderRelationshipRampPreviewHTML=function(x,k={}){const l=x?.authoringInfo;if("relationship"!==l?.type||!l?.numClasses||!x.uniqueValueInfos)return null;const {focus:n,numClasses:z}=l,E=G.getRelationshipRampElement({focus:n,numClasses:z,infos:x.uniqueValueInfos});x=k?.node||document.createElement("div");B.renderOnce(x,()=>N.renderRelationshipRamp(E,k.id||"relationship",{opacity:k.opacity||1,effectList:k.effectList,ariaLabel:k.ariaLabel}));
return x};Object.defineProperty(H,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/styles/support/relationshipUtils":function(){define(["exports","../../../../symbols/support/svgUtils","../../../../symbols/support/utils","../../../support/widgetUtils","../../../support/jsxFactory"],function(r,H,P,A,q){function F(N,G,y){const d=`${y}_arrowStart`;y=`${y}_arrowEnd`;N="left"===N;const f={markerStart:null,markerEnd:null};switch(G){case "HL":N?f.markerStart=`url(#${y})`:f.markerEnd=`url(#${d})`;
break;case "LL":f.markerStart=`url(#${y})`;break;case "LH":N?f.markerEnd=`url(#${d})`:f.markerStart=`url(#${y})`;break;default:f.markerEnd=`url(#${d})`}return f}function B(N,G,y={}){const {focus:d,numClasses:f,colors:e,rotation:g}=N,{opacity:h,effectList:x,ariaLabel:k}=y;N=y.size??60;y=!!d;const l=Math.sqrt(N**2+N**2)+(y?0:5),n=[],z=[];var E=[],I=(N||75)/f;for(var c=0;c<f;c++){var b=c*I;for(var v=0;v<f;v++){var D=v*I,p=H.generateFillAttributes(e[c][v]);const K=H.generateStrokeAttributes(null);D={type:"rect",
x:D,y:b,width:I,height:I};const M=H.renderDef(p);M&&n.push(M);(p=H.renderShape(D,p.fill,K,null))&&z.push(p);E.push(H.getBoundingBox(D))}}I=null;y||(I="margin: -15px -15px -18px -15px");c=F("left",d,G);b=F("right",d,G);v=H.computeBBox(E);E=H.getTransformMatrix(v,l,l,0,!1,g,!1);v=H.getTransformMatrix(v,l,l,0,!1,y?-45:null,!1);p={filter:P.getCSSFilterFromEffectList(x)??void 0,opacity:null==h?"":`${h}`};return q.tsx("div",{class:y?J.diamondMidColRamp:J.squareTableCell,styles:p},q.tsx("svg",{"aria-labelledBy":k,
focusable:!1,height:l,role:"image",style:I,width:l,xmlns:"http://www.w3.org/2000/svg"},q.tsx("defs",null,q.tsx("marker",{id:`${G}_arrowStart`,markerHeight:"10",markerUnits:"strokeWidth",markerWidth:"10",orient:"auto",refX:"5",refY:"5"},q.tsx("polyline",{fill:"none",points:"0,0 5,5 0,10",stroke:"#555555","stroke-width":"1"})),q.tsx("marker",{id:`${G}_arrowEnd`,markerHeight:"10",markerUnits:"strokeWidth",markerWidth:"10",orient:"auto",refX:"0",refY:"5"},q.tsx("polyline",{fill:"none",points:"5,0 0,5 5,10",
stroke:"#555555","stroke-width":"1"})),n),q.tsx("g",{transform:E},z),q.tsx("g",{transform:v},q.tsx("line",{fill:"none","marker-end":c.markerEnd,"marker-start":c.markerStart,stroke:"#555555","stroke-width":"1",x1:-10,x2:-10,y1:N-15,y2:15}),q.tsx("line",{fill:"none","marker-end":b.markerEnd,"marker-start":b.markerStart,stroke:"#555555","stroke-width":"1",x1:15,x2:N-15,y1:N+10,y2:N+10}))))}const J={diamondContainer:"esri-relationship-ramp--diamond__container",diamondLeftCol:"esri-relationship-ramp--diamond__left-column",
diamondRightCol:"esri-relationship-ramp--diamond__right-column",diamondMidCol:"esri-relationship-ramp--diamond__middle-column",diamondMidColLabel:"esri-relationship-ramp--diamond__middle-column--label",diamondMidColRamp:"esri-relationship-ramp--diamond__middle-column--ramp",squareTable:"esri-relationship-ramp--square__table",squareTableRow:"esri-relationship-ramp--square__table-row",squareTableCell:"esri-relationship-ramp--square__table-cell",squareTableLabel:"esri-relationship-ramp--square__table-label",
squareTableLabelLeftBottom:"esri-relationship-ramp--square__table-label--left-bottom",squareTableLabelRightBottom:"esri-relationship-ramp--square__table-label--right-bottom",squareTableLabelLeftTop:"esri-relationship-ramp--square__table-label--left-top",squareTableLabelRightTop:"esri-relationship-ramp--square__table-label--right-top"};r.renderRelationshipRamp=function(N,G,y={}){const {focus:d,labels:f}=N,e=!!d;N=B(N,G,y);G={justifyContent:"center"};y=A.isRTL();return e?q.tsx("div",{class:J.diamondContainer,
styles:G},q.tsx("div",{class:J.diamondLeftCol},y?f.right:f.left),q.tsx("div",{class:J.diamondMidCol},q.tsx("div",{class:J.diamondMidColLabel},f.top),N,q.tsx("div",{class:J.diamondMidColLabel},f.bottom)),q.tsx("div",{class:J.diamondRightCol},y?f.left:f.right)):q.tsx("div",{class:J.squareTable},q.tsx("div",{class:J.squareTableRow},q.tsx("div",{class:A.classes(J.squareTableCell,J.squareTableLabel,J.squareTableLabelRightBottom)},y?f.top:f.left),q.tsx("div",{class:J.squareTableCell}),q.tsx("div",{class:A.classes(J.squareTableCell,
J.squareTableLabel,J.squareTableLabelLeftBottom)},y?f.left:f.top)),q.tsx("div",{class:J.squareTableRow},q.tsx("div",{class:J.squareTableCell}),N,q.tsx("div",{class:J.squareTableCell})),q.tsx("div",{class:J.squareTableRow},q.tsx("div",{class:A.classes(J.squareTableCell,J.squareTableLabel,J.squareTableLabelRightTop)},y?f.right:f.bottom),q.tsx("div",{class:J.squareTableCell}),q.tsx("div",{class:A.classes(J.squareTableCell,J.squareTableLabel,J.squareTableLabelLeftTop)},y?f.bottom:f.right)))};Object.defineProperty(r,
Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/relationshipRampUtils":function(){define(["exports","../../../core/lang","../../../symbols/support/gfxUtils","../../../symbols/support/previewSymbol3D"],function(r,H,P,A){function q(G){if(G){var {type:y}=G;return y.includes("3d")?A.getSymbolLayerFill(G.symbolLayers.at(0)):"simple-line"===y||"simple-marker"===G.type&&("x"===G.style||"cross"===G.style)?(G=P.getStroke(G))&&G.color:P.getFill(G)}}function F(G,y){const d=y.HH.label,f=
y.LL.label,e=y.HL.label;y=y.LH.label;switch(G){case "HH":return{top:d,bottom:f,left:e,right:y};case "HL":return{top:e,bottom:y,left:f,right:d};case "LL":return{top:f,bottom:d,left:y,right:e};case "LH":return{top:y,bottom:e,left:d,right:f};default:return{top:d,bottom:f,left:e,right:y}}}function B(G){let y=J[G];G&&null==y&&(y=J.HH);return y||0}const J={HH:315,HL:45,LL:135,LH:225},N={2:[["HL","HH"],["LL","LH"]],3:[["HL","HM","HH"],["ML","MM","MH"],["LL","LM","LH"]],4:[["HL","HM1","HM2","HH"],["M2L",
"M2M1","M2M2","M2H"],["M1L","M1M1","M1M2","M1H"],["LL","LM1","LM2","LH"]]};r.getRelationshipRampColors2D=function(G,y){const d=[],f=G.length**.5;G=H.clone(G);var e=(y||"HH").split("");y=e[0];for(e="H"===e[1];G.length;){const g=[];for(;g.length<f;)g.push(G.shift());e&&g.reverse();d.push(g)}"L"===y&&d.reverse();return d};r.getRelationshipRampElement=function(G){const {focus:y,infos:d,numClasses:f}=G;var e=N[f];const g={};d.forEach(h=>{g[h.value]={label:h.label,fill:q(h.symbol)}});G=[];for(let h=0;h<
f;h++){const x=[];for(let k=0;k<f;k++)x.push(g[e[h][k]].fill);G.push(x)}e=F(y,g);return{type:"relationship-ramp",numClasses:f,focus:y,colors:G,labels:e,rotation:B(y)}};r.getRotationAngleForFocus=B;Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/previewSymbol3D":function(){define("exports ../../assets ../../core/colorUtils ../../core/has ../../core/Error ../../core/Logger ../../core/screenUtils ./gfxUtils ./IconSymbol3DLayerResource ./ObjectSymbol3DLayerResource ./previewUtils ./renderUtils ./utils ./webStyleSymbolUtils".split(" "),
function(r,H,P,A,q,F,B,J,N,G,y,d,f,e){function g(m){const w=m.outline;var S=null!=m.material?m.material.color:null;S=null!=S?S.toHex():null;if(null==w||"pattern"in w&&null!=w.pattern&&"style"===w.pattern.type&&"none"===w.pattern.style)return"fill"===m.type&&"#ffffff"===S?{color:"#bdc3c7",width:.75}:null;m=B.pt2px(w.size)||0;return{color:"rgba("+(null!=w.color?w.color.toRgba():"255,255,255,1")+")",width:Math.min(m,Z),style:"pattern"in w&&null!=w.pattern&&"style"===w.pattern.type?J.dekebabifyLineStyle(w.pattern.style):
null,join:"butt",cap:"patternCap"in w?w.patternCap:"butt"}}async function h(m,w){if(m.thumbnail?.url)return m.thumbnail.url;if("icon"===w.type&&w?.resource?.href)return f.getIconHref(w);w=H.getAssetUrl("esri/images/Legend/legend3dsymboldefault.png");return m.styleOrigin&&(m.styleOrigin.styleName||m.styleOrigin.styleUrl)&&(m=await e.resolveWebStyleSymbol(m.styleOrigin,{portal:m.styleOrigin.portal},"webRef").catch(()=>null))&&"thumbnail"in m&&m.thumbnail?.url?m.thumbnail.url:w}function x(m,w=1){const S=
m.a;m=P.toHSV(m);const {r:U,g:W,b:ea}=P.toRGB({h:m.h,s:m.s/w,v:100-(100-m.v)/w});return[U,W,ea,S]}function k(m){return"water"===m.type?null==m.color?null:m.color:null==m.material?.color?null:m.material.color}function l(m,w=0){var S=k(m);if(!S){if("fill"===m.type)return null;w=y.adjustColorComponentBrightness(J.defaultThematicColor.r,w);return[w,w,w,100]}m=S.toRgba();for(S=0;3>S;S++)m[S]=y.adjustColorComponentBrightness(m[S],w);return m}async function n(m,w){m=m.style;return"none"===m?null:{type:"pattern",
x:0,y:0,src:await J.getPatternUrlWithColor(H.getAssetUrl(`esri/symbols/patterns/${m}.png`),w.toCss(!0)),width:5,height:5}}function z(m){return m.outline?g(m):{color:"rgba(0, 0, 0, 1)",width:1.5}}function E(m,w){m=k(m);if(!m)return null;let S;S="rgba("+(y.adjustColorComponentBrightness(m.r,w)+",");S+=y.adjustColorComponentBrightness(m.g,w)+",";S+=y.adjustColorComponentBrightness(m.b,w)+",";return S+m.a+");"}function I(m,w){w=E(m,w);if(!w)return{};if("pattern"in m&&null!=m.pattern&&"style"===m.pattern.type&&
"none"===m.pattern.style)return null;const S=Math.min(m.size?B.pt2px(m.size):.75,Z);return{color:w,width:S,style:"pattern"in m&&null!=m.pattern&&"style"===m.pattern.type?J.dekebabifyLineStyle(m.pattern.style):null,cap:"cap"in m?m.cap:null,join:"join"in m?"miter"===m.join?B.pt2px(2):m.join:null}}function c(m,w,S){S=null!=S?.75*S:0;return{type:"linear",x1:S?.25*S:0,y1:S?.5*S:0,x2:S||4,y2:S?.5*S:4,colors:[{color:m,offset:0},{color:w,offset:1}]}}function b(m){const w=m.depth,S=m.height;m=m.width;return 0!==
m&&0!==w&&0!==S&&m===w&&null!=m&&null!=S&&m<S}function v(m,w,S){const U=[];if(!m)return U;switch(m.type){case "icon":switch(m.resource&&m.resource.primitive||N.defaultPrimitive){case "circle":U.push({shape:{type:"circle",cx:0,cy:0,r:.5*w},fill:l(m,0),stroke:g(m)});break;case "square":U.push({shape:{type:"path",path:[{command:"M",values:[0,w]},{command:"L",values:[0,0]},{command:"L",values:[w,0]},{command:"L",values:[w,w]},{command:"Z",values:[]}]},fill:l(m,0),stroke:g(m)});break;case "triangle":U.push({shape:{type:"path",
path:[{command:"M",values:[0,w]},{command:"L",values:[.5*w,0]},{command:"L",values:[w,w]},{command:"Z",values:[]}]},fill:l(m,0),stroke:g(m)});break;case "cross":U.push({shape:{type:"path",path:[{command:"M",values:[.5*w,0]},{command:"L",values:[.5*w,w]},{command:"M",values:[0,.5*w]},{command:"L",values:[w,.5*w]}]},stroke:z(m)});break;case "x":U.push({shape:{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[w,w]},{command:"M",values:[w,0]},{command:"L",values:[0,w]}]},stroke:z(m)});
break;case "kite":U.push({shape:{type:"path",path:[{command:"M",values:[0,.5*w]},{command:"L",values:[.5*w,0]},{command:"L",values:[w,.5*w]},{command:"L",values:[.5*w,w]},{command:"Z",values:[]}]},fill:l(m,0),stroke:g(m)})}break;case "object":switch(m.resource&&m.resource.primitive||G.defaultPrimitive){case "cone":var W=l(m,0);m=l(m,-.6);m=c(W,m,S?u:w);w=y.getConeShapes(w,S);U.push({shape:w[0],fill:m},{shape:w[1],fill:m});break;case "inverted-cone":S=l(m,0);m=l(m,-.6);m=c(S,m,w);w=y.getInvertedConeShapes(w);
U.push({shape:w[0],fill:m},{shape:w[1],fill:S});break;case "cube":w=y.getCubeShapes(w,S);U.push({shape:w[0],fill:l(m,0)},{shape:w[1],fill:l(m,-.3)},{shape:w[2],fill:l(m,-.5)});break;case "cylinder":W=l(m,0);const ea=l(m,-.6);W=c(W,ea,S?u:w);w=y.getCylinderShapes(w,S);U.push({shape:w[0],fill:W},{shape:w[1],fill:W},{shape:w[2],fill:l(m,0)});break;case "diamond":w=y.getDiamondShapes(w);U.push({shape:w[0],fill:l(m,-.3)},{shape:w[1],fill:l(m,0)},{shape:w[2],fill:l(m,-.3)},{shape:w[3],fill:l(m,-.7)});break;
case "sphere":S=l(m,0);m=l(m,-.6);m=c(S,m);m.x1=0;m.y1=0;m.x2=.25*w;m.y2=.25*w;U.push({shape:{type:"circle",cx:0,cy:0,r:.5*w},fill:m});break;case "tetrahedron":w=y.getTetrahedronShapes(w),U.push({shape:w[0],fill:l(m,-.3)},{shape:w[1],fill:l(m,0)},{shape:w[2],fill:l(m,-.6)})}}return U}function D(m){return(m="number"===typeof m?.size?m?.size:null)?B.pt2px(m):null}async function p(m,w){const S=D(w),U=w?.maxSize?B.pt2px(w.maxSize):null,W=w?.disableUpsampling??!1,ea=m.symbolLayers,ja=[];let aa=0,la=0;
const V=ea.at(-1);let ba;V&&"icon"===V.type&&(ba=V.size&&B.pt2px(V.size));ea.forEach(ca=>{if("icon"===ca.type||"object"===ca.type){var na="icon"===ca.type?ca.size&&B.pt2px(ca.size):0,pa=S||na?Math.ceil(Math.min(S||na,U||R)):Q;if(ca?.resource?.href){var sa=h(m,ca).then(ua=>{const ya=ca?.material?.color;var wa="icon"===ca.type?"multiply":"tint";return d.tintImageWithColor(ua,pa,ya,wa,W)}).then(ua=>{const ya=ua.width,wa=ua.height;aa=Math.max(aa,ya);la=Math.max(la,wa);return[{shape:{type:"image",x:0,
y:0,width:ya,height:wa,src:ua.url},fill:null,stroke:null}]});ja.push(sa)}else sa=pa,"icon"===ca.type&&ba&&S&&(sa=na/ba*pa),na="tall"===w?.symbolConfig||w?.symbolConfig?.isTall||("object"===ca.type?b(ca):!1),aa=Math.max(aa,na?u:sa),la=Math.max(la,sa),ja.push(Promise.resolve(v(ca,sa,na)))}});const da=[];(await Promise.allSettled(ja)).forEach(ca=>{"fulfilled"===ca.status?da.push(ca.value):ca.reason&&F.getLogger("esri.symbols.support.previewSymbol3D").warn("error while building swatchInfo!",ca.reason)});
return d.renderSymbol(da,[aa,la],{node:w?.node,scale:!1,opacity:w?.opacity,ariaLabel:w?.ariaLabel})}function K(m,w){const S=m.symbolLayers,U=[];m=f.isVolumetricSymbol(m);const W=D(w),ea=(w?.maxSize?B.pt2px(w.maxSize):null)||Z;let ja=0,aa=0,la;S.forEach((V,ba)=>{if(V&&("line"===V.type||"path"===V.type)){var da=[];switch(V.type){case "line":var ca=I(V,0);if(null==ca)break;var na=ca?.width||0;0===ba&&(la=na);V=Math.min(W||na,ea);ba=0===ba?V:W?na/la*V:V;na=ba>X/2?2*ba:X;aa=Math.max(aa,ba);ja=Math.max(ja,
na);ca.width=ba;da.push({shape:{type:"path",path:[{command:"M",values:[0,.5*aa]},{command:"L",values:[ja,.5*aa]}]},stroke:ca});break;case "path":ca=Math.min(W||Q,ea);ba=l(V,0);na=l(V,-.2);var pa=E(V,-.4);pa=pa?{color:pa,width:1}:{};if("quad"===V.profile){const sa=V.width;V=V.height;V=y.getPathSymbolShapes(sa&&V?sa/V:1,0===V,0===sa);pa={...pa,join:"bevel"};da.push({shape:V[0],fill:na,stroke:pa},{shape:V[1],fill:na,stroke:pa},{shape:V[2],fill:ba,stroke:pa})}else da.push({shape:y.shapes.pathSymbol3DLayer[0],
fill:na,stroke:pa},{shape:y.shapes.pathSymbol3DLayer[1],fill:ba,stroke:pa});ja=aa=Math.max(aa,ca)}U.push(da)}});return Promise.resolve(d.renderSymbol(U,[ja,aa],{node:w?.node,scale:m,opacity:w?.opacity,ariaLabel:w?.ariaLabel}))}async function M(m,w){const S="mesh-3d"===m.type;m=m.symbolLayers;var U=D(w);const W=w?.maxSize?B.pt2px(w.maxSize):null;U=U||Q;const ea=[];let ja=0,aa=0;var la=!1;for(let na=0;na<m.length;na++){var V=m.at(na);const pa=[];if(!S||"fill"===V.type){switch(V.type){case "fill":la=
Math.min(U,W||R);ja=Math.max(ja,la);aa=Math.max(aa,la);la=!0;if(S){var ba=y.shapes.meshSymbol3DFill,da=E(V,-.4);da=da?{color:da,width:1,join:"round"}:{};pa.push({shape:ba[0],fill:l(V,0),stroke:da},{shape:ba[1],fill:l(V,-.2),stroke:da},{shape:ba[2],fill:l(V,-.6),stroke:da})}else{ba=l(V,0);da="pattern"in V?V.pattern:null;var ca=g(V);V=k(V);null!=da&&"style"===da.type&&"solid"!==da.style&&V&&(ba=await n(da,V));pa.push({shape:y.shapes.fill[0],fill:ba,stroke:ca})}break;case "line":V=I(V,0);if(null==V)break;
V={stroke:V,shape:y.shapes.fill[0]};ja=Math.max(ja,Q);aa=Math.max(aa,Q);pa.push(V);break;case "extrude":ba={join:"round",width:1,...I(V,-.4)};da=l(V,0);V=l(V,-.2);ca=Math.min(U,W||R);const sa=y.getExtrudeSymbolShapes(ca);ba.width=1;pa.push({shape:sa[0],fill:V,stroke:ba},{shape:sa[1],fill:V,stroke:ba},{shape:sa[2],fill:da,stroke:ba});V=.7*Q+.5*ca;ja=Math.max(ja,Q);aa=Math.max(aa,V);break;case "water":la=k(V),V=x(la),ba=x(la,2),da=x(la,3),ca=y.getWaterSymbolShapes(),la=!0,pa.push({shape:ca[0],fill:V},
{shape:ca[1],fill:ba},{shape:ca[2],fill:da}),V=Math.min(U,W||R),ja=Math.max(ja,V),aa=Math.max(aa,V)}ea.push(pa)}}return d.renderSymbol(ea,[ja,aa],{node:w?.node,scale:la,opacity:w?.opacity,ariaLabel:w?.ariaLabel})}const Q=y.SymbolSizeDefaults.size,R=y.SymbolSizeDefaults.maxSize,Z=y.SymbolSizeDefaults.maxOutlineSize,X=y.SymbolSizeDefaults.lineWidth,u=y.SymbolSizeDefaults.tallSymbolWidth;r.getPatternDescriptor=n;r.getSizeFromOptions=D;r.getSymbolLayerFill=l;r.previewSymbol3D=function(m,w){if(0===m.symbolLayers.length)return Promise.reject(new q("symbolPreview: renderPreviewHTML3D",
"No symbolLayers in the symbol."));switch(m.type){case "point-3d":return p(m,w);case "line-3d":return K(m,w);case "polygon-3d":case "mesh-3d":return M(m,w)}return Promise.reject(new q("symbolPreview: swatchInfo3D","symbol not supported."))};Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/webStyleSymbolUtils":function(){define("exports ../../symbols ../../core/devEnvironmentUtils ../../core/Error ../../core/urlUtils ../../portal/Portal ../../chunks/persistableUrlUtils ./jsonUtils ./StyleOrigin ./styleUtils ./Thumbnail".split(" "),
function(r,H,P,A,q,F,B,J,N,G,y){function d(g,h){return h.items.find(x=>x.name===g)}function f(g,h,x,k,l,n){const z=null!=x?.portal?x.portal:F.getDefault(),E={portal:z,url:q.urlToObject(g.baseUrl),origin:"portal-item"},I=d(h,g.data);if(!I)return Promise.reject(new A("symbolstyleutils:symbol-name-not-found",`The symbol name '${h}' could not be found`,{symbolName:h}));l=B.fromJSON(l(I,k),E);let c=I.thumbnail?.href??null;const b=I.thumbnail?.imageData;P.isDevEnvironment()&&(l=P.adjustStaticAGOUrl(l)??
"",c=P.adjustStaticAGOUrl(c));const v={portal:z,url:q.urlToObject(q.removeFile(l)),origin:"portal-item"};return G.requestJSON(l,n).then(D=>{D="cimRef"===k?G.makeCIMSymbolRef(D.data):D.data;if((D=J.fromJSON(D,v))&&H.isSymbol3D(D)){if(c){const p=B.fromJSON(c,E);D.thumbnail=new y.Thumbnail({url:p})}else b&&(D.thumbnail=new y.Thumbnail({url:`data:image/png;base64,${b}`}));g.styleUrl?D.styleOrigin=new N({portal:x.portal,styleUrl:g.styleUrl,name:h}):g.styleName&&(D.styleOrigin=new N({portal:x.portal,styleName:g.styleName,
name:h}))}return D})}function e(g,h,x){const k=G.Style2DUrlTemplate.replaceAll(/\{SymbolName\}/gi,g),l=null!=h.portal?h.portal:F.getDefault();return G.requestJSON(k,x).then(n=>{n=G.makeCIMSymbolRef(n.data);return J.fromJSON(n,{portal:l,url:q.urlToObject(q.removeFile(k)),origin:"portal-item"})})}r.fetchSymbolFromStyle=f;r.getStyleItemFromStyle=d;r.resolveWebStyleSymbol=function(g,h,x,k){const l=g.name;return null==l?Promise.reject(new A("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference")):
g.styleName&&"Esri2DPointSymbolsStyle"===g.styleName?e(l,h,k):G.fetchStyle(g,h,k).then(n=>f(n,l,h,x,G.symbolUrlFromStyleItem,k))};Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})})},"esri/core/devEnvironmentUtils":function(){define(["exports"],function(r){const H=/^devext.arcgis.com$/,P=/^qaext.arcgis.com$/,A=/^[\w-]*\.mapsdevext.arcgis.com$/,q=/^[\w-]*\.mapsqa.arcgis.com$/,F=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local.esri.com$/,H,P,/^jsapps.esri.com$/,A,q];r.adjustStaticAGOUrl=function(B,J){return B?
(J=J||globalThis.location.hostname)?null!=J.match(H)||null!=J.match(A)?B.replace("static.arcgis.com","staticdev.arcgis.com"):null!=J.match(P)||null!=J.match(q)?B.replace("static.arcgis.com","staticqa.arcgis.com"):B:B:B};r.devHostnames=F;r.isDevEnvironment=function(B){B=B||globalThis.location.hostname;return F.some(J=>null!=B?.match(J))};Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/clusterUtils":function(){define(["exports","../../../renderers/visualVariables/SizeVariable"],
function(r,H){r.getEffectiveClusterSizeVariable=function(P,A,q){var F=P.effectiveClusterRenderer;if(!(F&&"visualVariables"in F&&F.visualVariables))return null;F=F.visualVariables.find(N=>"size"===N.type);if(!("stops"in F&&F.stops))return null;const B=F.stops.find(N=>N.useMinValue),J=F.stops.find(N=>N.useMaxValue);if(null==B||null==J)return null;q=q.featuresTilingScheme.getClosestInfoForScale(q.scale).level;return(A=A.getDisplayStatistics(q,F.field))?new H({field:F.field,minSize:P.clusterMinSize,minDataValue:A.minValue,
maxSize:P.clusterMaxSize,maxDataValue:A.maxValue}):null};Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/colorRampUtils":function(){define(["require","exports","../../../Color","./utils"],function(r,H,P,A){function q(G,y){const d=[],f=G.length-1;5===G.length?d.push(0,2,4):d.push(0,f);return G.map((e,g)=>d.includes(g)?A.createStopLabel(e,g,f,y):null)}async function F(G,y,d){d=new P(d??N);G=(await new Promise((f,e)=>r(["../../../renderers/visualVariables/support/visualVariableUtils"],
f,e))).getOpacity(y,G);null!=G&&(d.a=G);return d}function B(G,y){const {startIndex:d,endIndex:f,weight:e}=J(G,y);if(d===f)return y[d].color;G=P.blendColors(y[d].color,y[f].color,e);return new P(G)}function J(G,y){let d=0,f=y.length-1;y.some((e,g)=>{if(G<e.value)return f=g,!0;d=g;return!1});return{startIndex:d,endIndex:f,weight:(G-y[d].value)/(y[f].value-y[d].value)}}const N=new P([64,64,64]);H.getColorFromPointCloudStops=B;H.getRampStops=async function(G,y,d){let f=!1,e=[],g=[];if(G.stops){var h=
G.stops;e=h.map(k=>k.value);(f=h.some(k=>!!k.label))&&(g=h.map(k=>k.label))}h=e[e.length-1];if(null==e[0]&&null==h)return null;const x=f?null:q(e,d);return(await Promise.all(e.map(async(k,l)=>{const n="opacity"===G.type?await F(k,G,y):(await new Promise((z,E)=>r(["../../../renderers/visualVariables/support/visualVariableUtils"],z,E))).getColor(G,k);return{value:k,color:n,label:f?g[l]:x?.[l]??""}}))).reverse()};H.getRampStopsForPointCloud=function(G){let y=!1,d=[],f=[];d=G.map(h=>h.value);(y=G.some(h=>
!!h.label))&&(f=G.map(h=>h.label??""));const e=d[d.length-1];if(null==d[0]&&null==e)return null;const g=y?null:q(d);return d.map((h,x)=>{const k=B(h,G);return{value:h,color:k,label:y?f[x]:g?.[x]??""}}).reverse()};H.getStretchRampStops=function(G,y){let d=[];if(G&&"multipart"===G.type)G.colorRamps.reverse().forEach((f,e)=>{0===e?d.push({value:y.max,color:new P(f.toColor),label:"high"}):d.push({value:null,color:new P(f.toColor),label:""});e===G.colorRamps.length-1?d.push({value:y.min,color:new P(f.fromColor),
label:"low"}):d.push({value:null,color:new P(f.fromColor),label:""})});else{let f,e;G&&"algorithmic"===G.type?(f=G.fromColor,e=G.toColor):(f=[0,0,0,1],e=[255,255,255,1]);d=[{value:y.max,color:new P(e),label:"high"},{value:y.min,color:new P(f),label:"low"}]}return d};Object.defineProperty(H,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/utils":function(){define("require exports ../../../symbols ../../../core/timeUtils ../../../layers/support/fieldUtils ../../../renderers/support/numberUtils ../../../smartMapping/support/utils ../../../symbols/SimpleLineSymbol".split(" "),
function(r,H,P,A,q,F,B,J){async function N(d){if(!("visualVariables"in d&&d.visualVariables))return null;d=d.visualVariables.find(g=>"color"===g.type);if(!d)return null;var f=null,e=null;if(d.stops){if(1===d.stops.length)return d.stops[0].color;f=d.stops[0].value;e=d.stops[d.stops.length-1].value}f=null!=f&&null!=e?f+(e-f)/2:0;({getColor:e}=await new Promise((g,h)=>r(["../../../renderers/visualVariables/support/visualVariableUtils"],g,h)));return e(d,f)??null}function G(d,f){if(!f.field)return null;
if("featureReduction"in d)switch(d.featureReduction?.type){case "cluster":case "binning":const e=d.featureReduction.fields.find(({name:g})=>g.toLowerCase()===f.field.toLowerCase());return e&&"getField"in d?d.getField(e.onStatisticField):null}return"getField"in d?d.getField?.(f.field):null}function y(d,f){d="popupTemplate"in d?d.popupTemplate?.fieldInfos:null;if(d?.length&&f)return d.find(e=>e.fieldName?.toLowerCase()===f.toLowerCase())?.format?.dateFormat}H.createStopLabel=function(d,f,e,g){let h=
"";0===f?h="\x3c ":f===e&&(h="\x3e ");d=g?B.formatAnyDate(d,g):F.format(d);return h+d};H.getDateFormatOptions=function(d,f,e){const g=G(d,f);if(!g||!B.isAnyDateField(g)&&!q.isTimeOnlyField(g))return null;var h=y(d,g.name);if(!h&&"date"===g.type){let x=h=0;f.stops?(h=f.stops?.at(0)?.value??h,x=f.stops?.at(-1)?.value??x):"minDataValue"in f&&"maxDataValue"in f&&(h=f.minDataValue??h,x=f.maxDataValue??x);h=x-h>2*A.millisecondsPerTimeUnit.days?"short-date":"short-date-short-time"}return{fieldType:g.type,
format:h,timeZoneOptions:{layerTimeZone:"preferredTimeZone"in d?d.preferredTimeZone:null,viewTimeZone:e,datesInUnknownTimezone:"datesInUnknownTimezone"in d&&d.datesInUnknownTimezone}}};H.getMedianColor=N;H.getSymbolForFlowRenderer=async function(d,f){const e=d.trailCap,g=d.trailWidth||1;d=f||await N(d)||d.color;return new J({cap:e,color:d,width:g})};H.isRasterBandStatistics=function(d){return null!=d&&"object"===typeof d&&"min"in d&&"max"in d};H.rgbImgSource=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII\x3d",
"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII\x3d","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII\x3d"];H.specialCharsGreaterThan="\x3e";H.specialCharsLessThan="\x3c";Object.defineProperty(H,Symbol.toStringTag,
{value:"Module"})})},"esri/renderers/support/numberUtils":function(){define(["exports","../../intl","../../intl/number"],function(r,H,P){function A(y,d){return y-d}function q(y,d){let f;f=Number(y.toFixed(d));f<y?y=f+1/10**d:(y=f,f-=1/10**d);f=Number(f.toFixed(d));y=Number(y.toFixed(d));return[f,y]}function F(y,d,f,e,g){y=J(y,d,f,e);d=null==y.next||y.next<=g;return(null==y.previous||y.previous<=g)&&d||y.previous+y.next<=2*g}function B(y){y=String(y);var d=y.match(N);if(d&&d[1])return{integer:d[1].split("").length,
fractional:d[3]?d[3].split("").length:0};if(y.toLowerCase().includes("e")&&(d=y.split("e"),y=d[0],d=d[1],y&&d)){y=Number(y);d=Number(d);const f=0<d;f||(d=Math.abs(d));y=B(y);f?(y.integer+=d,y.fractional=d>y.fractional?0:y.fractional-d):(y.fractional+=d,y.integer=d>y.integer?1:y.integer-d);return y}return{integer:0,fractional:0}}function J(y,d,f,e){const g={previous:null,next:null};if(null!=f){const h=y-f;g.previous=Math.floor(Math.abs(100*(d-f-h)/h))}null!=e&&(y=e-y,g.next=Math.floor(Math.abs(100*
(e-d-y)/y)));return g}const N=/^-?(\d+)(\.(\d+))?$/i,G={maximumFractionDigits:20};r.format=function(y){return P.formatNumber(y,G)};r.numDigits=B;r.percentChange=J;r.round=function(y,d={}){y=y.slice(0);const {tolerance:f=2,strictBounds:e=!1,indexes:g=y.map((x,k)=>k)}=d;g.sort(A);for(d=0;d<g.length;d++){const x=g[d],k=y[x],l=0===x?null:y[x-1],n=x===y.length-1?null:y[x+1],z=B(k).fractional;if(z){let E=0,I=!1;for(var h=void 0;E<=z&&!I;)h=q(k,E),h=e&&0===d?h[1]:h[0],I=F(k,h,l,n,f),E++;I&&(y[x]=h)}}return y};
Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})})},"esri/smartMapping/support/utils":function(){define("exports ../../intl/date ../../layers/support/fieldUtils ../../support/arcadeOnDemand ../../support/basemapUtils ../../time/timeZoneUtils".split(" "),function(r,H,P,A,q,F){function B(e){return String(e).padStart(2,"0")}function J(e,g,h){if("date"===g||"number"===g){"number"===g&&(e=new Date(e));g=h?e.getFullYear():e.getUTCFullYear();const x=B((h?e.getMonth():e.getUTCMonth())+1),k=B(h?
e.getDate():e.getUTCDate()),l=B(h?e.getHours():e.getUTCHours()),n=B(h?e.getMinutes():e.getUTCMinutes());e=B(h?e.getSeconds():e.getUTCSeconds());e=`TIMESTAMP'${g}-${x}-${k} ${l}:${n}:${e}'`}return e}function N(e,g){if(g instanceof Date)return"date";if("number"===typeof g)return"number";if("string"===typeof g&&(e=e.getField(g),"\x3cnow\x3e"!==g.toLowerCase()&&P.isDateField(e)))return"field"}const G={light:"streets gray topo terrain oceans osm gray-vector streets-vector topo-vector streets-relief-vector streets-navigation-vector topo-3d navigation-3d streets-3d osm-3d gray-3d arcgis-light-gray arcgis-navigation arcgis-streets arcgis-streets-relief arcgis-topographic arcgis-oceans osm-standard osm-standard-relief osm-streets osm-streets-relief osm-light-gray arcgis-terrain arcgis-charted-territory arcgis-community arcgis-colored-pencil arcgis-modern-antique arcgis-midcentury arcgis-newspaper arcgis-hillshade-light".split(" "),
dark:"satellite hybrid dark-gray dark-gray-vector streets-night-vector navigation-dark-3d streets-dark-3d dark-gray-3d arcgis-imagery arcgis-imagery-standard arcgis-dark-gray arcgis-navigation-night arcgis-streets-night osm-dark-gray arcgis-nova arcgis-hillshade-dark".split(" ")},y={years:365,months:30,days:1,hours:1/24,minutes:1/1440,seconds:1/86400,milliseconds:1/864E5},d=new Set(["integer","small-integer"]);let f=null;r.castIntegerFieldToFloat=function(e){return`cast(${e} as float)`};r.dateTypes=
["date","date-only","timestamp-offset"];r.defaultBasemapGroups=G;r.fieldDelimiter=",";r.formatAnyDate=function(e,g){const {format:h,timeZoneOptions:x,fieldType:k}=g??{};let l;x&&({timeZone:n,timeZoneName:l}=F.getTimeZoneFormattingOptions(x.layerTimeZone,x.datesInUnknownTimezone,x.viewTimeZone,H.convertDateFormatToIntlOptions(h||"short-date-short-time"),k));if("string"===typeof e&&isNaN(Date.parse("time-only"===k?`1970-01-01T${e}Z`:e)))return e;switch(k){case "date-only":var n=H.convertDateFormatToIntlOptions(h||
"short-date");return"string"===typeof e?H.formatDateOnly(e,{...n}):H.formatDate(e,{...n,timeZone:F.utc});case "time-only":return n=H.convertDateFormatToIntlOptions(h||"short-time"),"string"===typeof e?H.formatTimeOnly(e,n):H.formatDate(e,{...n,timeZone:F.utc});case "timestamp-offset":if(!n&&"string"===typeof e&&(new Date(e)).toISOString()!==e)return e;n=(g=h||x?H.convertDateFormatToIntlOptions(h||"short-date-short-time"):void 0)?{...g,timeZone:n,timeZoneName:l}:void 0;return"string"===typeof e?H.formatTimestamp(e,
n):H.formatDate(e,n);default:return g=h||x?H.convertDateFormatToIntlOptions(h||"short-date-short-time"):void 0,H.formatDate("string"===typeof e?new Date(e):e,g?{...g,timeZone:n,timeZoneName:l}:void 0)}};r.getBasemapGroup=function(e,g=G){for(const h in g)if(g[h].includes(e))return h};r.getBasemapId=function(e,g,h=!0){let x=null;e&&("string"===typeof e?g.includes(e)&&(x=e):x=q.getWellKnownBasemapId(e));return h?x||"gray":x};r.getDateDiffSQL=function(e,g,h,x){const {hasQueryEngine:k}=e;h=J(h,N(e,h),
k);e=J(g,N(e,g),k);e=`(${h} - ${e})`;x=y[x];g="/";1>x&&(x=1/x,g="*");return{sqlExpression:1===x?e:`(${e} ${g} ${x})`,sqlWhere:null}};r.getDateType=N;r.getFieldsList=async function(e){const {field:g,field2:h,field3:x,normalizationField:k,valueExpression:l}=e;e=[];l&&(f||({arcadeUtils:e}=await A.loadArcade(),f=e),e=f.extractFieldNames(l));g&&e.push(g);h&&e.push(h);x&&e.push(x);k&&e.push(k);return e};r.getNormalizationType=function(e){let g=e.normalizationType;g||(e.normalizationField?g="field":null!=
e.normalizationTotal&&(g="percent-of-total"));return g??void 0};r.isAnyDateField=function(e){return P.isDateField(e)||P.isDateOnlyField(e)||P.isTimestampOffsetField(e)};r.isIntegerField=function(e,g){e=g&&e.getField(g);return!!e&&d.has(e.type)};r.unitValueInDays=y;Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/heatmapRampUtils":function(){define(["exports","../../../renderers/support/HeatmapColorStop"],function(r,H){r.getHeatmapRampStops=function(P){if(!P.colorStops)return[];
const A=[...P.colorStops].filter(F=>0<F.color?.a);let q=A.length-1;if(A&&A[0]){const F=A[q];F&&1!==F.ratio&&(A.push(new H({ratio:1,color:F.color})),q++)}return A.map((F,B)=>{let J="";0===B?J=P.legendOptions?.minLabel||"low":B===q&&(J=P.legendOptions?.maxLabel||"high");return{color:F.color,label:J,ratio:F.ratio}}).reverse()};Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/sizeRampUtils":function(){define("require exports ../../../Color ../../../symbols ../../../renderers/support/numberUtils ../../../symbols/support/cimSymbolUtils ../../../symbols/support/utils ./utils ../../support/widgetUtils ../../../support/themeUtils ../../../symbols/SimpleMarkerSymbol ../../../symbols/SimpleLineSymbol".split(" "),
function(r,H,P,A,q,F,B,J,N,G,y,d){function f(p,K){const M=p.length-1;return p.map((Q,R)=>J.createStopLabel(Q,R,M,K))}function e(p,K){p=p?.authoringInfo;const M="univariate-color-size"===p?.type;let Q=[12,30];if(M){const R=K[0],Z=K[K.length-1];Q=K.map(X=>12+(X-R)/(Z-R)*18)}M&&"below"===p?.univariateTheme&&Q.reverse();return Q}function g(p,K){const M=p.classBreakInfos,Q=M.length;K=2>Q||!(2<=K)?M[0].symbol.clone():M[Q-1].symbol.clone();p.visualVariables.some(R=>"color"===R.type)&&(K.type.includes("3d")?
k(K):l(K));return K}async function h(p,K){if("flow"===p.type)return J.getSymbolForFlowRenderer(p,K);if("pie-chart"===p.type)return new y({color:null,outline:p.outline?.width?p.outline:new d});let M=null,Q=null;"simple"===p.type?M=p.symbol:"class-breaks"===p.type?(M=(p=p.classBreakInfos)&&p[0]&&p[0].symbol,Q=1<p.length):"unique-value"===p.type&&(p=p.uniqueValueInfos,M=p?.[0]?.symbol,Q=null!=p&&1<p.length);if(!M||x(M))return null;M=M.clone();if(K||Q)M.type.includes("3d")?k(M):l(M);return M}function x(p){return p?
A.isSymbol3D(p)?p.symbolLayers?p.symbolLayers.some(K=>K&&"fill"===K.type):!1:p.type.includes("fill"):!1}function k(p){"line-3d"===p.type?p.symbolLayers.forEach(K=>{K.material={color:D}}):p.symbolLayers.forEach(K=>{"icon"!==K.type||K.resource?.href?K.material={color:v}:(K.material={color:b},K.outline={color:D,size:1.5})})}function l(p){const K=G.isDarkTheme();if("cim"===p.type)F.applyCIMSymbolColor(p,new P(v));else if(p.type.includes("line"))p.color=D;else if(p.color=K?D:b,"simple-marker"===p.type)p.outline?
"#ffffff"===p.outline?.color?.toHex()&&(p.outline.color=D):p.outline={color:D,width:1.5}}async function n(p,K,M,Q){const R=(await new Promise((u,m)=>r(["../../../renderers/visualVariables/support/visualVariableUtils"],u,m))).getSizeRangeAtScale(p,M,Q),Z=R&&z(R);if(R&&Z){var X=Z.map(u=>{const m=R.minSize,w=R.maxSize,S=p.minDataValue,U=p.maxDataValue;return u<=m?S:u>=w?U:(u-m)/(w-m)*(U-S)+S});X=q.round(X);for(let u=1;u<X.length-1;u++){const m=await E(p,K,X[u],X[u-1],M,Q);m&&(X[u]=m[0],Z[u]=m[1])}return X}}
function z(p){const K=p.minSize;p=(p.maxSize-K)/4;const M=[];for(let Q=0;5>Q;Q++)M.push(K+p*Q);return M}async function E(p,K,M,Q,R,Z){const X=await I(p,K,M,R,Z);Q=await I(p,K,Q,R,Z);var u=q.numDigits(M),m=u.fractional,w=u.integer;let S=u=null;0<M&&1>M&&(u=10**m,M*=u,w=q.numDigits(M).integer);for(m=w-1;0<=m;m--){var U=10**m;w=Math.floor(M/U)*U;U*=Math.ceil(M/U);null!=u&&(w/=u,U/=u);let W=(w+U)/2;[,W]=q.round([w,W,U],{indexes:[1]});const ea=await I(p,K,w,R,Z),ja=await I(p,K,U,R,Z),aa=await I(p,K,W,
R,Z),la=q.percentChange(X,ea,Q,null),V=q.percentChange(X,ja,Q,null),ba=q.percentChange(X,aa,Q,null);let da=20>=la.previous,ca=20>=V.previous;da&&ca&&(la.previous<=V.previous?(da=!0,ca=!1):(ca=!0,da=!1));da?S=[w,ea]:ca?S=[U,ja]:20>=ba.previous&&(S=[W,aa]);if(S)break}return S}async function I(p,K,M,Q,R){const {getSize:Z}=await new Promise((X,u)=>r(["../../../renderers/visualVariables/support/visualVariableUtils"],X,u));return Z(p,M,{scale:Q,view:R,shape:"simple-marker"===K.type?K.style:null})}function c(p,
K){p=p.clone();if(A.isSymbol3D(p))B.isVolumetricSymbol(p)||p.symbolLayers.forEach(M=>{"fill"!==M.type&&(M.size=K)});else if("esri.symbols.SimpleMarkerSymbol"===p.declaredClass)p.size=K;else if("esri.symbols.PictureMarkerSymbol"===p.declaredClass){const M=p.width,Q=p.height;p.height=K;p.width=M/Q*K}else"esri.symbols.SimpleLineSymbol"===p.declaredClass?p.width=K:"esri.symbols.TextSymbol"===p.declaredClass&&p.font&&(p.font.size=K);return p}const b=[255,255,255],v=[200,200,200],D=[128,128,128];H.getRampStops=
async function(p,K,M,Q,R,Z,X){var u=K.legendOptions?.customValues;const m=X||await h(p,M);M=K.stops;var w=null!=K.minSize&&null!=K.maxSize;X=M&&1<M.length;var S=!!K.target;if(m&&(u||w||X&&!S)){var U=B.isVolumetricSymbol(m),W=!1,ea=w=null;w=U&&!X?q.round([K.minDataValue,K.maxDataValue]):u??await n(K,m,Q,R?.type);u=p?.authoringInfo;var ja=(S="univariate-color-size"===u?.type)&&"above-and-below"===u?.univariateTheme;!w&&X&&(w=M.map(ba=>ba.value),W=M.some(ba=>!!ba.label),"flow"===p.type&&(w=q.round(w)),
W&&(ea=M.map(ba=>ba.label)));U&&null!=w&&2<w?.length&&!ja&&(w=[w[0],w[w.length-1]]);if(!w)return null;S&&5!==w?.length&&(w=z({minSize:w[0],maxSize:w[w.length-1]}));var aa=U?e(p,w):null,la=B.getSymbolOutlineSize(m),V=W?null:f(w,Z);return(await Promise.all(w.map(async(ba,da)=>{const ca=U?aa[da]:await I(K,m,ba,Q,R?.type),na=c(ja&&"class-breaks"===p.type?g(p,da):m,ca);return{value:ba,symbol:na,label:W?ea[da]:V[da],size:ca,outlineSize:la}}))).reverse()}};H.realWorldMaxSize=30;H.realWorldMinSize=12;Object.defineProperty(H,
Symbol.toStringTag,{value:"Module"})})},"esri/widgets/smartMapping/support/utils":function(){define("exports ../../../Color ../../../intl/date ../../../intl/number ../../../renderers/support/utils ../../../renderers/visualVariables/SizeVariable".split(" "),function(r,H,P,A,q,F){r.formatDateLabel=function(B){return P.formatDate(new Date(B),q.timelineDateFormatOptions)};r.formatNumberLabel=function(B){const J=Math.floor(Math.log10(Math.abs(B)))+1;return A.formatNumber(B,{notation:1E6<=Math.abs(B)?"compact":
"standard",minimumSignificantDigits:2,maximumSignificantDigits:4>J||6<J?4:J})};r.getDeviationValues=function(B,J,N){if(null==J||null==B)return[];const G=[];for(let y=-1*N;y<=N;y++)0!==y&&G.push(J+y*B);return G};r.getDynamicPathForSizeStops=function(B){const {max:J,min:N,padding:G,pathHeight:y,pathWidth:d,stops:f}=B,e=J-N;let g=`M0 0 L${d} 0 `,h;B=3===f.length?[f[0],f[1],f[2]]:[f[0],f[2],f[4]];const x=Math.min.apply(Math,B.map(l=>l.size)),k=Math.max(Math.abs(B[0].size-B[1].size),Math.abs(B[2].size-
B[1].size));B.reverse();B.forEach(({size:l,value:n},z)=>{n=Math.round(y-(n-N)/e*y);h=Math.round((l-x)/k*100)/100*d;0===h&&(h=G*d);0===z&&(g+=`L${h} 0 `);g+=`L${h} ${n} `});return g+=`L${h} ${y} L0 ${y} L0 0 Z`};r.getFillFromColor=function(B){return B instanceof H?B.toCss(!0):H.fromString(B??"").toCss(!0)};r.getPathForSizeStops=function(B){const {bottomValue:J,bottomWidth:N,max:G,min:y,pathHeight:d,pathWidth:f,topValue:e,topWidth:g}=B;B=g*f;const h=N*f,x=G-y;return`M${B} 0 L${B} ${Math.round(d-(e-
y)/x*d)} L${h} ${Math.round(d-(J-y)/x*d)} L${h} ${d} L0 ${d} L0 0 Z`};r.getSizesFromVariable=function(B){let J=B.maxSize;B=B.minSize;J instanceof F&&(J=J.stops[0].size);B instanceof F&&(B=B.stops[0].size);return[J,B]};r.getStopChanges=function(B,J,N){const G=N.length-1;if(0>G)return[];const y=N[0],d=N[G]-y,f=J-B,e=[];for(let g=1;g<G;g++)e.push({index:g,value:(N[g]-y)/d*f+B});e.unshift({index:0,value:B});e.push({index:G,value:J});return e};Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})})},
"esri/renderers/support/utils":function(){define("exports ../../core/arrayUtils ../../core/Logger ../../core/MapUtils ../../intl/date ../../layers/support/fieldUtils ./numberUtils ../visualVariables/support/ColorStop ../../smartMapping/support/utils ../../symbols/support/utils ../../widgets/Legend/support/colorRampUtils ../../widgets/Legend/support/heatmapRampUtils".split(" "),function(r,H,P,A,q,F,B,J,N,G,y,d){async function f(n,z,E){A.getOrCreateMapValue(n,z,()=>[]).push(...E)}async function e(n,
z,E){n=A.getOrCreateMapValue(n,z,()=>new Map);for(const I of E)n.set(I.value,I.color)}function g(n){let z=n.minValue,E=n.maxValue;const I=n.isFirstBreak?"":x.gt+" ";n="percent-of-total"===n.normalizationType?x.pct:"";z=null==z?"":B.format(z);E=null==E?"":B.format(E);return I+z+n+" "+x.ld+" "+E+n}function h(n,z){return"normalizationField"in n&&n.normalizationField?{type:"normalized-field",field:n.field,normalizationField:n.normalizationField}:"field"in n&&n.field?{type:"field",field:n.field}:"valueExpression"in
n&&n.valueExpression?{type:"expression",expression:n.valueExpression,title:n.valueExpressionTitle,returnType:z}:null}const x={lte:"\x3c\x3d",gte:"\x3e\x3d",lt:"\x3c",gt:"\x3e",pct:"%",ld:"\u2013"},k={millisecond:0,second:1,minute:2,hour:3,day:4,month:5,year:6},l=q.convertDateFormatToIntlOptions("short-date");r.calculateDateFormatInterval=function(n){n=n.map(b=>new Date(b));const z=n.length;let E=Infinity,I=null;for(let b=0;b<z-1;b++){const v=n[b];let D=Infinity,p=null;for(let K=b+1;K<z;K++){var c=
n[K];c=v.getFullYear()!==c.getFullYear()&&"year"||v.getMonth()!==c.getMonth()&&"month"||v.getDate()!==c.getDate()&&"day"||v.getHours()!==c.getHours()&&"hour"||v.getMinutes()!==c.getMinutes()&&"minute"||v.getSeconds()!==c.getSeconds()&&"second"||"millisecond";const M=k[c];M<D&&(D=M,p=c)}D<E&&(E=D,I=p)}return I};r.createClassBreakLabel=g;r.createColorStops=function(n){const {values:z,colors:E,labelIndexes:I,isDate:c}=n;return z.map((b,v)=>{var D=null;if(!I||I.includes(v)){const p=c?q.formatDate(b):
B.format(b);p&&(D="",0===v?D=x.lt+" ":v===z.length-1&&(D=x.gt+" "),D+=p)}return new J({value:b,color:E[v],label:D})})};r.createUniqueValueLabel=function(n){const {value:z,domain:E,fieldInfo:I,dateFormatOptions:c}=n;n=String(z);const b=E&&"codedValues"in E&&E.codedValues?E.getName(z):null;b?n=b:null!=z&&I&&(N.isAnyDateField(I)||F.isTimeOnlyField(I))?n=N.formatAnyDate(z,c??{fieldType:I.type}):"number"===typeof z&&(n=B.format(z));return n};r.dateFormatIntervalOptions={millisecond:"long-month-day-year-long-time",
second:"long-month-day-year-long-time",minute:"long-month-day-year-short-time",hour:"long-month-day-year-short-time",day:"long-month-day-year",month:"long-month-day-year",year:"year"};r.getAttribute=h;r.getAttributes=function(n,z){const E=[];if("class-breaks"===n.type||"heatmap"===n.type)E.push(h(n,"number"));else if("unique-value"===n.type){var I=n.authoringInfo;if(I&&"relationship"===I.type){if(I.field1&&I.field2){var c=I.field2.field;const b=I.field2.normalizationField;E.push(h({field:I.field1.field,
normalizationField:I.field1.normalizationField}));E.push(h({field:c,normalizationField:b}))}}else c=n.uniqueValueInfos?.[0],I=null,c?.value&&(c=typeof c.value,"string"===c||"number"===c)&&(I=c),E.push(h(n,I)),[n.field2,n.field3].forEach(b=>b&&E.push({type:"field",field:b}))}else"attributes"in n&&n.attributes?.forEach(b=>E.push(h(b,"number")));(n=z?z(n):"visualVariables"in n?n.visualVariables:null)&&n.forEach(b=>E.push(h(b,"number")));return H.unique(E.filter(H.isSome),(b,v)=>"field"===b.type&&"field"===
v.type?b.field===v.field:"normalized-field"===b.type&&"normalized-field"===v.type?b.field===v.field&&b.normalizationField===v.normalizationField:"expression"===b.type&&"expression"===v.type?b.expression===v.expression:!1)};r.getColorsForRendererValues=async function(n){const z=new Map;if(!n)return z;if("unique-value"!==n.type||n.authoringInfo?.type)if("class-breaks"===n.type){var E=n.classBreakInfos.map(b=>({value:b.minValue,color:G.getColorFromSymbol(b.symbol,null)})).reverse();const {field:I,valueExpression:c}=
n;await e(z,I??c,E)}else"simple"===n.type&&await e(z,"default",[{value:"default",color:G.getColorFromSymbol(n.symbol,null)}]);else{E=(n.uniqueValueInfos??[]).map(K=>({value:K.value,color:G.getColorFromSymbol(K.symbol,null)}));const {field:I,field2:c,field3:b,valueExpression:v,fieldDelimiter:D}=n,p=[I,c,b].filter(Boolean).join(D||"");(p||v)&&await e(z,p||v,E)}"defaultSymbol"in n&&n.defaultSymbol&&await e(z,"default",[{value:"default",color:G.getColorFromSymbol(n.defaultSymbol,null)}]);if("visualVariables"in
n&&n.visualVariables){n=n.visualVariables.filter(I=>"color"===I.type);for(const I of n)n=await y.getRampStops(I)??[],await e(z,I.field||I.valueExpression,n)}return z};r.getColorsFromRenderer=async function(n){const z=new Map;if(!n)return z;if("visualVariables"in n&&n.visualVariables){var E=n.visualVariables.filter(c=>"color"===c.type);for(var I of E)E=(await y.getRampStops(I)??[]).map(c=>c.color),await f(z,I.field||I.valueExpression,E)}if("heatmap"===n.type)I=d.getHeatmapRampStops(n).map(c=>c.color),
await f(z,n.field||n.valueExpression,I);else if("pie-chart"===n.type){for(const c of n.attributes)await f(z,c.field||c.valueExpression,[c.color]);await f(z,"default",[n?.othersCategory?.color,G.getColorFromSymbol(n.backgroundFillSymbol,null)])}else if("dot-density"===n.type){for(const c of n.attributes)await f(z,c.field||c.valueExpression,[c.color]);await f(z,"default",[n.backgroundColor])}else if("unique-value"===n.type)if("predominance"===n.authoringInfo?.type)for(const c of n.uniqueValueInfos??
[])await f(z,c.value.toString(),[G.getColorFromSymbol(c.symbol,null)]);else{I=(n.uniqueValueInfos??[]).map(p=>G.getColorFromSymbol(p.symbol,null));const {field:c,field2:b,field3:v,valueExpression:D}=n;(c||D)&&await f(z,c||D,I);b&&await f(z,b,I);v&&await f(z,v,I)}else if("class-breaks"===n.type){I=n.classBreakInfos.map(v=>G.getColorFromSymbol(v.symbol,null));const {field:c,valueExpression:b}=n;await f(z,c??b,I)}else"simple"===n.type&&await f(z,"default",[G.getColorFromSymbol(n.symbol,null)]);"defaultSymbol"in
n&&n.defaultSymbol&&await f(z,"default",[G.getColorFromSymbol(n.defaultSymbol,null)]);z.forEach((c,b)=>{c=H.unique(c.filter(Boolean),(v,D)=>JSON.stringify(v)===JSON.stringify(D));z.set(b,c)});return z};r.setLabelsForClassBreaks=function(n){const z=n.classBreakInfos,E=n.normalizationType;let I=[];if(z?.length)if("standard-deviation"===n.classificationMethod)P.getLogger("esri.renderers.support.utils").warn("setLabelsForClassBreaks","cannot set labels for class breaks generated using 'standard-deviation' method.");
else if(n.round){I.push(z[0].minValue);for(const c of z)I.push(c.maxValue);I=B.round(I);z.forEach((c,b)=>{c.label=g({minValue:0===b?I[0]:I[b],maxValue:I[b+1],isFirstBreak:0===b,normalizationType:E})})}else z.forEach((c,b)=>{c.label=g({minValue:c.minValue,maxValue:c.maxValue,isFirstBreak:0===b,normalizationType:E})})};r.timelineDateFormatOptions=l;Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/styles/Card":function(){define("../../../chunks/tslib.es6 ../../../intl ../../../core/reactiveUtils ../../../core/screenUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../../symbols/support/svgUtils ../../../symbols/support/utils ../../Widget ./CardCSS ./support/relationshipUtils ./support/univariateUtils ../support/styleUtils ../../support/Heading ../../support/decorators/accessibleHandler ../../support/decorators/messageBundle ../../support/jsxFactory ../../support/widgetUtils ../../../intl/substitute".split(" "),
function(r,H,P,A,q,F,B,J,N,G,y,d,f,e,g,h,x,k,l,n,z,E){var I;(function(b){b.Auto="auto";b.Stack="stack";b.SideBySide="side-by-side"})(I||={});const c=window.devicePixelRatio;H=class extends d{constructor(b,v){super(b,v);this._hasIndicators=!1;this._selectedSectionName=null;this._sectionNames=[];this._sectionMap=new Map;this.activeLayerInfos=null;this.headingLevel=3;this.layout=I.Stack;this.messagesCommon=this.messages=null;this.type="card";this.view=null}initialize(){this.addHandles(P.watch(()=>this.activeLayerInfos,
b=>{this.removeAllHandles();this._watchForSectionChanges(b)}))}render(){var {view:b}=this;this._hasIndicators=this.layout===I.Auto&&b&&768>=b.container.clientWidth||this.layout===I.Stack;b=(b=this.activeLayerInfos)&&b.toArray().map(p=>this._renderLegendForLayer(p)).filter(p=>!!p);this._hasIndicators?this._selectedSectionName&&this._sectionNames.includes(this._selectedSectionName)||(this._selectedSectionName=this._sectionNames&&this._sectionNames[0]):this._selectedSectionName=null;const v=this._sectionNames.length;
var D=this._sectionNames.map((p,K)=>{K=E.substitute(this.messagesCommon.pagination.pageText,{index:K+1,total:v});return n.tsx("div",{"aria-controls":`${p}-panel`,"aria-label":K,"aria-selected":(this._selectedSectionName===p).toString(),bind:this,class:this.classes(f.css.indicator,{[f.css.activated]:this._selectedSectionName===p}),"data-section-name":p,id:p,key:p,onclick:this._selectSection,onkeydown:this._focusSection,role:"tab",tabIndex:this._selectedSectionName===p?0:-1,title:K})});D=this._hasIndicators&&
1<v?n.tsx("div",{class:f.css.indicatorContainer,key:"carousel-navigation",role:"tablist"},D):null;b=this._hasIndicators?this._sectionMap.get(this._selectedSectionName):b&&b.length?b:null;return n.tsx("div",{class:this.classes(f.css.base,{[f.css.stacked]:this._hasIndicators})},b||n.tsx("div",{class:f.css.message},this.messages.noLegend),D)}_selectSection(b){if(b=b.target.getAttribute("data-section-name"))this._selectedSectionName=b}_focusSection(b){switch(b.key){case "ArrowLeft":case "ArrowRight":this._switchSectionOnArrowPress(b);
break;case "Enter":case " ":this._selectSection(b)}}_switchSectionOnArrowPress(b){const v=b.key,D="ArrowLeft"===v?-1:1;b=b.target.getAttribute("data-section-name");b=this._sectionNames.indexOf(b);const p=this._sectionNames;let K=null;-1!==b&&(p[b+D]?K=document.getElementById(p[b+D]):"ArrowLeft"===v?K=document.getElementById(p[p.length-1]):"ArrowRight"===v&&(K=document.getElementById(p[0])),K?.focus())}_watchForSectionChanges(b){this._generateSectionNames();b&&(b.forEach(v=>{const D=`activeLayerInfo-${v.layer.uid}-version-change`;
this.removeHandles(D);this._watchForSectionChanges(v.children);this.addHandles(P.watch(()=>v.version,()=>this._generateSectionNames()),D)}),this.removeHandles("activeLayerInfos-collection-change"),this.addHandles(b.on("change",()=>this._watchForSectionChanges(b)),"activeLayerInfos-collection-change"))}_generateSectionNames(){this._sectionNames.length=0;this._selectedSectionName=null;this.activeLayerInfos&&this.activeLayerInfos.forEach(this._generateSectionNamesForActiveLayerInfo,this)}_getSectionName(b,
v,D){return`${this.id}${b.uid}-type-${v.type}-${D}`}_generateSectionNamesForActiveLayerInfo(b){b.children.forEach(this._generateSectionNamesForActiveLayerInfo,this);b.legendElements&&b.legendElements.forEach((v,D)=>{this._sectionNames.push(this._getSectionName(b.layer,v,D))})}_renderLegendForLayer(b){if(!b.ready)return null;if(b.children.length){var v=b.children.map(p=>this._renderLegendForLayer(p)).toArray();return n.tsx("div",{class:this.classes(f.css.service,f.css.groupLayer),key:b.layer.uid},
n.tsx("div",{class:f.css.serviceCaptionContainer},b.title),v)}if((v=b.legendElements)&&!v.length)return null;const D=v.some(p=>"relationship-ramp"===p.type);v=v.map((p,K)=>this._renderLegendForElement(p,b,K,D)).filter(p=>!!p);return v.length?n.tsx("div",{class:this.classes(f.css.service,{[f.css.groupLayerChild]:!!b.parent}),key:b.layer.uid},n.tsx("div",{class:f.css.serviceCaptionContainer},n.tsx("div",{class:f.css.serviceCaptionText},b.title)),n.tsx("div",{class:f.css.serviceContent},v)):null}_renderLegendForElement(b,
v,D,p=!1,K=!1){var M="color-ramp"===b.type,Q="opacity-ramp"===b.type,R=v.layer,Z=null;"string"===typeof b.title?Z=b.title:b.title&&(Z=b.title,M=h.getTitle(this.messages,Z,M||Q),Z=Z.title?`${Z.title} (${M})`:M);D=this._getSectionName(R,b,D);M=this._hasIndicators&&!K?n.tsx("div",null,n.tsx(x.Heading,{class:f.css.carouselTitle,level:this.headingLevel},v.title),n.tsx(x.Heading,{class:f.css.layerCaption,level:x.incrementHeadingLevel(this.headingLevel)},Z)):Z?n.tsx(x.Heading,{class:f.css.layerCaption,level:this.headingLevel},
Z):null;Z=v.effectList;Q=null;switch(b.type){case "symbol-table":R=b.infos.map((X,u)=>this._renderLegendForElementInfo(X,v,b.legendType,u)).filter(X=>!!X);R.length&&(Q=n.tsx("div",{class:this.classes({[f.css.labelContainer]:!R[0].properties.classes?.[f.css.symbolRow]&&!p,[f.css.relationshipLabelContainer]:p})},R));break;case "color-ramp":case "opacity-ramp":case "heatmap-ramp":case "stretch-ramp":Q=this._renderLegendForRamp(b,R.opacity,Z);break;case "size-ramp":Q=this._renderSizeRamp(b,R.opacity);
break;case "pie-chart-ramp":Q=this._renderPieChartRamp(b);break;case "relationship-ramp":Q=e.renderRelationshipRamp(b,this.id,{opacity:R.opacity,effectList:Z,ariaLabel:this.messages.previewRelationshipRampAriaLabel});break;case "univariate-above-and-below-ramp":Q=this._renderUnivariateAboveAndBelowRamp(b,R.opacity,Z);break;case "univariate-color-size-ramp":Q=this._renderUnivariateColorSizeRamp(b,R.opacity,Z)}if(!Q)return null;p=n.tsx("div",{"aria-labelledby":D,class:f.css.section,id:`${D}-panel`,
key:D,role:"tabpanel",tabIndex:0},[M,Q]);K||this._sectionMap.set(D,p);return p}_renderPieChartRamp(b){return n.tsx("div",{afterCreate:h.attachToNode,bind:b.preview,class:f.css.pieChartRampPreview})}_renderUnivariateAboveAndBelowRamp(b,v,D){const {sizeRampElement:p,colorRampElement:K}=g.getUnivariateAboveAndBelowRampElements(b,v,"horizontal");if(!p)return null;b=g.getUnivariateSizeRampSize(p,"full",!0,"horizontal");var M=g.getUnivariateColorRampSize(p,"above",!0,"horizontal"),Q=g.getUnivariateColorRampSize(p,
"below",!0,"horizontal"),R=this.messages?.previewColorRampAriaLabel;M=g.getUnivariateColorRampPreview(K,{width:M,height:12,rampAlignment:"horizontal",opacity:v,type:"above",effectList:D,ariaLabel:R});v=g.getUnivariateColorRampPreview(K,{width:Q,height:12,rampAlignment:"horizontal",opacity:v,type:"below",effectList:D,ariaLabel:R});D=g.getUnivariateColorRampMargin(p,"card");Q=p.infos.map(X=>X.label);const Z=Q.length-1;Q=Q.map((X,u)=>0===u||u===Z?n.tsx("div",{key:u},X):null);R={marginTop:"3px",display:"flex"};
z.isRTL(this.container)?R.marginRight=`${D}px`:R.marginLeft=`${D}px`;b={width:`${b}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};return n.tsx("div",{class:f.css.layerRow,key:"size-ramp-preview",styles:{display:"flex",flexDirection:"column"}},n.tsx("div",{class:this.classes(f.css.symbolContainer,f.css.sizeRampHorizontal),styles:{display:"flex",flexDirection:"row"}},p.infos.map((X,u)=>n.tsx("div",{afterCreate:h.attachToNode,bind:X.preview,class:f.css.symbol,key:u}))),M?n.tsx("div",
{class:f.css.univariateAboveAndBelowColorRamp,key:"color-ramp-preview",styles:R},n.tsx("div",{afterCreate:h.attachToNode,bind:M}),n.tsx("div",{afterCreate:h.attachToNode,bind:v})):null,n.tsx("div",{class:f.css.layerInfo},n.tsx("div",{class:f.css.rampLabelsContainer,styles:b},Q)))}_renderUnivariateColorSizeRamp(b,v,D){const {sizeRampElement:p,colorRampElement:K}=g.getUnivariateColorSizeRampElements(b,"horizontal");if(!p)return null;b=g.getUnivariateSizeRampSize(p,"full",!1,"horizontal");var M=g.getUnivariateColorRampSize(p,
"full",!1,"horizontal");v=g.getUnivariateColorRampPreview(K,{width:M,height:12,rampAlignment:"horizontal",opacity:v,type:"full",effectList:D,ariaLabel:this.messages?.previewColorRampAriaLabel});const Q=g.getUnivariateColorRampMargin(p,"card"),R=p.infos.length-1;D=p.infos.map((Z,X)=>0===X||X===R?n.tsx("div",{key:X},Z.label):null);M={marginTop:"3px",display:"flex"};z.isRTL(this.container)?M.marginRight=`${Q}px`:M.marginLeft=`${Q}px`;b={width:`${b}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};
return n.tsx("div",{class:f.css.layerRow,key:"size-ramp-preview",styles:{display:"flex",flexDirection:"column"}},n.tsx("div",{class:this.classes(f.css.symbolContainer,f.css.sizeRampHorizontal),styles:{display:"flex",flexDirection:"row"}},p.infos.map((Z,X)=>n.tsx("div",{afterCreate:h.attachToNode,bind:Z.preview,class:f.css.symbol,key:X}))),n.tsx("div",{class:f.css.univariateAboveAndBelowColorRamp,key:"color-ramp-preview",styles:M},n.tsx("div",{afterCreate:h.attachToNode,bind:v})),n.tsx("div",{class:f.css.layerInfo},
n.tsx("div",{class:f.css.rampLabelsContainer,styles:b},D)))}_renderLegendForElementInfo(b,v,D,p){var K=v.layer;if(b.type)return this._renderLegendForElement(b,v,p,!1,!0);var M=h.isImageryStretchedLegend(K,D);D=h.getTitle(this.messages,b.label,!1)??"";if(b.preview){if(!b.symbol?.type.includes("simple-fill")){if(!b.label)return n.tsx("div",{afterCreate:h.attachToNode,bind:b.preview,key:p});v={[f.css.symbolCell]:this._hasIndicators};return n.tsx("div",{class:this.classes(f.css.layerRow,{[f.css.symbolRow]:this._hasIndicators}),
key:p},n.tsx("div",{afterCreate:h.attachToNode,bind:b.preview,class:this.classes(v)}),n.tsx("div",{class:this.classes(f.css.imageLabel,{[f.css.labelCell]:this._hasIndicators})},D))}let Q=M=255,R=255,Z=0,X=255,u=255,m=255,w=0;const S=b.symbol.color?.a,U=b.symbol.outline?.color?.a;S&&(M=b.symbol.color.r,Q=b.symbol.color.g,R=b.symbol.color.b,Z=b.symbol.color.a*K.opacity);U&&(X=b.symbol.outline.color.r,u=b.symbol.outline.color.g,m=b.symbol.outline.color.b,w=b.symbol.outline.color.a*K.opacity);K=(b=b.symbol.color?.isBright??
!0)?"rgba(255, 255, 255, .6)":"rgba(0, 0, 0, .6)";v={background:S?`rgba(${M}, ${Q}, ${R}, ${Z})`:"none",color:b?"black":"white",textShadow:`-1px -1px 0 ${K},\n                                              1px -1px 0 ${K},\n                                              -1px 1px 0 ${K},\n                                              1px 1px 0 ${K}`,border:U?`1px solid rgba(${X}, ${u}, ${m}, ${w})`:"none",filter:y.getCSSFilterFromEffectList(v.effectList)??void 0};return n.tsx("div",{class:f.css.layerRow,
key:p},n.tsx("div",{class:f.css.labelElement,styles:v},D))}if(b.src)return v=this._renderImage(b,K,M),n.tsx("div",{class:f.css.layerRow,key:p},v,n.tsx("div",{class:f.css.imageLabel},D))}_renderImage(b,v,D){const {label:p,src:K,opacity:M}=b;D={[f.css.imageryLayerStretchedImage]:D,[f.css.symbol]:!D};v={opacity:`${null!=M?M:v.opacity}`};return n.tsx("img",{alt:h.getTitle(this.messages,p,!1),"aria-label":h.getTitle(this.messages,p,!1),border:0,class:this.classes(D),height:b.height,src:K,styles:v,width:b.width})}_renderSizeRampLines(b){b=
b.infos;var v=b[0],D=b[b.length-1],p=v.symbol;b=this._hasIndicators;v=A.pt2px(v.size+v.outlineSize)*c;D=A.pt2px(D.size+D.outlineSize)*c;const K=b?v:v+50*c,M=b?v/2+50*c:v;var Q;p?p.type.includes("3d")?(Q=p.symbolLayers?.length)?(Q=p.symbolLayers.at(Q-1).get("resource.primitive"),Q="triangle"===Q||"cone"===Q||"tetrahedron"===Q):Q=void 0:Q="triangle"===p.style:Q=void 0;if(p)if(p.type.includes("3d")){var R=p.symbolLayers?.length;R?(p=p.symbolLayers.at(R-1).resource?.primitive,p="circle"===p||"cross"===
p||"kite"===p||"sphere"===p||"cube"===p||"diamond"===p):p=void 0}else p=p.style,p="circle"===p||"diamond"===p||"cross"===p;else p=void 0;R=document.createElement("canvas");R.width=K;R.height=M;R.style.width=`${R.width/c}px`;R.style.height=`${R.height/c}px`;const Z=R.getContext("2d");if(b){Z.beginPath();var X=K/2-D/2;Z.moveTo(0,0);Z.lineTo(X,M);X=K/2+D/2;Z.moveTo(K,0);Z.lineTo(X,M)}else Z.beginPath(),Z.moveTo(0,M/2-D/2),Z.lineTo(K,0),Z.moveTo(0,M/2+D/2),Z.lineTo(K,M);Z.strokeStyle="#ddd";Z.stroke();
return n.tsx("div",{afterCreate:h.attachToNode,bind:R,styles:b?{display:"flex",marginTop:`-${Q?0:p?v/2:0}px`,marginBottom:`-${Q?D:p?D/2:0}px`}:{display:"flex",marginRight:`-${Q?0:p?v/2:0}px`,marginLeft:`-${Q?0:p?D/2:0}px`}})}_renderSizeRamp(b,v){var D=b.infos;const p=D[0].label,K=D[D.length-1].label;let M=D[0].preview;D=D[D.length-1].preview;const Q=this._hasIndicators,R={"flex-direction":Q?"column":"row-reverse"};M&&(M=M.cloneNode(!0),M.style.display="flex");D&&(D=D.cloneNode(!0),D.style.display=
"flex");v={opacity:null!=v?`${v}`:""};return n.tsx("div",{class:this.classes(f.css.layerRow,{[f.css.sizeRampRow]:Q})},n.tsx("div",{class:f.css.rampLabel},Q?p:K),n.tsx("div",{class:f.css.sizeRampContainer,styles:R},n.tsx("div",{afterCreate:h.attachToNode,bind:M,class:f.css.sizeRampPreview,styles:v}),this._renderSizeRampLines(b),n.tsx("div",{afterCreate:h.attachToNode,bind:D,class:f.css.sizeRampContainer,styles:v})),n.tsx("div",{class:f.css.rampLabel},Q?K:p))}_getRampStopLabel(b,v){switch(v){case "heatmap-ramp":return this.messages[b.label];
case "stretch-ramp":return h.getStretchStopLabel(b,this.messages);default:return b.label}}_renderLegendForRamp(b,v,D){var p=b.infos;b=b.type;const K="heatmap-ramp"===b,M=p.length-1;var Q=2<M&&!K?25*M:100,R=Q+20;p=p.slice(0).reverse();const Z=p.length-1;var X=0!==p.length%2?p[p.length/2|0]:null;X=X&&n.tsx("div",{class:f.css.intervalSeparatorsContainer},n.tsx("div",{class:f.css.intervalSeparator},"|"),n.tsx("div",{class:f.css.rampLabel},this._getRampStopLabel(X,b)));Q=[[{shape:{type:"path",path:"M0 12.5 L10 0 L10 25 Z"},
fill:p[0].color,stroke:{width:0}},{shape:{type:"rect",x:10,y:0,width:Q,height:25},fill:{type:"linear",x1:10,y1:0,x2:Q+10,y2:0,colors:p.map((u,m)=>({color:u.color,offset:K&&"ratio"in u?u.ratio:m/M}))},stroke:{width:0}},{shape:{type:"path",path:`M${Q+10} 0 L${R} ${12.5} L${Q+10} ${25} Z`},fill:p[Z].color,stroke:{width:0}}]];R=G.renderSVG(Q,R,25);v={filter:y.getCSSFilterFromEffectList(D)??void 0,opacity:null==v?void 0:`${v}`};return n.tsx("div",{class:f.css.layerRow,styles:{justifyContent:"center"}},
n.tsx("div",{class:f.css.rampLabel},this._getRampStopLabel(p[0],b)),n.tsx("div",{class:f.css.symbolContainer},n.tsx("div",{styles:v},R),X),n.tsx("div",{class:f.css.rampLabel},this._getRampStopLabel(p[Z],b)))}};r.__decorate([q.property()],H.prototype,"activeLayerInfos",void 0);r.__decorate([q.property()],H.prototype,"headingLevel",void 0);r.__decorate([q.property()],H.prototype,"layout",void 0);r.__decorate([q.property(),l.messageBundle("esri/widgets/Legend/t9n/Legend")],H.prototype,"messages",void 0);
r.__decorate([q.property(),l.messageBundle("esri/t9n/common")],H.prototype,"messagesCommon",void 0);r.__decorate([q.property({readOnly:!0})],H.prototype,"type",void 0);r.__decorate([q.property()],H.prototype,"view",void 0);r.__decorate([k.accessibleHandler()],H.prototype,"_selectSection",null);return H=r.__decorate([N.subclass("esri.widgets.Legend.styles.Card")],H)})},"esri/widgets/Legend/styles/CardCSS":function(){define(["exports"],function(r){r.css={activated:"esri-legend--card__carousel-indicator--activated",
base:"esri-legend--card",stacked:"esri-legend--stacked",carouselTitle:"esri-legend--card__carousel-title",indicator:"esri-legend--card__carousel-indicator",intervalSeparator:"esri-legend--card__interval-separator",imageryLayerStretchedImage:"esri-legend--card__imagery-layer-image--stretched",imageLabel:"esri-legend--card__image-label",layerCaption:"esri-legend--card__layer-caption",labelElement:"esri-legend--card__label-element",layerRow:"esri-legend--card__layer-row",labelCell:"esri-legend--card__label-cell",
message:"esri-legend--card__message",rampLabel:"esri-legend--card__ramp-label",section:"esri-legend--card__section",relationshipSection:"esri-legend--card__relationship-section",serviceCaptionText:"esri-legend--card__service-caption-text",serviceContent:"esri-legend--card__service-content",service:"esri-legend--card__service",groupLayer:"esri-legend--card__group-layer",groupLayerChild:"esri-legend--card__group-layer-child",symbol:"esri-legend--card__symbol",sizeRampRow:"esri-legend--card__size-ramp-row",
symbolRow:"esri-legend--card__symbol-row",symbolCell:"esri-legend--card__symbol-cell",indicatorContainer:"esri-legend--card__carousel-indicator-container",intervalSeparatorsContainer:"esri-legend--card__interval-separators-container",relationshipLabelContainer:"esri-legend--card__relationship-label-container",labelContainer:"esri-legend--card__label-container",serviceCaptionContainer:"esri-legend--card__service-caption-container",symbolContainer:"esri-legend--card__symbol-container",sizeRampContainer:"esri-legend--card__size-ramp-container",
sizeRampPreview:"esri-legend--card__size-ramp-preview",pieChartRampPreview:"esri-legend--card__pie-chart-ramp-preview",rampContainer:"esri-legend__ramps",sizeRampHorizontal:"esri-legend__size-ramp--horizontal",rampLabelsContainer:"esri-legend__ramp-labels",layerInfo:"esri-legend__layer-cell esri-legend__layer-cell--info",univariateAboveAndBelowColorRamp:"esri-univariate-above-and-below-ramp__color--card"};Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/styles/support/univariateUtils":function(){define("exports ../../../../core/screenUtils ../../../../libs/maquette/projection ../../../../libs/maquette/projector ../../../../symbols/support/symbolUtils ../../../support/widgetUtils ../../../support/jsxFactory".split(" "),
function(r,H,P,A,q,F,B){function J(e="vertical"){return"vertical"===e?B.tsx("svg",{height:"4",width:"10"},B.tsx("line",{style:"stroke:rgb(200, 200, 200);stroke-width:1",x1:"0",x2:"10",y1:"2",y2:"2"})):B.tsx("svg",{height:"10",width:"10"},B.tsx("line",{style:"stroke:rgb(200, 200, 200);stroke-width:1",x1:"5",x2:"5",y1:"0",y2:"10"}))}function N(e,g="vertical"){const h=document.createElement("div");h.style.height="20px";h.className=f.univariateAboveAndBelowSymbol;null!=e&&(h.style.opacity=e.toString());
d.append(h,J.bind(null,g));return h}function G(e,g,h="vertical",x){e.infos.forEach((k,l)=>{if(x&&2===l)k.preview=N(g,h);else{l=H.pt2px(k.size)+("horizontal"===h?20:10);const n=k.preview,z="div"===n?.tagName.toLowerCase(),E=z?n:document.createElement("div");E.className=f.univariateAboveAndBelowSymbol;"horizontal"===h?E.style.width=`${l}px`:E.style.height=`${l}px`;!z&&n&&E.appendChild(n);k.preview=E}})}function y(e,g,h,x="vertical"){let k=0;e=e.infos;const l=Math.floor(e.length/2);var n="full"===g||
"above"===g?0:l;for(g="full"===g||"below"===g?e.length-1:l;n<=g;n++)if(h&&n===l)k+="horizontal"===x?10:20;else{const z=H.pt2px(e[n].size)+("horizontal"===x?20:10);k+=z}return Math.round(k)}const d=A.createProjector(),f={univariateAboveAndBelowSymbol:"esri-univariate-above-and-below-ramp__symbol",colorRamp:"esri-legend__color-ramp"};r.getUnivariateAboveAndBelowRampElements=function(e,g,h="vertical"){var x=e.infos;e=x.find(({type:k})=>"size-ramp"===k);x=x.find(({type:k})=>"color-ramp"===k);e&&(e={...e},
e.infos=[...e.infos],G(e,g,h,!0));x&&(x={...x},x.infos=[...x.infos]);"horizontal"===h&&(e?.infos.reverse(),x?.infos.reverse());return{sizeRampElement:e,colorRampElement:x}};r.getUnivariateColorRampMargin=function(e,g="classic"){e=e.infos;return"classic"===g?(H.pt2px(e[0].size)+10)/2:(H.pt2px(e[0].size)-H.pt2px(e[e.length-1].size))/2};r.getUnivariateColorRampPreview=function(e,g){if(!e)return null;e=e.infos.map(h=>h.color);e=q.renderColorRampPreviewHTML("full"===g.type?e:"above"===g.type?e.slice(0,
3):e.slice(2,5),{width:g.width,height:g.height,align:g.rampAlignment,effectList:g.effectList,ariaLabel:g.ariaLabel});e.className=f.colorRamp;null!=g.opacity&&(e.style.opacity=g.opacity.toString());return e};r.getUnivariateColorRampSize=function(e,g,h,x="vertical"){const k=y(e,g,h,x);e=e.infos;var l=Math.floor(e.length/2);const n="full"===g||"above"===g?0:l;l="full"===g||"below"===g?e.length-1:l;h=h?"vertical"===x?20:10:0;x="vertical"===x?10*("full"===g?2:1):20*("full"===g?2:1);return Math.round(k-
(H.pt2px("full"===g?e[n].size+e[l].size:"above"===g?e[n].size:e[l].size)/2+h/2+x/2))};r.getUnivariateColorSizeRampElements=function(e,g="vertical"){var h=e.infos;e=h.find(({type:x})=>"size-ramp"===x);h=h.find(({type:x})=>"color-ramp"===x);e&&(e={...e},e.infos=[...e.infos],G(e,null,g,!1));h&&(h={...h},h.infos=[...h.infos]);"horizontal"===g&&(e?.infos.reverse(),h?.infos.reverse());return{sizeRampElement:e,colorRampElement:h}};r.getUnivariateSizeRampSize=y;Object.defineProperty(r,Symbol.toStringTag,
{value:"Module"})})},"esri/widgets/Legend/support/styleUtils":function(){define(["exports","../../../intl","../../../core/string","../../../intl/substitute","../../../intl/number"],function(r,H,P,A,q){r.attachToNode=function(F){F.appendChild(this)};r.getStretchStopLabel=function(F,B){return F.label?B[F.label]+": "+("string"===typeof F.value?F.value:q.formatNumber(F.value??0,{style:"decimal",notation:F.value?.toString().toLowerCase().includes("e")?"scientific":"standard"})):""};r.getTitle=function(F,
B,J){if(B){if("number"===typeof B)return B;if("string"===typeof B)return P.stripHTML(B);if("value"in B||"unit"in B)return A.substitute(F.dotValue,B);if("colorName"in B&&"bandName"in B)return F[B.colorName]+": "+(F[B.bandName]||B.bandName);if("showCount"in B)return B.showCount?F.clusterCountTitle:void 0;var N=null;J?N=B.ratioPercentTotal?"showRatioPercentTotal":B.ratioPercent?"showRatioPercent":B.ratio?"showRatio":B.normField?"showNormField":B.field?"showField":null:J||(N=B.normField?"showNormField":
B.normByPct?"showNormPct":B.field?"showField":null);return N?A.substitute("showField"===N?"{field}":F[N],{field:B.field,normField:B.normField}):void 0}};r.isImageryStretchedLegend=function(F,B){return!!(B&&"Stretched"===B&&10.3<=F.version&&"esri.layers.ImageryLayer"===F.declaredClass)};r.isRendererTitle=function(F,B){return!B};Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/Heading":function(){define(["exports","../../core/mathUtils","./globalCss","./widgetUtils",
"./jsxFactory"],function(r,H,P,A,q){r.Heading=function({level:F,class:B,...J},N){F=H.clamp(Math.ceil(F),1,6);return q.tsx(`h${F}`,{...J,"aria-level":String(F),class:A.classes(P.globalCss.heading,B),role:"heading"},N)};r.incrementHeadingLevel=function(F,B=1){return H.clamp(Math.ceil(F+B),1,6)};Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/globalCss":function(){define(["exports"],function(r){r.globalCss={anchor:"esri-widget__anchor",anchorDisabled:"esri-widget__anchor--disabled",
button:"esri-button",buttonDisabled:"esri-button--disabled",buttonHalf:"esri-button--half",buttonSecondary:"esri-button--secondary",buttonSmall:"esri-button--small",buttonTertiary:"esri-button--tertiary",buttonThird:"esri-button--third",disabled:"esri-disabled",disabledElement:"esri-disabled-element",empty:"esri-widget__content--empty",emptyIllustration:"esri-widget__content-illustration--empty",heading:"esri-widget__heading",hidden:"esri-hidden",input:"esri-input",interactive:"esri-interactive",
loader:"esri-widget__loader",loaderAnimation:"esri-widget__loader-animation",loaderText:"esri-widget__loader-text",menu:"esri-menu",menuHeader:"esri-menu__header",menuItem:"esri-menu__list-item",menuItemActive:"esri-menu__list-item--active",menuItemFocus:"esri-menu__list-item--focus",menuList:"esri-menu__list",noBookmarksIcon:"esri-widget__no-bookmark-icon",panel:"esri-widget--panel",panelHeightOnly:"esri-widget--panel-height-only",primaryTick:"primary-tick",primaryTickAmPm:"primary-tick__ampm",primaryTickLabel:"primary-tick__label",
rotating:"esri-rotating",secondaryTick:"secondary-tick",select:"esri-select",table:"esri-widget__table",widget:"esri-widget",widgetButton:"esri-widget--button",widgetButtonActive:"esri-widget--button-active",widgetDisabled:"esri-widget--disabled"};Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/styles/Classic":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../Widget ./ClassicCSS ./support/relationshipUtils ./support/univariateUtils ../support/styleUtils ../../support/globalCss ../../support/Heading ../../support/widgetUtils ../../support/decorators/messageBundle ../../support/jsxFactory".split(" "),
function(r,H,P,A,q,F,B,J,N,G,y,d,f,e,g,h){const x=`${J.legend}__`,k={display:"flex",alignItems:"flex-start"},l={marginLeft:"3px"},n={display:"table-cell",verticalAlign:"middle"};P=class extends B{constructor(z,E){super(z,E);this.activeLayerInfos=null;this.headingLevel=3;this.messages=null;this.type="classic"}render(){var z=this.activeLayerInfos;z=z&&z.toArray().map(E=>this._renderLegendForLayer(E)).filter(E=>!!E);return h.tsx("div",null,z&&z.length?z:h.tsx("div",{class:J.css.message},this.messages.noLegend))}_renderLegendForLayer(z){if(!z.ready)return null;
var E=!!z.children.length;const I=`${x}${z.layer.uid}-version-${z.version}`,c=z.title?f.Heading({level:this.headingLevel,class:this.classes(d.globalCss.heading,J.css.label)},z.title):null;if(E)return E=z.children.map(b=>this._renderLegendForLayer(b)).toArray(),h.tsx("div",{class:this.classes(J.css.service,J.css.groupLayer),key:I},c,E);if((E=z.legendElements)&&!E.length)return null;E=E.map(b=>this._renderLegendForElement(b,z.layer,z.effectList)).filter(b=>!!b);return E.length?h.tsx("div",{class:this.classes(J.css.service,
{[J.css.groupLayerChild]:!!z.parent}),key:I},c,h.tsx("div",{class:J.css.layer},E)):null}_renderLegendForElement(z,E,I,c){var b="color-ramp"===z.type,v="opacity-ramp"===z.type;const D="size-ramp"===z.type;let p=null;if("symbol-table"===z.type||D){var K=z.infos.map(Q=>this._renderLegendForElementInfo(Q,E,I,D,z.legendType)).filter(Q=>!!Q);K.length&&(p=h.tsx("div",{class:J.css.layerBody},K))}else"color-ramp"===z.type||"opacity-ramp"===z.type||"heatmap-ramp"===z.type||"stretch-ramp"===z.type?p=this._renderLegendForRamp(z,
E.opacity):"relationship-ramp"===z.type?p=N.renderRelationshipRamp(z,this.id,{opacity:E.opacity,effectList:I,ariaLabel:this.messages.previewRelationshipRampAriaLabel}):"pie-chart-ramp"===z.type?p=this._renderPieChartRamp(z):"univariate-above-and-below-ramp"===z.type?p=this._renderUnivariateAboveAndBelowRamp(z,E.opacity,I):"univariate-color-size-ramp"===z.type&&(p=this._renderUnivariateColorSizeRamp(z,E.opacity,I));if(!p)return null;K=z.title;var M=null;"string"===typeof K?M=K:K&&(M=y.getTitle(this.messages,
K,b||v),M=y.isRendererTitle(K,b||v)&&K.title?`${K.title} (${M})`:M);b=c?J.css.layerChildTable:J.css.layerTable;v=M?h.tsx("div",{class:J.css.layerCaption},M):null;return h.tsx("div",{class:this.classes(b,{[J.css.layerTableSizeRamp]:D||!c})},v,p)}_renderPieChartRamp(z){return h.tsx("div",{afterCreate:y.attachToNode,bind:z.preview})}_renderUnivariateAboveAndBelowRamp(z,E,I){const {sizeRampElement:c,colorRampElement:b}=G.getUnivariateAboveAndBelowRampElements(z,E);if(!c)return null;var v=this.messages?.previewColorRampAriaLabel,
D=G.getUnivariateColorRampSize(c,"above",!0);z=G.getUnivariateColorRampSize(c,"below",!0);const p=G.getUnivariateColorRampPreview(b,{width:12,height:D,rampAlignment:"vertical",opacity:E,type:"above",effectList:I,ariaLabel:v});E=G.getUnivariateColorRampPreview(b,{width:12,height:z,rampAlignment:"vertical",opacity:E,type:"below",effectList:I,ariaLabel:v});var K=G.getUnivariateColorRampMargin(c);const M=c.infos.map(X=>X.label);I=M.map((X,u)=>{const m=2===u;return 0===u?h.tsx("div",{class:X?p?J.css.univariateAboveAndBelowLabel:
J.css.rampLabel:void 0,key:u},X):m?h.tsx("div",null):null});const Q=M.length-1,R=Math.floor(M.length/2);v=M.map((X,u)=>{const m=u===Q;return u===R||m?h.tsx("div",{class:X?p?J.css.univariateAboveAndBelowLabel:J.css.rampLabel:void 0,key:u},X):null});const Z={display:"table-cell",verticalAlign:"middle"};K={marginTop:`${K}px`};D={height:`${D}px`};z={height:`${z}px`};return h.tsx("div",{key:"univariate-above-and-below-ramp-preview",styles:k},h.tsx("div",{class:J.css.layerBody},c.infos.map((X,u)=>h.tsx("div",
{class:this.classes(J.css.layerRow,J.css.sizeRamp)},h.tsx("div",{afterCreate:y.attachToNode,bind:X.preview,class:J.css.symbol,styles:Z}),p||0!==u%2?null:h.tsx("div",{class:J.css.layerInfo},M[u])))),p?h.tsx("div",{key:"color-ramp-preview",styles:K},h.tsx("div",{styles:l},h.tsx("div",{styles:n},h.tsx("div",{afterCreate:y.attachToNode,bind:p,class:J.css.rampContainer})),h.tsx("div",{styles:n},h.tsx("div",{class:J.css.rampLabelsContainer,styles:D},I))),h.tsx("div",{styles:l},h.tsx("div",{styles:n},h.tsx("div",
{afterCreate:y.attachToNode,bind:E,class:J.css.rampContainer})),h.tsx("div",{styles:n},h.tsx("div",{class:J.css.rampLabelsContainer,styles:z},v)))):null)}_renderUnivariateColorSizeRamp(z,E,I){const {sizeRampElement:c,colorRampElement:b}=G.getUnivariateColorSizeRampElements(z);if(!c)return null;var v=G.getUnivariateColorRampMargin(c);z=G.getUnivariateColorRampSize(c,"full",!1);E=G.getUnivariateColorRampPreview(b,{width:12,height:z,rampAlignment:"vertical",opacity:E,type:"full",effectList:I,ariaLabel:this.messages?.previewColorRampAriaLabel});
const D=c.infos.length-1;I=c.infos.map((K,M)=>0===M||M===D?h.tsx("div",{class:K.label?b?J.css.univariateAboveAndBelowLabel:J.css.rampLabel:void 0,key:M},K.label):null);const p={display:"table-cell",verticalAlign:"middle"};v={marginTop:`${v}px`};z={height:`${z}px`};return h.tsx("div",{key:"univariate-above-and-below-ramp-preview",styles:k},h.tsx("div",{class:J.css.layerBody},c.infos.map(K=>h.tsx("div",{class:this.classes(J.css.layerRow,J.css.sizeRamp)},h.tsx("div",{afterCreate:y.attachToNode,bind:K.preview,
class:J.css.symbol,styles:p})))),h.tsx("div",{key:"color-ramp-preview",styles:v},h.tsx("div",{styles:l},h.tsx("div",{styles:n},h.tsx("div",{afterCreate:y.attachToNode,bind:E,class:J.css.rampContainer})),h.tsx("div",{styles:n},h.tsx("div",{class:J.css.rampLabelsContainer,styles:z},I)))))}_renderLegendForRamp(z,E){const I=z.infos,c="heatmap-ramp"===z.type,b="stretch-ramp"===z.type,v=z.preview;v.className=`${J.css.colorRamp} ${"opacity-ramp"===z.type?J.css.opacityRamp:""}`;null!=E&&(v.style.opacity=
E.toString());z=I.map(D=>h.tsx("div",{class:D.label?J.css.rampLabel:void 0},c?this.messages[D.label]||D.label:b?y.getStretchStopLabel(D,this.messages):D.label));E={height:v.style.height};return h.tsx("div",{class:J.css.layerRow},h.tsx("div",{class:J.css.symbolContainer,styles:{width:"24px"}},h.tsx("div",{afterCreate:y.attachToNode,bind:v,class:J.css.rampContainer})),h.tsx("div",{class:J.css.layerInfo},h.tsx("div",{class:J.css.rampLabelsContainer,styles:E},z)))}_renderLegendForElementInfo(z,E,I,c,
b){if(z.type)return this._renderLegendForElement(z,E,I,!0);I=null;b=y.isImageryStretchedLegend(E,b);z.preview?I=h.tsx("div",{afterCreate:y.attachToNode,bind:z.preview,class:J.css.symbol}):z.src&&(I=this._renderImage(z,E,b));if(!I)return null;E={[J.css.imageryLayerInfoStretched]:b};return h.tsx("div",{class:J.css.layerRow},h.tsx("div",{class:this.classes(J.css.symbolContainer,{[J.css.imageryLayerInfoStretched]:b,[J.css.sizeRamp]:!b&&c})},I),h.tsx("div",{class:this.classes(J.css.layerInfo,E)},y.getTitle(this.messages,
z.label,!1)||""))}_renderImage(z,E,I){const {label:c,src:b,opacity:v}=z;I={[J.css.imageryLayerStretchedImage]:I,[J.css.symbol]:!I};E={opacity:`${null!=v?v:E.opacity}`};return h.tsx("img",{alt:y.getTitle(this.messages,c,!1),"aria-label":y.getTitle(this.messages,c,!1),border:0,class:this.classes(I),height:z.height,src:b,styles:E,width:z.width})}};r.__decorate([H.property()],P.prototype,"activeLayerInfos",void 0);r.__decorate([H.property()],P.prototype,"headingLevel",void 0);r.__decorate([H.property(),
g.messageBundle("esri/widgets/Legend/t9n/Legend")],P.prototype,"messages",void 0);r.__decorate([H.property({readOnly:!0})],P.prototype,"type",void 0);return P=r.__decorate([F.subclass("esri.widgets.Legend.styles.Classic")],P)})},"esri/widgets/Legend/styles/ClassicCSS":function(){define(["exports"],function(r){r.css={service:"esri-legend__service",label:"esri-legend__service-label",layer:"esri-legend__layer",groupLayer:"esri-legend__group-layer",groupLayerChild:"esri-legend__group-layer-child",layerTable:"esri-legend__layer-table",
layerTableSizeRamp:"esri-legend__layer-table--size-ramp",layerChildTable:"esri-legend__layer-child-table",layerCaption:"esri-legend__layer-caption",layerBody:"esri-legend__layer-body",layerRow:"esri-legend__layer-row",layerCell:"esri-legend__layer-cell",layerInfo:"esri-legend__layer-cell esri-legend__layer-cell--info",imageryLayerStretchedImage:"esri-legend__imagery-layer-image--stretched",imageryLayerCellStretched:"esri-legend__imagery-layer-cell--stretched",imageryLayerInfoStretched:"esri-legend__imagery-layer-info--stretched",
symbolContainer:"esri-legend__layer-cell esri-legend__layer-cell--symbols",symbol:"esri-legend__symbol",rampContainer:"esri-legend__ramps",sizeRamp:"esri-legend__size-ramp",colorRamp:"esri-legend__color-ramp",opacityRamp:"esri-legend__opacity-ramp",borderlessRamp:"esri-legend__borderless-ramp",rampTick:"esri-legend__ramp-tick",rampFirstTick:"esri-legend__ramp-tick-first",rampLastTick:"esri-legend__ramp-tick-last",rampLabelsContainer:"esri-legend__ramp-labels",rampLabel:"esri-legend__ramp-label",message:"esri-legend__message",
univariateAboveAndBelowLabel:"esri-univariate-above-and-below-ramp__label"};r.legend="esri-legend";Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})})},"*noref":1}});
define("../chunks/tslib.es6 ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/RandomLCG ../core/has ../core/accessorSupport/decorators/subclass ./Widget ./Legend/LegendViewModel ./Legend/styles/Card ./Legend/styles/Classic ./support/globalCss ./support/legacyIcon ./support/widgetUtils ./support/decorators/messageBundle ./support/jsxFactory".split(" "),function(r,H,P,A,q,F,B,J,N,G,y,d,f,e,g,h){var x=f.legacyIcon.layerList;q=class extends J{constructor(k,
l){super(k,l);this.headingLevel=3;this.iconClass=x;this.messages=this.icon=null;this.style=new y;this.viewModel=new N}initialize(){this.addHandles([H.on(()=>this.view,"resize",()=>this.scheduleRender()),H.on(()=>this.activeLayerInfos,"change",()=>this._refreshActiveLayerInfos(this.activeLayerInfos)),H.watch(()=>this.headingLevel,k=>{const {style:l}=this;l&&(l.headingLevel=k)}),H.watch(()=>this.style,(k,l)=>{l&&k!==l&&l.destroy();k&&(k.activeLayerInfos=this.activeLayerInfos,"card"===k.type&&(k.view=
this.view),k.headingLevel=this.headingLevel)},H.initial)])}get activeLayerInfos(){return this.viewModel.activeLayerInfos}set activeLayerInfos(k){this.viewModel.activeLayerInfos=k}get basemapLegendVisible(){return this.viewModel.basemapLegendVisible}set basemapLegendVisible(k){this.viewModel.basemapLegendVisible=k}get groundLegendVisible(){return this.viewModel.groundLegendVisible}set groundLegendVisible(k){this.viewModel.groundLegendVisible=k}get hideLayersNotInCurrentView(){return this.viewModel.hideLayersNotInCurrentView}set hideLayersNotInCurrentView(k){this.viewModel.hideLayersNotInCurrentView=
k}get keepCacheOnDestroy(){return this.viewModel.keepCacheOnDestroy}set keepCacheOnDestroy(k){this.viewModel.keepCacheOnDestroy=k}get respectLayerVisibility(){return this.viewModel.respectLayerVisibility}set respectLayerVisibility(k){this.viewModel.respectLayerVisibility=k}get label(){return this.messages?.widgetLabel??""}set label(k){this._overrideIfSome("label",k)}get layerInfos(){return this.viewModel.layerInfos}set layerInfos(k){this.viewModel.layerInfos=k}castStyle(k){if(k instanceof G||k instanceof
y)return k;if("string"===typeof k)return"card"===k?new G:new y;if(k&&"string"===typeof k.type){const l={...k};delete l.type;return new ("card"===k.type?G:y)(l)}return new y}get view(){return this.viewModel.view}set view(k){this.viewModel.view=k}render(){return h.tsx("div",{class:this.classes("esri-legend",d.globalCss.widget,this.style instanceof y?d.globalCss.panel:null)},this.style.render())}_refreshActiveLayerInfos(k){k.forEach(l=>{this.removeHandles(`version_${l.layer.uid}`);this._renderOnActiveLayerInfoChange(l)});
this.scheduleRender()}_renderOnActiveLayerInfoChange(k){var l=H.watch(()=>k.version,()=>this.scheduleRender());this.addHandles(l,`version_${k.layer.uid}`);l=H.on(()=>k.children,"change",()=>k.children.forEach(n=>this._renderOnActiveLayerInfoChange(n)),H.initial);this.addHandles(l,`version_${k.layer.uid}`);k.children.forEach(n=>this._renderOnActiveLayerInfoChange(n))}};r.__decorate([P.property()],q.prototype,"activeLayerInfos",null);r.__decorate([P.property()],q.prototype,"basemapLegendVisible",null);
r.__decorate([P.property()],q.prototype,"groundLegendVisible",null);r.__decorate([P.property()],q.prototype,"headingLevel",void 0);r.__decorate([P.property()],q.prototype,"hideLayersNotInCurrentView",null);r.__decorate([P.property()],q.prototype,"keepCacheOnDestroy",null);r.__decorate([P.property()],q.prototype,"respectLayerVisibility",null);r.__decorate([P.property()],q.prototype,"iconClass",void 0);r.__decorate([P.property()],q.prototype,"icon",void 0);r.__decorate([P.property()],q.prototype,"label",
null);r.__decorate([P.property()],q.prototype,"layerInfos",null);r.__decorate([P.property(),g.messageBundle("esri/widgets/Legend/t9n/Legend")],q.prototype,"messages",void 0);r.__decorate([P.property()],q.prototype,"style",void 0);r.__decorate([A.cast("style")],q.prototype,"castStyle",null);r.__decorate([P.property()],q.prototype,"view",null);r.__decorate([P.property()],q.prototype,"viewModel",void 0);return q=r.__decorate([B.subclass("esri.widgets.Legend")],q)});