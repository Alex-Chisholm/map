// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.29/esri/copyright.txt for details.
//>>built
require({cache:{"esri/widgets/Features":function(){define("require ../chunks/tslib.es6 ../intl ../core/Collection ../core/Logger ../core/reactiveUtils ../core/throttle ../core/accessorSupport/decorators/property ../core/has ../core/RandomLCG ../core/accessorSupport/decorators/subclass ../geometry/support/geometryUtils ../support/actions/actionUtils ./Feature ./Spinner ./Widget ./Feature/resources ./Feature/support/FeatureContentMixin ./Features/css ./Features/FeaturesRelatedRecords ./Features/FeaturesViewModel ./Features/FeaturesVisibleElements ./Popup/actions ../chunks/componentsUtils ./support/globalCss ./support/Heading ./support/widgetUtils ./support/decorators/messageBundle ./support/decorators/vmEvent ./support/jsxFactory ../intl/substitute ../intl/number".split(" "),
function(b,k,h,y,w,C,J,K,Q,H,F,c,n,g,l,x,q,z,p,D,v,e,d,a,m,A,I,O,S,f,B,G){h=class extends z.FeatureContentMixin(x){constructor(u,N){super(u,N);this._featureMenuIntersectionObserverCallback=([t])=>{t?.isIntersecting&&null!=this.viewModel.featurePage&&this.viewModel.featurePage++};this._featureMenuIntersectionObserver=new IntersectionObserver(this._featureMenuIntersectionObserverCallback,{root:window.document});this._feature=this._spinner=this._focusOn=this._featureMenuIntersectionObserverNode=null;
this._relatedRecordsFlowItems=new y;this._relatedRecordsWidget=new D({flowItems:this._relatedRecordsFlowItems});this._actionBarMenuNode=this._featureMenuViewportNode=this._rootFlowItemNode=null;this.collapsed=!1;this.icon=null;this.featureNavigationTop=!1;this.headerActions=new d.ActionsCollection;this.headingLevel=2;this.messagesCommon=this.messages=null;this.responsiveActionsEnabled=!1;this.viewModel=new v;this.visibleElements=new e;this._renderAction=(t,r)=>{const E=this._getActionTitle(t),{type:P,
active:U,uid:W,disabled:aa,indicator:da}=t;return t.visible?f.tsx("calcite-action",{active:"toggle"===P?t.value:!1,appearance:"solid",bind:this,"data-action-uid":W,disabled:aa,icon:this._getActionIcon(t),indicator:da,key:`action-${r}`,loading:U,onclick:this._triggerAction,scale:"s",text:E,title:this._hideActionText?E:void 0},this._getFallbackIcon(t)):null};this._openFeatureMenu=()=>{this.featureMenuOpen=!0;this._focusOn="menu-flow-item"};this._previousFeature=()=>{this.viewModel.selectedFeatureIndex--};
this._nextFeature=()=>{this.viewModel.selectedFeatureIndex++};this._handleFeatureMenuBack=()=>{this.featureMenuOpen&&(this._focusOn="root-flow-item",this.featureMenuOpen=!1)};this._focusFlowItemNode=t=>{this._focusOn===t&&requestAnimationFrame(async()=>{switch(t){case "menu-flow-item":await this._featureMenuViewportNode?.setFocus();break;case "root-flow-item":await this._rootFlowItemNode?.setFocus()}this._focusOn=null})};this._focusFlowItemNodeThrottled=J.throttle(this._focusFlowItemNode,50);this._displaySpinnerThrottled=
J.throttle(()=>this._displaySpinner(),0);this._addSelectedFeatureIndexHandle();this.addHandles([this._displaySpinnerThrottled,this._focusFlowItemNodeThrottled,C.watch(()=>this.viewModel?.active,()=>this._toggleScreenLocationEnabled()),C.watch(()=>this.viewModel?.active,t=>this._relatedRecordsWidget.closed=!t),C.watch(()=>this.visibleElements?.closeButton,t=>this._relatedRecordsWidget.closable=t),C.watch(()=>this.visibleElements?.spinner,t=>this._spinnerEnabledChange(t)),C.watch(()=>this.viewModel?.view,
(t,r)=>this._viewChange(t,r)),C.watch(()=>this.viewModel?.view?.ready,(t,r)=>this._viewReadyChange(t??!1,r??!1)),C.watch(()=>[this.viewModel?.waitingForResult,this.viewModel?.location],()=>{this._hideSpinner();this._displaySpinnerThrottled()}),C.watch(()=>this.viewModel?.screenLocation,()=>this._closeOpenActionMenu()),C.watch(()=>this.selectedFeatureWidget,()=>this._destroyRelatedRecordsFlowItemWidgets()),C.watch(()=>{const t=this.selectedFeatureWidget?.viewModel;return[t?.title,t?.state]},()=>this._setTitleFromFeatureWidget()),
C.watch(()=>{const t=this.selectedFeatureWidget?.viewModel;return[t?.content,t?.state]},()=>this._setContentFromFeatureWidget()),C.watch(()=>this.viewModel?.featureViewModels,()=>this._featureMenuViewportScrollTop()),this._relatedRecordsWidget.on("close",()=>this.close()),this._relatedRecordsWidget.on("exit",()=>this._destroyRelatedRecordsFlowItemWidgets()),this._relatedRecordsWidget.on("open-related-feature",({feature:t})=>this._openRelatedFeature(t))])}loadDependencies(){return a.loadCalciteComponents({action:()=>
new Promise((u,N)=>b(["../chunks/calcite-action"],u,N)),"action-bar":()=>new Promise((u,N)=>b(["../chunks/calcite-action-bar"],u,N)),"action-group":()=>new Promise((u,N)=>b(["../chunks/calcite-action-group"],u,N)),button:()=>new Promise((u,N)=>b(["../chunks/calcite-button"],u,N)),flow:()=>new Promise((u,N)=>b(["../chunks/calcite-flow"],u,N)),"flow-item":()=>new Promise((u,N)=>b(["../chunks/calcite-flow-item"],u,N)),list:()=>new Promise((u,N)=>b(["../chunks/calcite-list"],u,N)),"list-item":()=>new Promise((u,
N)=>b(["../chunks/calcite-list-item"],u,N)),"list-item-group":()=>new Promise((u,N)=>b(["../chunks/calcite-list-item-group"],u,N)),loader:()=>new Promise((u,N)=>b(["../chunks/calcite-loader"],u,N))})}destroy(){this._destroyRelatedRecordsFlowItemWidgets();this._destroySelectedFeatureWidget();this._destroySpinner();this._unobserveFeatureMenuObserver();this._featureMenuIntersectionObserver?.disconnect();this._relatedRecordsWidget?.destroy()}get _hideActionText(){if(!this.responsiveActionsEnabled)return!1;
const u=this.view?.widthBreakpoint;return"xsmall"===u||"small"===u||"medium"===u}get _featureNavigationVisible(){return this.viewModel.active&&1<this.viewModel.featureCount&&this.visibleElements.featureNavigation}get _isCollapsed(){return this._collapseEnabled&&this.collapsed}get _collapseEnabled(){return this.visibleElements.collapseButton&&!!this.title&&!!this.content}get content(){return this.viewModel.content}set content(u){this.viewModel.content=u}get featureMenuOpen(){return this.viewModel.featureMenuOpen}set featureMenuOpen(u){this.viewModel.featureMenuOpen=
u}get features(){return this.viewModel.features}set features(u){this.viewModel.features=u}get location(){return this.viewModel.location}set location(u){this.viewModel.location=u}get label(){return this.messages?.widgetLabel??""}set label(u){this._overrideIfSome("label",u)}get promises(){return this.viewModel.promises}set promises(u){this.viewModel.promises=u}get selectedFeature(){return this.viewModel.selectedFeature}get selectedFeatureIndex(){return this.viewModel.selectedFeatureIndex}set selectedFeatureIndex(u){this.viewModel.selectedFeatureIndex=
u}get selectedFeatureWidget(){const {_feature:u,headingLevel:N,_relatedRecordsFlowItems:t}=this,{selectedFeatureViewModel:r}=this.viewModel,E={title:!1};if(!r)return null;u?(u.viewModel=r,u.visibleElements=E):this._feature=new g({flowItems:t,headingLevel:N+1,viewModel:r,visibleElements:E});return this._feature}get title(){return this.viewModel.title}set title(u){this.viewModel.title=u}get updateLocationEnabled(){return this.viewModel.updateLocationEnabled}set updateLocationEnabled(u){this.viewModel.updateLocationEnabled=
u}get view(){return this.viewModel.view}set view(u){this.viewModel.view=u}get visible(){return this.viewModel.visible}set visible(u){this.viewModel.visible=u}blur(){const {active:u}=this.viewModel;u?this._rootFlowItemNode?.blur():w.getLogger(this).warn("Features can only be blurred when currently active.")}clear(){return this.viewModel.clear()}close(){this.viewModel.visible=!1}fetchFeatures(u,N){return this.viewModel.fetchFeatures(u,N)}focus(){const {active:u}=this.viewModel;u?this._setFocusOn():
w.getLogger(this).warn("Features can only be focused when currently active.")}next(){return this.viewModel.next()}open(u){this.removeHandles("selected-index");this.set({collapsed:u?.collapsed??!1});this.viewModel.open(u);this.addHandles(C.when(()=>!this.viewModel.waitingForResult,()=>this._addSelectedFeatureIndexHandle(),{once:!0}))}previous(){return this.viewModel.previous()}triggerAction(u){return this.viewModel.triggerAction(u)}render(){return f.tsx("div",{bind:this,class:this.classes(p.css.base,
m.globalCss.widget,m.globalCss.panel),onkeydown:this._onMainKeydown},this._renderHeader(),this._renderContentContainer())}_renderFeatureNavigation(){return[this._renderPagination(),this._renderFeatureMenuButton()]}_renderHeader(){return!this.featureMenuOpen&&this.featureNavigationTop&&this._featureNavigationVisible?f.tsx("div",{class:p.css.header,key:"header-actions"},this._renderFeatureNavigation()):null}_renderFooter(){return this.featureMenuOpen||this.featureNavigationTop||!this._featureNavigationVisible?
null:f.tsx("div",{class:p.css.footer,key:"footer-actions",slot:"footer"},this._renderFeatureNavigation())}_renderFeatureMenuButton(){const {messages:u,viewModel:N}=this,{featureCount:t,selectedFeatureIndex:r,pendingPromisesCount:E}=N;return f.tsx("calcite-action",{appearance:"solid",bind:this,icon:"list",key:"feature-menu-button",label:u.selectFeature,loading:0<E,onclick:this._openFeatureMenu,scale:"s",text:B.substitute(u.pageText,{index:G.formatNumber(r+1),total:G.formatNumber(t)}),textEnabled:!0,
title:u.selectFeature})}_renderPagination(){const {previous:u,next:N}=this.messagesCommon.pagination;return f.tsx("calcite-action-bar",{class:p.css.paginationActionBar,expandDisabled:!0,key:"pagination-action-bar",layout:"horizontal",overflowActionsDisabled:!0,scale:"s"},f.tsx("calcite-action-group",{scale:"s"},f.tsx("calcite-action",{appearance:"solid",class:p.css.paginationPrevious,icon:"chevron-left",iconFlipRtl:!0,label:u,onclick:this._previousFeature,scale:"s",text:u,title:u}),f.tsx("calcite-action",
{appearance:"solid",icon:"chevron-right",iconFlipRtl:!0,label:N,onclick:this._nextFeature,scale:"s",text:N,title:N})))}_renderFeatureMenuItem(u){const {selectedFeatureViewModel:N,featureViewModels:t}=this.viewModel,r=u===N,E=t.indexOf(u);return f.tsx("calcite-list-item",{bind:this,"data-feature-index":E,key:`feature-menu-item-${u.uid}`,onblur:this._removeActiveFeature,onfocus:this._setActiveFeature,onmouseleave:this._removeActiveFeature,onmouseover:this._setActiveFeature,selected:r,onCalciteListItemSelect:this._selectFeature},
f.tsx("span",{innerHTML:u.title||this.messagesCommon.untitled,slot:"content"}))}_groupResultsByLayer(){const {featureViewModels:u}=this.viewModel,N=new Map;u.forEach(t=>{var r=t?.graphic;if(r){r=r.sourceLayer??r.layer;var E=N.get(r)??[];N.set(r,[...E,t])}});return N}_renderFeatureMenu(){const {featureViewModels:u}=this.viewModel,N=this._groupResultsByLayer();return u.length?f.tsx("calcite-list",{selectionAppearance:"icon",selectionMode:"single"},Array.from(N.keys()).map(t=>f.tsx("calcite-list-item-group",
{heading:t?.title??this.messagesCommon.untitled,key:t?.uid||"untitled"},N.get(t)?.map(r=>this._renderFeatureMenuItem(r))))):null}_renderHeaderAction(u,N){return u.visible?f.tsx("calcite-action",{active:"toggle"===u.type?u.value:!1,appearance:"solid",bind:this,"data-action-uid":u.uid,disabled:u.disabled,icon:u.icon||"",indicator:u.indicator,key:`header-action-${N}`,loading:u.active,onclick:this._triggerHeaderAction,scale:"m",slot:"header-actions-end",text:u.title||"",title:u.title||""}):null}_renderHeaderActions(){return this.headerActions.map((u,
N)=>this._renderHeaderAction(u,N)).toArray()}_renderContentFeature(){const {headingLevel:u,visibleElements:N,_isCollapsed:t,_collapseEnabled:r,featureNavigationTop:E}=this,{title:P,active:U}=this.viewModel,W=N.heading&&P?P:"";return f.tsx("calcite-flow-item",{afterCreate:this._storeRootFlowItemNode,afterUpdate:this._focusRootFlowItemNode,bind:this,class:this.classes({[p.css.contentFeature]:!0,[p.css.flowItemCollapsed]:t}),closable:N.closeButton,closed:!U,collapsed:t,collapseDirection:E?"down":"up",
collapsible:r,headingLevel:u,key:"root-flow-item",onCalciteFlowItemClose:this.close,onCalciteFlowItemToggle:this._handleCollapseToggle},W?f.tsx(A.Heading,{class:this.classes(p.css.featuresHeading,m.globalCss.heading),innerHTML:W,key:"header-content",level:this.headingLevel,slot:"header-content"}):null,this._renderHeaderActions(),this._renderActionBar(),t?null:f.tsx("div",{class:this.classes(p.css.container,p.css.contentContainer)},this._renderContent()),this._renderFooter())}_renderFeatureMenuContainer(){const {viewModel:u,
featureMenuOpen:N,messages:t,messagesCommon:r}=this,{active:E,featureViewModels:P,pendingPromisesCount:U}=u;return N?f.tsx("calcite-flow-item",{afterCreate:this._storeFeatureMenuFlowItemNode,afterUpdate:this._focusFeatureMenuFlowItemNode,bind:this,closable:!1,closed:!E,description:B.substitute(t.total,{total:P.length}),heading:t.selectFeature,key:"feature-menu",loading:u.waitingForContents,onCalciteFlowItemBack:W=>{W.preventDefault();this._handleFeatureMenuBack()}},0<U?f.tsx("calcite-loader",{class:p.css.loader,
inline:!0,key:"feature-menu-loader",label:r.loading,scale:"m",slot:"header-actions-end"}):null,f.tsx("div",{class:p.css.container},this._renderFeatureMenu()),f.tsx("div",{afterCreate:this._featureMenuIntersectionObserverCreated,bind:this,class:p.css.featureMenuObserver}),f.tsx("calcite-button",{appearance:"transparent",onclick:this._handleFeatureMenuBack,slot:"footer-actions",width:"full"},r.back)):null}_renderContentContainer(){const u=[this._renderContentFeature(),this._renderFeatureMenuContainer(),
this._relatedRecordsWidget.render()];return this.visibleElements.flow?f.tsx("calcite-flow",{key:"content-container"},u):u}_getFallbackIcon(u){const {className:N,icon:t}=u;if(t)return null;u=n.substituteActionImage({action:u,feature:this.selectedFeature});const r={[p.css.icon]:!!N,[p.css.actionImage]:!!u};N&&(r[N]=!0);return u||N?f.tsx("span",{"aria-hidden":"true",class:this.classes(p.css.icon,r),key:"icon",styles:n.getActionStyles(u)}):null}_renderActionBar(){return!this._isCollapsed&&this.visibleElements.actionBar&&
this.viewModel.allActions?.length?f.tsx("calcite-action-bar",{expandDisabled:!0,expanded:!this._hideActionText,key:"header-action-bar",scale:"s",slot:"action-bar"},f.tsx("calcite-action-group",{afterCreate:u=>this._actionBarMenuNode=u,overlayPositioning:"fixed",scale:"s"},this._renderActions())):null}_renderActions(){return this.viewModel.allActions.toArray().map(this._renderAction)}_renderContent(){const u=this.viewModel?.content;return u?"string"===typeof u?f.tsx("div",{class:q.css.contentNode,
innerHTML:u,key:u}):this.renderNodeContent(u):null}_setFocusOn(){this.renderNow();requestAnimationFrame(()=>{this._focusOn=this.featureMenuOpen?"menu-flow-item":"root-flow-item"})}_handleCollapseToggle(){this.collapsed=!this.collapsed}async _openRelatedFeature(u){await u.viewModel.updateGeometry();u=u.graphic;var N=u?.geometry;null!=N&&null!=u&&(this._destroyRelatedRecordsFlowItemWidgets(),await this.viewModel.zoomTo({target:N}),N=c.getPointFromGeometry(N),this.open({features:[u],location:null!=N?
N:void 0}))}_focusRootFlowItemNode(){this._focusFlowItemNodeThrottled("root-flow-item")}_focusFeatureMenuFlowItemNode(){this._focusFlowItemNodeThrottled("menu-flow-item")}_storeRootFlowItemNode(u){this._rootFlowItemNode=u;this._focusFlowItemNodeThrottled("root-flow-item")}_storeFeatureMenuFlowItemNode(u){this._featureMenuViewportNode=u;this._focusFlowItemNodeThrottled("menu-flow-item")}_setActiveFeature(u){const {viewModel:N}=this;u=u.currentTarget["data-feature-index"];N.activeFeature=N.features?.[u]||
null}_removeActiveFeature(){this.viewModel.activeFeature=null}_selectFeature(u){u=u.currentTarget["data-feature-index"];isNaN(u)||(this.viewModel.selectedFeatureIndex=u);this._handleFeatureMenuBack()}_unobserveFeatureMenuObserver(){this._featureMenuIntersectionObserverNode&&this._featureMenuIntersectionObserver.unobserve(this._featureMenuIntersectionObserverNode)}_featureMenuIntersectionObserverCreated(u){this._unobserveFeatureMenuObserver();this._featureMenuIntersectionObserver.observe(u);this._featureMenuIntersectionObserverNode=
u}_getActionIcon(u){if(u.icon)return u.icon;if(!u.image&&!u.className)return"question"}_getActionTitle(u){const {messages:N,selectedFeature:t,messagesCommon:r}=this,{id:E}=u,P=t?.attributes,U=u.title??"";return(u="zoom-to-feature"===E?B.substitute(U,{messages:N}):"remove-selected-feature"===E?B.substitute(U,{messages:r}):"zoom-to-clustered-features"===E?B.substitute(U,{messages:N}):"browse-clustered-features"===E?B.substitute(U,{messages:N}):u.title)&&P?B.substitute(u,P):u??""}_onMainKeydown(u){const {key:N}=
u;"ArrowLeft"===N&&(u.stopPropagation(),this._handleFeatureMenuBack(),this.previous());"ArrowRight"===N&&(u.stopPropagation(),this._handleFeatureMenuBack(),this.next())}_featureMenuViewportScrollTop(){this._featureMenuViewportNode&&this._featureMenuViewportNode.scrollContentTo({top:0})}_setContentFromFeatureWidget(){const {selectedFeatureWidget:u}=this;u&&(this.viewModel.content=u)}_setTitleFromFeatureWidget(){const {selectedFeatureWidget:u,messagesCommon:N}=this,t=u?.viewModel;u&&(this.viewModel.title=
"error"===t?.state?N?.errorMessage:t?.title||"")}_addSelectedFeatureIndexHandle(){const u=C.watch(()=>this.viewModel?.selectedFeatureIndex,(N,t)=>this._selectedFeatureIndexUpdated(N,t));this.addHandles(u,"selected-index")}_selectedFeatureIndexUpdated(u,N){const {featureCount:t}=this.viewModel;t&&u!==N&&-1!==u&&(this._destroyRelatedRecordsFlowItemWidgets(),this._rootFlowItemNode&&this._rootFlowItemNode.scrollContentTo({top:0}))}_triggerHeaderAction(u){u=u.currentTarget;if(!u.disabled){var N=u.dataset.actionUid;
(u=this.headerActions.find(({uid:t})=>t===N))&&!u.disabled&&("toggle"===u?.type&&(u.value=!u.value),this.emit("trigger-header-action",{action:u}))}}_triggerAction(u){u=u.currentTarget;if(!u.disabled){var N=u.dataset.actionUid,{allActions:t}=this.viewModel;u=t.findIndex(r=>r.uid===N);(t=t.at(u))&&"toggle"===t.type&&(t.value=!t.value);this.viewModel.triggerAction(u)}}_createSpinner(u){u&&(this._spinner=new l({view:u}),u.ui.add(this._spinner,{key:"features-spinner",position:"manual",internal:!0}))}_wireUpView(u){this._destroySpinner();
u&&this.visibleElements?.spinner&&this._createSpinner(u)}_hideSpinner(){const {_spinner:u}=this;u&&(u.location=null,u.hide())}_viewReadyChange(u,N){u?this._wireUpView(this.viewModel?.view):N&&this.viewModel.clear()}_viewChange(u,N){u&&N&&this.viewModel.clear()}_destroySelectedFeatureWidget(){const {_feature:u}=this;u&&(u.viewModel=null,!u.destroyed&&u.destroy());this._feature=null}_closeOpenActionMenu(){const {_actionBarMenuNode:u}=this;u&&(u.menuOpen=!1)}_destroyRelatedRecordsFlowItemWidgets(){this._relatedRecordsFlowItems.removeAll().forEach(u=>
{"showAllEnabled"in u.viewModel&&(u.viewModel.showAllEnabled=!1);u.viewModel=null;u.destroy()})}_toggleScreenLocationEnabled(){const {viewModel:u}=this;u&&(u.screenLocationEnabled=u.active)}_displaySpinner(){const {_spinner:u}=this;if(u){var {location:N,waitingForResult:t}=this.viewModel;t&&N?u.show({location:N}):u.hide()}}_destroySpinner(){const {_spinner:u,view:N}=this;u&&(N?.ui?.remove(u,"features-spinner"),u.destroy(),this._spinner=null)}_spinnerEnabledChange(u){this._destroySpinner();u&&this._createSpinner(this.viewModel?.view)}};
k.__decorate([K.property()],h.prototype,"_focusOn",void 0);k.__decorate([K.property()],h.prototype,"_relatedRecordsFlowItems",void 0);k.__decorate([K.property()],h.prototype,"_hideActionText",null);k.__decorate([K.property()],h.prototype,"_featureNavigationVisible",null);k.__decorate([K.property()],h.prototype,"_isCollapsed",null);k.__decorate([K.property()],h.prototype,"_collapseEnabled",null);k.__decorate([K.property()],h.prototype,"collapsed",void 0);k.__decorate([K.property()],h.prototype,"content",
null);k.__decorate([K.property()],h.prototype,"icon",void 0);k.__decorate([K.property()],h.prototype,"featureMenuOpen",null);k.__decorate([K.property()],h.prototype,"featureNavigationTop",void 0);k.__decorate([K.property()],h.prototype,"features",null);k.__decorate([K.property({type:d.ActionsCollection})],h.prototype,"headerActions",void 0);k.__decorate([K.property()],h.prototype,"headingLevel",void 0);k.__decorate([K.property()],h.prototype,"location",null);k.__decorate([K.property()],h.prototype,
"label",null);k.__decorate([K.property(),O.messageBundle("esri/widgets/Features/t9n/Features")],h.prototype,"messages",void 0);k.__decorate([K.property(),O.messageBundle("esri/t9n/common")],h.prototype,"messagesCommon",void 0);k.__decorate([K.property()],h.prototype,"promises",null);k.__decorate([K.property()],h.prototype,"responsiveActionsEnabled",void 0);k.__decorate([K.property({readOnly:!0})],h.prototype,"selectedFeature",null);k.__decorate([K.property()],h.prototype,"selectedFeatureIndex",null);
k.__decorate([K.property({readOnly:!0})],h.prototype,"selectedFeatureWidget",null);k.__decorate([K.property()],h.prototype,"title",null);k.__decorate([K.property()],h.prototype,"updateLocationEnabled",null);k.__decorate([K.property()],h.prototype,"view",null);k.__decorate([K.property({type:v}),S.vmEvent(["triggerAction","trigger-action"])],h.prototype,"viewModel",void 0);k.__decorate([K.property({type:e,nonNullable:!0})],h.prototype,"visibleElements",void 0);k.__decorate([K.property()],h.prototype,
"visible",null);return h=k.__decorate([F.subclass("esri.widgets.Features")],h)})},"esri/core/throttle":function(){define(["exports"],function(b){b.throttle=function(k,h,y,w){let C=null,J=1E3;"number"===typeof h?(J=h,w=y):(C=h??null,J=y);let K=0,Q;const H=()=>{K=0;k.apply(w,Q)};h=(...F)=>{C&&C.apply(w,F);Q=F;J?K||=setTimeout(H,J):H()};h.remove=()=>{K&&(clearTimeout(K),K=0)};h.forceUpdate=()=>{K&&(clearTimeout(K),H())};h.hasPendingUpdates=()=>!!K;return h};Object.defineProperty(b,Symbol.toStringTag,
{value:"Module"})})},"esri/geometry/support/geometryUtils":function(){define(["exports","../../geometry","./scaleUtils","../Extent"],function(b,k,h,y){function w(C,J,K){const Q=C.hasZ?C.z:void 0;if(J?.map)return(null!=K?h.getExtentForScale(J,K):J.extent).clone().centerAt(C).set({zmax:Q,zmin:Q});const {x:H,y:F,spatialReference:c}=C;return new y({xmin:H-.25,ymin:F-.25,xmax:H+.25,ymax:F+.25,spatialReference:c,zmin:Q,zmax:Q})}b.createExtentFromGeometry=function(C,J,K){switch(C?.type){case "extent":return C;
case "multipoint":case "polygon":case "polyline":return C.extent;case "point":return w(C,J,K);default:return null}};b.createExtentFromPoint=w;b.getPointFromGeometry=function(C){switch(C?.type){case "point":return C;case "extent":return C.center;case "polygon":return C.centroid;case "multipoint":case "polyline":return C.extent?.center;default:return null}};b.getPointWithElevation=async function(C,J){if(C.hasZ||"2d"===J.type)return C;const K=J.map?.ground;if(!K?.layers.length)return C;({geometry:C}=
await K.queryElevation(C,{cache:J.basemapTerrain?.elevationQueryCache}));return C};b.scaleExtent=function(C,J,K){return w(C.center,J,K)};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/scaleUtils":function(){define(["exports","../../core/mathUtils","../../core/unitUtils"],function(b,k,h){function y(w,C){C=h.getMetersPerUnitForSR(C);return w/(C*h.inchesPerMeter*96)}b.getExtentForScale=function(w,C){const J=w.extent;w=w.width-(w.padding?w.padding.left+w.padding.right:
0);C=y(C,J.spatialReference);return J.clone().expand(C*w/J.width)};b.getResolutionForScale=y;b.getResolutionInMetersForScale=function(w){return w/(96*h.inchesPerMeter)};b.getScale=function(w,C){C=C||w.extent;w=w.width;const J=h.getMetersPerUnitForSR(C?.spatialReference);return C&&w?C.width/w*J*h.inchesPerMeter*96:0};b.getScaleForResolution=function(w,C){C=h.getMetersPerUnitForSR(C);return w*C*h.inchesPerMeter*96};b.isInScaleRange=function(w,C,J){if(C=0===C||k.floatEqualAbsolute(w,C)||w<C)C=0===J||
k.floatEqualAbsolute(w,J)||w>J;return C};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/support/actions/actionUtils":function(){define(["exports","../../intl","../../intl/substitute"],function(b,k,h){b.getActionIcon=function(y){if(y.icon)return y.icon;if(!("image"in y&&y.image||y.className))return"question"};b.getActionStyles=function(y){return y?{backgroundImage:`url(${y})`}:{}};b.substituteActionImage=function({action:y,feature:w}){w=w?.attributes;return(y="image"in y?y.image:
void 0)&&w?h.substitute(y,w):y??""};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature":function(){define("require ../chunks/tslib.es6 ../intl ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/RandomLCG ../core/has ../core/accessorSupport/decorators/subclass ./Widget ./Feature/FeatureAttachments ./Feature/FeatureContent ./Feature/FeatureExpression ./Feature/FeatureFields ./Feature/FeatureMedia ./Feature/FeatureRelationship ./Feature/FeatureViewModel ./Feature/resources ./Feature/support/FeatureContentMixin ../chunks/componentsUtils ./support/globalCss ./support/Heading ./support/legacyIcon ./support/widgetUtils ./support/decorators/messageBundle ./support/jsxFactory ../intl/substitute".split(" "),
function(b,k,h,y,w,C,J,K,Q,H,F,c,n,g,l,x,q,z,p,D,v,e,d,a,m,A,I){var O;const S={title:!0,content:!0,lastEditedInfo:!0};h=O=class extends p.FeatureContentMixin(H){constructor(f,B){super(f,B);this._contentWidgets=[];this.flowItems=null;this.headingLevel=2;this.messagesCommon=this.messages=null;this.visibleElements={...S};this.viewModel=new q}initialize(){this.addHandles(y.watch(()=>this.viewModel?.contentViewModels,()=>this._setupContentWidgets(),y.initial))}loadDependencies(){return D.loadCalciteComponents({notice:()=>
new Promise((f,B)=>b(["../chunks/calcite-notice"],f,B))})}destroy(){this._destroyContentWidgets()}get graphic(){return this.viewModel.graphic}set graphic(f){this.viewModel.graphic=f}get defaultPopupTemplateEnabled(){return this.viewModel.defaultPopupTemplateEnabled}set defaultPopupTemplateEnabled(f){this.viewModel.defaultPopupTemplateEnabled=f}get isTable(){return this.viewModel.isTable}get label(){return this.messages?.widgetLabel??""}set label(f){this._overrideIfSome("label",f)}get spatialReference(){return this.viewModel.spatialReference}set spatialReference(f){this.viewModel.spatialReference=
f}get timeZone(){return this.viewModel.timeZone}set timeZone(f){this.viewModel.timeZone=f}get title(){return this.viewModel.title}castVisibleElements(f){return{...S,...f}}get map(){return this.viewModel.map}set map(f){this.viewModel.map=f}get view(){return this.viewModel.view}set view(f){this.viewModel.view=f}setActiveMedia(f,B){return this.viewModel.setActiveMedia(f,B)}nextMedia(f){return this.viewModel.nextMedia(f)}previousMedia(f){return this.viewModel.previousMedia(f)}render(){var {state:f}=this.viewModel;
f=A.tsx("div",{class:z.css.container,key:"container"},this._renderTitle(),"error"===f?this._renderError():"loading"===f?this._renderLoading():this._renderContentContainer());return A.tsx("div",{class:this.classes(z.css.base,v.globalCss.widget)},f)}_renderError(){const {messagesCommon:f,messages:B,visibleElements:G}=this;return A.tsx("calcite-notice",{icon:"exclamation-mark-circle",kind:"danger",open:!0,scale:"s"},G.title?A.tsx("div",{key:"error-title",slot:"title"},f.errorMessage):null,A.tsx("div",
{key:"error-message",slot:"message"},B.loadingError))}_renderLoading(){return A.tsx("div",{class:z.css.loadingSpinnerContainer,key:"loading-container"},A.tsx("span",{class:this.classes(d.legacyIcon.loadingIndicator,v.globalCss.rotating,z.css.spinner)}))}_renderContentContainer(){const {visibleElements:f}=this;return f.content?A.tsx("div",{class:z.css.main},[this._renderContent(),this._renderLastEditInfo()]):null}_renderTitle(){const {visibleElements:f,title:B}=this;return f.title?A.tsx(e.Heading,
{class:z.css.title,innerHTML:B,level:this.headingLevel}):null}_renderContent(){var f=this.viewModel.content;return f?Array.isArray(f)?f.length?A.tsx("div",{class:z.css.contentNode,key:"content-content-elements"},f.map(this._renderContentElement,this)):null:"string"===typeof f?(f=this._contentWidgets[0],!f||f.destroyed?null:A.tsx("div",{class:this.classes(z.css.contentNode,z.css.contentNodeText),key:"content-content"},f.render())):this.renderNodeContent(f):null}_renderContentElement(f,B){const {visibleElements:G}=
this;if("boolean"!==typeof G.content&&!G.content?.[f.type])return null;switch(f.type){case "attachments":return this._renderAttachments(B);case "custom":return this._renderCustom(f,B);case "fields":return this._renderFields(B);case "media":return this._renderMedia(B);case "text":return this._renderText(f,B);case "expression":return this._renderExpression(B);case "relationship":return this._renderRelationship(B);default:return null}}_renderAttachments(f){const B=this._contentWidgets[f];if(!B||B.destroyed)return null;
const {state:G,attachmentInfos:u}=B.viewModel;return"loading"===G||0<u.length?A.tsx("div",{class:this.classes(z.css.contentElement),key:this._buildKey("attachments-element",f)},B.render()):null}_renderRelationship(f){const B=this._contentWidgets[f];return B&&!B.destroyed&&this.flowItems?A.tsx("div",{class:z.css.contentElement,key:this._buildKey("relationship-element",f)},B.render()):null}_renderExpression(f){const B=this._contentWidgets[f];return!B||B.destroyed?null:A.tsx("div",{class:z.css.contentElement,
key:this._buildKey("expression-element",f)},B.render())}_renderCustom(f,B){({creator:f}=f);const G=this._contentWidgets[B];return!G||G.destroyed?null:f?A.tsx("div",{class:z.css.contentElement,key:this._buildKey("custom-element",B)},G.render()):null}_renderFields(f){const B=this._contentWidgets[f];return!B||B.destroyed?null:A.tsx("div",{class:z.css.contentElement,key:this._buildKey("fields-element",f)},B.render())}_renderMedia(f){const B=this._contentWidgets[f];return!B||B.destroyed?null:A.tsx("div",
{class:z.css.contentElement,key:this._buildKey("media-element",f)},B.render())}_renderLastEditInfo(){const {visibleElements:f,messages:B}=this;var {lastEditInfo:G}=this.viewModel;if(!G||!f.lastEditedInfo)return null;const {date:u,user:N}=G;G=I.substitute("edit"===G.type?N?B.lastEditedByUser:B.lastEdited:N?B.lastCreatedByUser:B.lastCreated,{date:u,user:N});return A.tsx("div",{class:this.classes(z.css.lastEditedInfo,z.css.contentElement),key:"edit-info-element"},G)}_renderText(f,B){const G=this._contentWidgets[B];
return!G||G.destroyed?null:f.text?A.tsx("div",{class:this.classes(z.css.contentElement,z.css.text),key:this._buildKey("text-element",B)},G.render()):null}_buildKey(f,...B){const G=this.viewModel?.graphic?.uid||"0";B=B.join("-");return`${f}__${G}-${B}`}_destroyContentWidget(f){f&&(f.viewModel=null,!f.destroyed&&f.destroy())}_destroyContentWidgets(){this.removeHandles("relationship-handles");this._contentWidgets.forEach(f=>this._destroyContentWidget(f));this._contentWidgets=[]}_addFeatureRelationshipHandles(f){const {flowItems:B,
visibleElements:G}=this;this.addHandles([y.on(()=>f,"select-record",({featureViewModel:u})=>{B&&(u.abilities={relationshipContent:!0},B.push(new O({flowItems:B,viewModel:u,visibleElements:G})))}),y.on(()=>f,"show-all-records",()=>{if(B){var {viewModel:u}=f;u.showAllEnabled=!0;u=new x({visibleElements:{title:!1,description:!1},viewModel:u});this._addFeatureRelationshipHandles(u);B.push(u)}})],"relationship-handles")}_setupContentWidgets(){this._destroyContentWidgets();const {headingLevel:f,visibleElements:B}=
this;var G=this.viewModel?.content;const {contentViewModels:u}=this.viewModel;Array.isArray(G)?G.forEach((N,t)=>{"attachments"===N.type&&(this._contentWidgets[t]=new F({displayType:N.displayType,headingLevel:B.title?f+1:f,viewModel:u[t]}));"fields"===N.type&&(this._contentWidgets[t]=new g({viewModel:u[t]}));"media"===N.type&&(this._contentWidgets[t]=new l({viewModel:u[t]}));"text"===N.type&&(this._contentWidgets[t]=new c({viewModel:u[t]}));"custom"===N.type&&(this._contentWidgets[t]=new c({viewModel:u[t]}));
"expression"===N.type&&(this._contentWidgets[t]=new n({viewModel:u[t]}));"relationship"===N.type&&(N=new x({viewModel:u[t]}),this._addFeatureRelationshipHandles(N),this._contentWidgets[t]=N)},this):(G=u[0])&&!G.destroyed&&(this._contentWidgets[0]=new c({viewModel:G}));this.scheduleRender()}};k.__decorate([w.property()],h.prototype,"graphic",null);k.__decorate([w.property()],h.prototype,"defaultPopupTemplateEnabled",null);k.__decorate([w.property()],h.prototype,"flowItems",void 0);k.__decorate([w.property()],
h.prototype,"headingLevel",void 0);k.__decorate([w.property({readOnly:!0})],h.prototype,"isTable",null);k.__decorate([w.property()],h.prototype,"label",null);k.__decorate([w.property(),m.messageBundle("esri/widgets/Feature/t9n/Feature")],h.prototype,"messages",void 0);k.__decorate([w.property(),m.messageBundle("esri/t9n/common")],h.prototype,"messagesCommon",void 0);k.__decorate([w.property()],h.prototype,"spatialReference",null);k.__decorate([w.property()],h.prototype,"timeZone",null);k.__decorate([w.property({readOnly:!0})],
h.prototype,"title",null);k.__decorate([w.property()],h.prototype,"visibleElements",void 0);k.__decorate([C.cast("visibleElements")],h.prototype,"castVisibleElements",null);k.__decorate([w.property()],h.prototype,"map",null);k.__decorate([w.property()],h.prototype,"view",null);k.__decorate([w.property({type:q})],h.prototype,"viewModel",void 0);return h=O=k.__decorate([Q.subclass("esri.widgets.Feature")],h)})},"esri/widgets/Feature/FeatureAttachments":function(){define("../../chunks/tslib.es6 ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../Attachments ../Widget ./FeatureAttachments/FeatureAttachmentsViewModel ./support/FeatureElementInfo ../support/widgetUtils ../support/jsxFactory".split(" "),
function(b,k,h,y,w,C,J,K,Q,H,F,c,n){y=class extends Q{constructor(g,l){super(g,l);this._featureElementInfo=null;this.attachmentsWidget=new K;this.headingLevel=2;this.viewModel=new H}initialize(){this._featureElementInfo=new F;this.addHandles([k.watch(()=>[this.viewModel?.description,this.viewModel?.title,this.headingLevel],()=>this._setupFeatureElementInfo(),k.initial),k.watch(()=>this.viewModel,g=>this.attachmentsWidget.viewModel=g,k.initial)])}destroy(){this.attachmentsWidget.viewModel=null;this.attachmentsWidget.destroy();
this._featureElementInfo?.destroy()}get description(){return this.viewModel.description}set description(g){this.viewModel.description=g}get displayType(){return this.attachmentsWidget.displayType}set displayType(g){this.attachmentsWidget.displayType=g}get graphic(){return this.viewModel.graphic}set graphic(g){this.viewModel.graphic=g}get title(){return this.viewModel.title}set title(g){this.viewModel.title=g}render(){const {attachmentsWidget:g}=this;return n.tsx("div",{class:"esri-feature-attachments"},
this._featureElementInfo?.render(),g?.render())}_setupFeatureElementInfo(){const {description:g,title:l,headingLevel:x}=this;this._featureElementInfo?.set({description:g,title:l,headingLevel:x})}};b.__decorate([h.property({readOnly:!0})],y.prototype,"attachmentsWidget",void 0);b.__decorate([h.property()],y.prototype,"description",null);b.__decorate([h.property()],y.prototype,"displayType",null);b.__decorate([h.property()],y.prototype,"graphic",null);b.__decorate([h.property()],y.prototype,"headingLevel",
void 0);b.__decorate([h.property()],y.prototype,"title",null);b.__decorate([h.property({type:H})],y.prototype,"viewModel",void 0);return y=b.__decorate([J.subclass("esri.widgets.Feature.FeatureAttachments")],y)})},"esri/widgets/Attachments":function(){define("require ../chunks/tslib.es6 ../core/Error ../core/reactiveUtils ../core/unitFormatUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/RandomLCG ../core/has ../core/accessorSupport/decorators/subclass ./Widget ./Attachments/AttachmentsViewModel ./Attachments/support/attachmentUtils ../chunks/componentsUtils ./support/globalCss ./support/legacyIcon ./support/widgetUtils ./support/decorators/messageBundle ./support/jsxFactory".split(" "),
function(b,k,h,y,w,C,J,K,Q,H,F,c,n,g,l,x,q,z,p){const D={addButton:!0,addSubmitButton:!0,cancelAddButton:!0,cancelUpdateButton:!0,deleteButton:!0,errorMessage:!0,progressBar:!0,updateButton:!0},v=window.CSS;K=class extends F{constructor(e,d){super(e,d);this.displayType="auto";this.selectedFile=this.messagesUnits=this.messages=null;this.submitting=!1;this.viewModel=null;this.visibleElements={...D};this._supportsImageOrientation=v&&v.supports&&v.supports("image-orientation","from-image");this._updateAttachmentForm=
this._addAttachmentForm=null}normalizeCtorArgs(e){e?.viewModel||(e={viewModel:new c,...e});return e}initialize(){this.addHandles([y.on(()=>this.viewModel?.attachmentInfos,"change",()=>this.scheduleRender()),y.on(()=>this.viewModel?.fileInfos,"change",()=>this.scheduleRender()),y.watch(()=>this.viewModel?.mode,()=>this._modeChanged(),y.initial)])}loadDependencies(){return g.loadCalciteComponents({icon:()=>new Promise((e,d)=>b(["../chunks/calcite-icon"],e,d))})}get capabilities(){return this.viewModel.capabilities}set capabilities(e){this.viewModel.capabilities=
e}get effectiveDisplayType(){const {displayType:e}=this;return e&&"auto"!==e?e:this.viewModel.supportsResizeAttachments?"preview":"list"}get graphic(){return this.viewModel.graphic}set graphic(e){this.viewModel.graphic=e}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}castVisibleElements(e){return{...D,...e}}addAttachment(){const {_addAttachmentForm:e,viewModel:d}=this;this._set("submitting",!0);this._set("error",null);return d.addAttachment(e).then(a=>
{this._set("submitting",!1);this._set("error",null);d.mode="view";return a}).catch(a=>{this._set("submitting",!1);this._set("error",new h("attachments:add-attachment",this.messages.addErrorMessage,a));throw a;})}deleteAttachment(e){const {viewModel:d}=this;this._set("submitting",!0);this._set("error",null);return d.deleteAttachment(e).then(a=>{this._set("submitting",!1);this._set("error",null);d.mode="view";return a}).catch(a=>{this._set("submitting",!1);this._set("error",new h("attachments:delete-attachment",
this.messages.deleteErrorMessage,a));throw a;})}updateAttachment(){const {viewModel:e}=this,{_updateAttachmentForm:d}=this;this._set("submitting",!0);this._set("error",null);return e.updateAttachment(d).then(a=>{this._set("submitting",!1);this._set("error",null);e.mode="view";return a}).catch(a=>{this._set("submitting",!1);this._set("error",new h("attachments:update-attachment",this.messages.updateErrorMessage,a));throw a;})}addFile(){const e=this.viewModel.addFile(this.selectedFile,this._addAttachmentForm);
this.viewModel.mode="view";return e}updateFile(){const {viewModel:e}=this,d=e.updateFile(this.selectedFile,this._updateAttachmentForm,e.activeFileInfo);e.mode="view";return d}deleteFile(e){e=this.viewModel.deleteFile(e||this.viewModel.activeFileInfo?.file);this.viewModel.mode="view";return e}render(){const {submitting:e,viewModel:d}=this,{state:a}=d;return p.tsx("div",{class:this.classes("esri-attachments",l.globalCss.widget)},e?this._renderProgressBar():null,"loading"===a?this._renderLoading():this._renderAttachments(),
this._renderErrorMessage())}_renderErrorMessage(){const {error:e,visibleElements:d}=this;return e&&d.errorMessage?p.tsx("div",{class:"esri-attachments__error-message",key:"error-message"},e.message):null}_renderAttachments(){const {activeFileInfo:e,mode:d,activeAttachmentInfo:a}=this.viewModel;return"add"===d?this._renderAddForm():"edit"===d?this._renderDetailsForm(a||e):this._renderAttachmentContainer()}_renderLoading(){return p.tsx("div",{class:"esri-attachments__loader-container",key:"loader"},
p.tsx("div",{class:"esri-attachments__loader"}))}_renderProgressBar(){return this.visibleElements.progressBar?p.tsx("div",{class:"esri-attachments__progress-bar",key:"progress-bar"}):null}_renderAddForm(){const {submitting:e,selectedFile:d}=this;var a=e||!d,m=this.visibleElements.cancelAddButton?p.tsx("button",{bind:this,class:this.classes(l.globalCss.button,l.globalCss.buttonTertiary,l.globalCss.buttonSmall,l.globalCss.buttonHalf,e&&l.globalCss.buttonDisabled),disabled:e,onclick:this._cancelForm,
type:"button"},this.messages.cancel):null;a=this.visibleElements.addSubmitButton?p.tsx("button",{class:this.classes(l.globalCss.button,l.globalCss.buttonSecondary,l.globalCss.buttonSmall,l.globalCss.buttonHalf,{[l.globalCss.buttonDisabled]:a}),disabled:a,type:"submit"},this.messages.add):null;const A=d?p.tsx("span",{class:"esri-attachments__file-name",key:"file-name"},d.name):null;m=p.tsx("form",{afterCreate:q.storeNode,afterRemoved:q.discardNode,bind:this,"data-node-ref":"_addAttachmentForm",onsubmit:this._submitAddAttachment},
p.tsx("fieldset",{class:"esri-attachments__file-fieldset"},A,p.tsx("label",{class:this.classes("esri-attachments__file-label",l.globalCss.button,l.globalCss.buttonSecondary)},d?this.messages.changeFile:this.messages.selectFile,p.tsx("input",{bind:this,class:"esri-attachments__file-input",name:"attachment",onchange:this._handleFileInputChange,type:"file"}))),a,m);return p.tsx("div",{class:"esri-attachments__form-node",key:"add-form-container"},m)}_renderDetailsForm(e){const {visibleElements:d,viewModel:a,
selectedFile:m,submitting:A}=this;var {capabilities:I}=a,O=A||!m;let S;if(m){var f=m.type;S=m.name;var B=m.size}else if(e&&"file"in e)f=e.file.type,S=e.file.name,B=e.file.size;else if(e&&"contentType"in e){f=e.contentType;S=e.name;B=e.size;var G=e.url}var u=I.editing&&I.operations?.delete&&d.deleteButton?p.tsx("button",{bind:this,class:this.classes(l.globalCss.button,l.globalCss.buttonSmall,l.globalCss.buttonTertiary,"esri-attachments__delete-button",{[l.globalCss.buttonDisabled]:A}),disabled:A,key:"delete-button",
onclick:t=>this._submitDeleteAttachment(t,e),type:"button"},this.messages.delete):void 0;O=I.editing&&I.operations?.update&&d.updateButton?p.tsx("button",{class:this.classes(l.globalCss.button,l.globalCss.buttonSmall,l.globalCss.buttonThird,{[l.globalCss.buttonDisabled]:O}),disabled:O,key:"update-button",type:"submit"},this.messages.update):void 0;const N=this.visibleElements.cancelUpdateButton?p.tsx("button",{bind:this,class:this.classes(l.globalCss.button,l.globalCss.buttonSmall,l.globalCss.buttonTertiary,
l.globalCss.buttonThird,{[l.globalCss.buttonDisabled]:A}),disabled:A,key:"cancel-button",onclick:this._cancelForm,type:"button"},this.messages.cancel):void 0;I=I.editing&&I.operations?.update?p.tsx("fieldset",{class:"esri-attachments__file-fieldset",key:"file"},p.tsx("span",{class:"esri-attachments__file-name",key:"file-name"},S),p.tsx("label",{class:this.classes("esri-attachments__file-label",l.globalCss.button,l.globalCss.buttonSecondary)},this.messages.changeFile,p.tsx("input",{bind:this,class:"esri-attachments__file-input",
name:"attachment",onchange:this._handleFileInputChange,type:"file"}))):void 0;B=p.tsx("fieldset",{class:"esri-attachments__metadata-fieldset",key:"size"},p.tsx("label",null,w.formatFileSize(this.messagesUnits,B??0)));f=p.tsx("fieldset",{class:"esri-attachments__metadata-fieldset",key:"content-type"},p.tsx("label",null,f));G=null!=G?p.tsx("a",{class:"esri-attachments__item-link",href:G,rel:"noreferrer",target:"_blank"},this._renderImageMask(e,400),p.tsx("div",{class:"esri-attachments__item-link-overlay"},
p.tsx("span",{class:"esri-attachments__item-link-overlay-icon"},p.tsx("calcite-icon",{icon:"launch"})))):this._renderImageMask(e,400);u=p.tsx("form",{afterCreate:q.storeNode,afterRemoved:q.discardNode,bind:this,"data-node-ref":"_updateAttachmentForm",onsubmit:t=>this._submitUpdateAttachment(t,e)},p.tsx("div",{class:"esri-attachments__metadata"},B,f),I,p.tsx("div",{class:"esri-attachments__actions"},u,N,O));return p.tsx("div",{class:"esri-attachments__form-node",key:"edit-form-container"},G,u)}_renderImageMask(e,
d){return e?"file"in e?this._renderGenericImageMask(e.file.name,e.file.type):this._renderImageMaskForAttachment(e,d):null}_renderGenericImageMask(e,d){var {supportsResizeAttachments:a}=this.viewModel;d=n.getIconPath(d);a={["esri-attachments__image--resizable"]:a};return p.tsx("div",{class:this.classes("esri-attachments__item-mask--icon","esri-attachments__item-mask"),key:d},p.tsx("img",{alt:e,class:this.classes(a,"esri-attachments__image"),src:d,title:e}))}_renderImageMaskForAttachment(e,d){var {supportsResizeAttachments:a}=
this.viewModel;if(!e)return null;const {contentType:m,name:A,url:I}=e;if(!a||!n.isSupportedImage(m))return this._renderGenericImageMask(A,m);e=(e=this._getCSSTransform(e))?{transform:e,"image-orientation":"none"}:{};d=`${I}${I?.includes("?")?"\x26":"?"}w=${d}`;a={["esri-attachments__image--resizable"]:a};return p.tsx("div",{class:this.classes("esri-attachments__item-mask"),key:d},p.tsx("img",{alt:A,class:this.classes(a,"esri-attachments__image"),src:d,styles:e,title:A}))}_renderFile(e){const {file:d}=
e;return p.tsx("li",{class:"esri-attachments__item",key:d},p.tsx("button",{"aria-label":this.messages.attachmentDetails,bind:this,class:"esri-attachments__item-button",key:"details-button",onclick:()=>this._startEditFile(e),title:this.messages.attachmentDetails,type:"button"},this._renderImageMask(e),p.tsx("label",{class:"esri-attachments__label"},p.tsx("span",{class:"esri-attachments__filename"},d.name||this.messages.noTitle),p.tsx("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-chevron-icon",
q.isRTL(this.container)?x.legacyIcon.left:x.legacyIcon.right)}))))}_renderAttachmentInfo({attachmentInfo:e,displayType:d}){const {viewModel:a,effectiveDisplayType:m}=this,{capabilities:A,supportsResizeAttachments:I}=a,{contentType:O,name:S,url:f}=e;d=this._renderImageMask(e,"list"===d?48:400);var B=A.editing?p.tsx("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-chevron-icon",q.isRTL(this.container)?x.legacyIcon.left:x.legacyIcon.right)}):null;B="preview"===m&&I&&n.isSupportedImage(O)?
null:p.tsx("label",{class:"esri-attachments__label"},p.tsx("span",{class:"esri-attachments__filename"},S||this.messages.noTitle),B);d=[d,B];d=A.editing?p.tsx("button",{"aria-label":this.messages.attachmentDetails,bind:this,class:"esri-attachments__item-button","data-attachment-info-id":e.id,key:"details-button",onclick:()=>this._startEditAttachment(e),title:this.messages.attachmentDetails,type:"button"},d):p.tsx("a",{class:"esri-attachments__item-button",href:f??void 0,key:"details-link",target:"_blank"},
d);return p.tsx("li",{class:"esri-attachments__item",key:e},d)}_renderAttachmentContainer(){const {effectiveDisplayType:e,viewModel:d,visibleElements:a}=this,{attachmentInfos:m,capabilities:A,fileInfos:I}=d;var O=!!m?.length;const S=!!I?.length,f={["esri-attachments__container--list"]:"preview"!==e,["esri-attachments__container--preview"]:"preview"===e},B=A.editing&&A.operations?.add&&a.addButton?p.tsx("button",{bind:this,class:this.classes(l.globalCss.button,l.globalCss.buttonTertiary,"esri-attachments__add-attachment-button"),
onclick:()=>this._startAddAttachment(),type:"button"},p.tsx("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-add-icon",x.legacyIcon.plus)}),this.messages.add):void 0,G=O?p.tsx("ul",{class:"esri-attachments__items",key:"attachments-list"},m.toArray().map(N=>this._renderAttachmentInfo({attachmentInfo:N,displayType:e}))):void 0,u=S?p.tsx("ul",{class:"esri-attachments__items",key:"file-list"},I.toArray().map(N=>this._renderFile(N))):void 0;O=S||O?void 0:p.tsx("div",{class:l.globalCss.empty},
this.messages.noAttachments);return p.tsx("div",{class:this.classes("esri-attachments__container",f),key:"attachments-container"},G,u,O,B)}_modeChanged(){this._set("error",null);this._set("selectedFile",null)}_handleFileInputChange(e){e=e.target.files?.item(0);this._set("selectedFile",e)}_submitDeleteAttachment(e,d){e.preventDefault();d&&("file"in d?this.deleteFile(d.file):d&&this.deleteAttachment(d))}_submitAddAttachment(e){e.preventDefault();this.viewModel.filesEnabled?this.addFile():this.addAttachment()}_submitUpdateAttachment(e,
d){e.preventDefault();d&&"file"in d?this.updateFile():this.updateAttachment()}_startEditAttachment(e){const {viewModel:d}=this;d.activeFileInfo=null;d.activeAttachmentInfo=e;d.mode="edit"}_startEditFile(e){const {viewModel:d}=this;d.activeAttachmentInfo=null;d.activeFileInfo=e;d.mode="edit"}_startAddAttachment(){this.viewModel.mode="add"}_cancelForm(e){e.preventDefault();this.viewModel.mode="view"}_getCSSTransform(e){({orientationInfo:e}=e);return!this._supportsImageOrientation&&e?[e.rotation?`rotate(${e.rotation}deg)`:
"",e.mirrored?"scaleX(-1)":""].join(" "):""}};k.__decorate([C.property()],K.prototype,"capabilities",null);k.__decorate([C.property()],K.prototype,"displayType",void 0);k.__decorate([C.property({readOnly:!0})],K.prototype,"effectiveDisplayType",null);k.__decorate([C.property()],K.prototype,"graphic",null);k.__decorate([C.property()],K.prototype,"label",null);k.__decorate([C.property(),z.messageBundle("esri/widgets/Attachments/t9n/Attachments")],K.prototype,"messages",void 0);k.__decorate([C.property(),
z.messageBundle("esri/core/t9n/Units")],K.prototype,"messagesUnits",void 0);k.__decorate([C.property({readOnly:!0})],K.prototype,"selectedFile",void 0);k.__decorate([C.property({readOnly:!0})],K.prototype,"submitting",void 0);k.__decorate([C.property({readOnly:!0})],K.prototype,"error",void 0);k.__decorate([C.property({type:c})],K.prototype,"viewModel",void 0);k.__decorate([C.property()],K.prototype,"visibleElements",void 0);k.__decorate([J.cast("visibleElements")],K.prototype,"castVisibleElements",
null);return K=k.__decorate([H.subclass("esri.widgets.Attachments")],K)})},"esri/core/unitFormatUtils":function(){define("exports ./ByteSizeUnit ./Cyclical ./mathUtils ./quantityUtils ./string ./unitUtils ../intl/number".split(" "),function(b,k,h,y,w,C,J,K){function Q(l,x,q){return l.units[x][q]}function H(l,x,q,z=2,p="abbr"){return`${K.formatNumber(x,{minimumFractionDigits:z,maximumFractionDigits:z,signDisplay:0<x?"never":"exceptZero"})} ${Q(l,q,p)}`}function F(l,x,q,z=2,p="abbr"){return`${K.formatNumber(x,
{minimumFractionDigits:z,maximumFractionDigits:z,signDisplay:"exceptZero"})} ${Q(l,q,p)}`}function c(l,x){const q=JSON.stringify(x);let z=n.get(q);z||(z=new Intl.NumberFormat("en-US",x),n.set(q,z));return/\-?\+?360/.test(z.format(l))?0:l}const n=new Map,g=["B","kB","MB","GB","TB"];b.formatAngleDegrees=function(l,x,q,z,p){p=p??2;l=h.cyclicalDegrees.normalize(w.convertRotationType(J.convertUnit(l,x,"degrees"),q,z),0,!0);p={style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:p,minimumFractionDigits:p,
signDisplay:0<l?"never":"exceptZero"};l=c(l,p);return K.formatNumber(l,p)};b.formatDMS=function(l,x,q=2){l=J.convertUnit(l,x,"degrees");x=l-Math.floor(l);l-=x;x*=60;let z=x-Math.floor(x);x-=z;z*=60;return`${l.toFixed()}\u00b0 ${x.toFixed()}' ${z.toFixed(q)}"`};b.formatDecimal=H;b.formatFileSize=function(l,x){x=Math.round(x);let q=0===x?0:Math.floor(Math.log(x)/Math.log(k.ByteSizeUnit.KILOBYTES));q=y.clamp(q,0,g.length-1);x=K.formatNumber(x/k.ByteSizeUnit.KILOBYTES**q,{maximumFractionDigits:2});return C.replace(l.units.bytes[g[q]],
{fileSize:x})};b.formatImperialArea=function(l,x,q,z=2,p="abbr"){const D=J.adaptiveImperialAreaUnit(x,q);return H(l,J.convertUnit(x,q,D),D,z,p)};b.formatImperialLength=function(l,x,q,z=2,p="abbr"){const D=J.adaptiveImperialLengthUnit(x,q);return H(l,J.convertUnit(x,q,D),D,z,p)};b.formatImperialRelativeLength=function(l,x,q,z=2,p="abbr"){const D=J.adaptiveImperialLengthUnit(x,q);return F(l,J.convertUnit(x,q,D),D,z,p)};b.formatImperialRelativeVerticalLength=function(l,x,q,z=2,p="abbr"){const D=J.adaptiveImperialVerticalLengthUnit(x,
q);return F(l,J.convertUnit(x,q,D),D,z,p)};b.formatImperialVerticalLength=function(l,x,q,z=2,p="abbr"){const D=J.adaptiveImperialVerticalLengthUnit(x,q);return H(l,J.convertUnit(x,q,D),D,z,p)};b.formatMetricArea=function(l,x,q,z=2,p="abbr"){const D=J.adaptiveMetricAreaUnit(x,q);return H(l,J.convertUnit(x,q,D),D,z,p)};b.formatMetricLength=function(l,x,q,z=2,p="abbr"){const D=J.adaptiveMetricLengthUnit(x,q);return H(l,J.convertUnit(x,q,D),D,z,p)};b.formatMetricRelativeLength=function(l,x,q,z=2,p="abbr"){const D=
J.adaptiveMetricLengthUnit(x,q);return F(l,J.convertUnit(x,q,D),D,z,p)};b.formatMetricRelativeVerticalLength=function(l,x,q,z=2,p="abbr"){const D=J.adaptiveMetricVerticalLengthUnit(x,q);return F(l,J.convertUnit(x,q,D),D,z,p)};b.formatMetricVerticalLength=function(l,x,q,z=2,p="abbr"){const D=J.adaptiveMetricVerticalLengthUnit(x,q);return H(l,J.convertUnit(x,q,D),D,z,p)};b.formatRelativeAngleDegrees=function(l,x,q,z,p){q!==z&&(l=-l);p=p??2;q={style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:p,
minimumFractionDigits:p,signDisplay:"exceptZero"};l=J.convertUnit(l,x,"degrees")%360;l=c(l,q);return K.formatNumber(l,q)};b.formatRelativeDecimal=F;b.unitName=Q;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/core/ByteSizeUnit":function(){define(["exports"],function(b){b.ByteSizeUnit=void 0;var k=b.ByteSizeUnit||(b.ByteSizeUnit={});k[k.KILOBYTES=1024]="KILOBYTES";k[k.MEGABYTES=1048576]="MEGABYTES";k[k.GIGABYTES=1073741824]="GIGABYTES";Object.defineProperty(b,Symbol.toStringTag,
{value:"Module"})})},"esri/core/quantityUtils":function(){define(["exports","./unitUtils"],function(b,k){function h(g,l){return{type:k.unitType(l),value:g,unit:l}}function y(g,l){return{type:k.unitType(l),value:g,unit:l}}function w(g,l){return{type:k.unitType(l),value:g,unit:l}}function C(g,l,x="arithmetic"){return{type:k.unitType(l),value:g,unit:l,rotationType:x}}function J(g,l){const x=K(g,l);return"angle"===g.type?C(x,l,g.rotationType):h(x,l)}function K(g,l){return k.convertUnit(g.value,g.unit,
l)}const Q=y(0,"meters"),H=w(0,"square-meters"),F=C(0,"radians"),c=C(0,"degrees"),n=C(0,"degrees","geographic");b.convertRotationType=function(g,l,x){if(l===x)return g;switch(x){case "arithmetic":case "geographic":return-g+90}};b.createAngle=C;b.createArea=w;b.createLength=y;b.createQuantity=h;b.isBaseUnit=function(g){return k.isBaseUnit(g.unit)};b.max=function(g,l){return null==g?l:null==l?g:g.value>k.convertUnit(l.value,l.unit,g.unit)?g:l};b.min=function(g,l){return null==g?l:null==l?g:g.value<
k.convertUnit(l.value,l.unit,g.unit)?g:l};b.scale=function(g,l){return null==g?null:{...g,value:g.value*l}};b.toBaseUnit=function(g){return J(g,k.baseUnitForUnit(g.unit))};b.toUnit=J;b.valueInUnit=K;b.zeroDegrees=c;b.zeroDegreesGeographic=n;b.zeroMeters=Q;b.zeroRadians=F;b.zeroSquareMeters=H;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Attachments/AttachmentsViewModel":function(){define("../../chunks/tslib.es6 ../../Graphic ../../core/Accessor ../../core/Collection ../../core/Error ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/RandomLCG ../../core/has ../../core/accessorSupport/decorators/subclass ../../rest/query/support/AttachmentInfo ../../rest/support/AttachmentQuery ../Feature/support/featureUtils".split(" "),
function(b,k,h,y,w,C,J,K,Q,H,F,c,n,g){const l={editing:!1,operations:{add:!0,update:!0,delete:!0}},x=y.ofType(c);h=class extends h{constructor(q){super(q);this._attachmentLayer=this._getAttachmentsPromise=null;this.capabilities={...l};this.activeFileInfo=this.activeAttachmentInfo=null;this.attachmentInfos=new x;this.fileInfos=new y;this.graphic=null;this.mode="view";this.filesEnabled=!1;this.addHandles(C.watch(()=>this.graphic,()=>this._graphicChanged(),C.initial))}destroy(){this.graphic=this._attachmentLayer=
null}castCapabilities(q){return{...l,...q}}get state(){return this._getAttachmentsPromise?"loading":this.graphic?"ready":"disabled"}get supportsResizeAttachments(){var {graphic:q}=this;if(!q)return!1;q=q.layer||q.sourceLayer;return q?.loaded&&"capabilities"in q&&q.capabilities&&"operations"in q.capabilities&&"supportsResizeAttachments"in q.capabilities.operations&&q.capabilities.operations.supportsResizeAttachments||!1}async getAttachments(){const {_attachmentLayer:q,attachmentInfos:z}=this;if(!q||
"function"!==typeof q.queryAttachments)throw new w("invalid-layer","getAttachments(): A valid layer is required.");const p=this._getObjectId();var D=new n({objectIds:[p],returnMetadata:!0});const v=[];this._getAttachmentsPromise=D=q.queryAttachments(D).then(e=>e[p]||v).catch(()=>v);this.notifyChange("state");D=await D;z.removeAll();D.length&&z.addMany(D);this._getAttachmentsPromise=null;this.notifyChange("state");return D}async addAttachment(q,z=this.graphic){const {_attachmentLayer:p,attachmentInfos:D,
capabilities:v}=this;if(!z)throw new w("invalid-graphic","addAttachment(): A valid graphic is required.",{graphic:z});if(!q)throw new w("invalid-attachment","addAttachment(): An attachment is required.",{attachment:q});if(!v.operations?.add)throw new w("invalid-capabilities","addAttachment(): add capabilities are required.");if(!p||"function"!==typeof p.addAttachment)throw new w("invalid-layer","addAttachment(): A valid layer is required.");q=await p.addAttachment(z,q).then(e=>this._queryAttachment(e.objectId,
z));D.add(q);return q}async deleteAttachment(q){const {_attachmentLayer:z,attachmentInfos:p,graphic:D,capabilities:v}=this;if(!q)throw new w("invalid-attachment-info","deleteAttachment(): An attachmentInfo is required.",{attachmentInfo:q});if(!v.operations?.delete)throw new w("invalid-capabilities","deleteAttachment(): delete capabilities are required.");if(!z||"function"!==typeof z.deleteAttachments)throw new w("invalid-layer","deleteAttachment(): A valid layer is required.");if(!D)throw new w("invalid-graphic",
"deleteAttachment(): A graphic is required.");const e=await z.deleteAttachments(D,[q.id]).then(()=>q);p.remove(e);return e}async updateAttachment(q,z=this.activeAttachmentInfo){const {_attachmentLayer:p,attachmentInfos:D,graphic:v,capabilities:e}=this;if(!q)throw new w("invalid-attachment","updateAttachment(): An attachment is required.",{attachment:q});if(!z)throw new w("invalid-attachment-info","updateAttachment(): An attachmentInfo is required.",{attachmentInfo:z});if(!e.operations?.update)throw new w("invalid-capabilities",
"updateAttachment(): Update capabilities are required.");const d=D.indexOf(z);if(!p||"function"!==typeof p.updateAttachment)throw new w("invalid-layer","updateAttachment(): A valid layer is required.");if(!v)throw new w("invalid-graphic","updateAttachment(): A graphic is required.");q=await p.updateAttachment(v,z.id,q).then(a=>this._queryAttachment(a.objectId));D.splice(d,1,q);return q}async commitFiles(){await Promise.all(this.fileInfos.items.map(q=>this.addAttachment(q.form)));this.fileInfos.removeAll();
return this.getAttachments()}addFile(q,z){if(!q||!z)return null;q={file:q,form:z};this.fileInfos.add(q);return q}updateFile(q,z,p=this.activeFileInfo){if(!q||!z||!p)return null;p=this.fileInfos.indexOf(p);-1<p&&this.fileInfos.splice(p,1,{file:q,form:z});return this.fileInfos.items[p]}deleteFile(q){const z=this.fileInfos.find(p=>p.file===q);return z?(this.fileInfos.remove(z),z):null}async _queryAttachment(q,z){const {_attachmentLayer:p}=this;if(!q||!p?.queryAttachments)throw new w("invalid-attachment-id",
"Could not query attachment.");const D=this._getObjectId(z);q=new n({objectIds:[D],attachmentsWhere:`AttachmentId=${q}`,returnMetadata:!0});return p.queryAttachments(q).then(v=>v[D][0])}_getObjectId(q=this.graphic){return q?.getObjectId()??null}_graphicChanged(){this.graphic&&(this._setAttachmentLayer(),this.getAttachments().catch(()=>{}))}_setAttachmentLayer(){var {graphic:q}=this;this._attachmentLayer=(q=g.getSourceLayer(q))?"scene"===q.type&&null!=q.associatedLayer?q.associatedLayer:q:null}};b.__decorate([J.property()],
h.prototype,"capabilities",void 0);b.__decorate([K.cast("capabilities")],h.prototype,"castCapabilities",null);b.__decorate([J.property()],h.prototype,"activeAttachmentInfo",void 0);b.__decorate([J.property()],h.prototype,"activeFileInfo",void 0);b.__decorate([J.property({readOnly:!0,type:x})],h.prototype,"attachmentInfos",void 0);b.__decorate([J.property()],h.prototype,"fileInfos",void 0);b.__decorate([J.property({type:k})],h.prototype,"graphic",void 0);b.__decorate([J.property()],h.prototype,"mode",
void 0);b.__decorate([J.property({readOnly:!0})],h.prototype,"state",null);b.__decorate([J.property()],h.prototype,"filesEnabled",void 0);b.__decorate([J.property({readOnly:!0})],h.prototype,"supportsResizeAttachments",null);return h=b.__decorate([F.subclass("esri.widgets.Attachments.AttachmentsViewModel")],h)})},"esri/rest/query/support/AttachmentInfo":function(){define("../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/RandomLCG ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../layers/support/exifUtils".split(" "),
function(b,k,h,y,w,C,J,K){var Q;const H={1:{id:1,rotation:0,mirrored:!1},2:{id:2,rotation:0,mirrored:!0},3:{id:3,rotation:180,mirrored:!1},4:{id:4,rotation:180,mirrored:!0},5:{id:5,rotation:-90,mirrored:!0},6:{id:6,rotation:90,mirrored:!1},7:{id:7,rotation:90,mirrored:!0},8:{id:8,rotation:-90,mirrored:!1}};k=Q=class extends k.JSONSupport{constructor(F){super(F);this.url=this.size=this.parentObjectId=this.parentGlobalId=this.name=this.keywords=this.globalId=this.id=this.exifInfo=this.contentType=null}get orientationInfo(){var {exifInfo:F}=
this;F=K.getExifValue({exifName:"Exif IFD0",tagName:"Orientation",exifInfo:F});return H[F]||null}clone(){return new Q({contentType:this.contentType,exifInfo:this.exifInfo,id:this.id,globalId:this.globalId,keywords:this.keywords,name:this.name,parentGlobalId:this.parentGlobalId,parentObjectId:this.parentObjectId,size:this.size,url:this.url})}};b.__decorate([h.property({type:String})],k.prototype,"contentType",void 0);b.__decorate([h.property()],k.prototype,"exifInfo",void 0);b.__decorate([h.property({readOnly:!0})],
k.prototype,"orientationInfo",null);b.__decorate([h.property({type:y.Integer})],k.prototype,"id",void 0);b.__decorate([h.property({type:String})],k.prototype,"globalId",void 0);b.__decorate([h.property({type:String})],k.prototype,"keywords",void 0);b.__decorate([h.property({type:String})],k.prototype,"name",void 0);b.__decorate([h.property({json:{read:!1}})],k.prototype,"parentGlobalId",void 0);b.__decorate([h.property({json:{read:!1}})],k.prototype,"parentObjectId",void 0);b.__decorate([h.property({type:y.Integer})],
k.prototype,"size",void 0);b.__decorate([h.property({json:{read:!1}})],k.prototype,"url",void 0);return k=Q=b.__decorate([J.subclass("esri.layers.support.AttachmentInfo")],k)})},"esri/layers/support/exifUtils":function(){define(["exports"],function(b){function k(h){const {tagName:y,tags:w}=h;return w&&y?w.find(C=>C.name===y)?.value||null:null}b.getExifValue=function(h){const {exifInfo:y,exifName:w,tagName:C}=h;return y&&w&&C?(h=y.find(J=>J.name===w))?k({tagName:C,tags:h.tags}):null:null};Object.defineProperty(b,
Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/support/featureUtils":function(){define("exports ../../../core/Logger ../../../core/string ../../../intl/date ../../../intl/number ../../../layers/support/fieldUtils ../../../layers/support/layerUtils ../../../smartMapping/support/utils ../../../support/arcadeOnDemand ../../../time/timeZoneUtils".split(" "),function(b,k,h,y,w,C,J,K,Q,H){function F(L){return L?U.test(L):!1}function c(L,M){if(F(M)&&L){var R=M.replace(U,"").toLowerCase();
return L.find(({name:T})=>T.toLowerCase()===R)}}function n(L,M){return(M=g(M,L))?M.name:L}function g(L,M){return L&&"function"===typeof L.getField&&M?L.getField(M)??null:null}function l({formattedAttributes:L,template:M,fieldInfoMap:R}){return`${h.replace(h.replace(M,T=>`{${R.get(T.toLowerCase())?.fieldName||T}}`),L).replaceAll(r,"")}`.trim()}function x(L,M,R=!1){const T=M[L];"string"===typeof T&&(R=(R?encodeURIComponent(T):T).replaceAll(P,"%27"),M[L]=R)}function q(L,M=!1){const R={...L};Object.keys(R).forEach(T=>
x(T,R,M));return R}function z(L,M){return L.replaceAll(E,(R,T,V)=>(R=g(M,V))?`{${R.name}}`:T)}function p(L,M,R){return(L=z(L,R))?L.replaceAll(da,(T,V,X)=>{V=`${V||X}`.trim();return h.replace(T,q(M,V&&"{"!==V[0]||!1))}):L}function D(L){return null!=L&&"object"===typeof L&&"fieldsIndex"in L&&"geometryType"in L&&"getField"in L&&"load"in L&&"loaded"in L&&"objectIdField"in L&&"spatialReference"in L&&"type"in L&&("feature"===L.type||"scene"===L.type)&&"when"in L}function v(L){return null!=L&&"object"===
typeof L&&"createQuery"in L&&"queryFeatureCount"in L&&"queryObjectIds"in L&&"queryRelatedFeatures"in L&&"queryRelatedFeaturesCount"in L&&"relationships"in L}function e(L){return D(L)&&v(L)}function d(L,M){const {fieldInfos:R,fieldName:T,preventPlacesFormatting:V,layer:X,timeZone:ca}=M;M=m(R,T);var ea=g(X,T);if(M&&!C.isRasterPixelValueField(T)){ea=ea?.type;const ha=M.format?.dateFormat;if("date"===ea||"date-only"===ea||"time-only"===ea||"timestamp-offset"===ea||ha)return K.formatAnyDate(L,{format:ha,
fieldType:ea,timeZoneOptions:{layerTimeZone:X&&"preferredTimeZone"in X?X.preferredTimeZone:null,viewTimeZone:ca,datesInUnknownTimezone:X&&"datesInUnknownTimezone"in X?!!X.datesInUnknownTimezone:!1}})}M=M?.format;if("string"===typeof L&&C.isRasterPixelValueField(T)&&M)return L=L.trim(),/\d{2}-\d{2}/.test(L)?L:L.includes(",")?a(L,",",", ",M):L.includes(";")?a(L,";","; ",M):L.includes(" ")?a(L," "," ",M):w.formatNumber(Number(L),w.convertNumberFormatToIntlOptions(M));"string"!==typeof L||!M||null!=M.dateFormat||
null==M.places&&null==M.digitSeparator||(ea=Number(L),isNaN(ea)||(L=ea));return"string"===typeof L||null==L||null==M?O(L):V?w.formatNumber(L,{...w.convertNumberFormatToIntlOptions(M),minimumFractionDigits:0,maximumFractionDigits:20}):w.formatNumber(L,w.convertNumberFormatToIntlOptions(M))}function a(L,M,R,T){return L.trim().split(M).map(V=>w.formatNumber(Number(V),w.convertNumberFormatToIntlOptions(T))).join(R)}function m(L,M){if(L?.length&&M)return L.find(R=>R.fieldName?.toLowerCase()===M.toLowerCase())}
function A({fieldName:L,graphic:M,layer:R}){if(G(L)||!R||"function"!==typeof R.getFeatureType)return null;const {typeIdField:T}=R;return T&&L===T?(L=R.getFeatureType(M))?L.name:null:null}function I({fieldName:L,value:M,graphic:R,layer:T}){return G(L)||!T||"function"!==typeof T.getFieldDomain?null:(L=R&&T.getFieldDomain(L,{feature:R}))&&"coded-value"===L.type?L.getName(M):null}function O(L){return"string"===typeof L?L.replaceAll(W,'\x3cbr class\x3d"esri-text-new-line" /\x3e'):L}function S(L){const {value:M,
fieldName:R,fieldInfos:T,fieldInfoMap:V,layer:X,graphic:ca,timeZone:ea}=L;return null==M?"":(L=I({fieldName:R,value:M,graphic:ca,layer:X}))||(L=A({fieldName:R,graphic:ca,layer:X}))?L:V.get(R.toLowerCase())?d(M,{fieldInfos:T||Array.from(V.values()),fieldName:R,layer:X,timeZone:ea}):(L=X?.fieldsIndex?.get(R))&&(K.isAnyDateField(L)||C.isTimeOnlyField(L))?K.formatAnyDate(M,{fieldType:L.type,timeZoneOptions:{layerTimeZone:X&&"preferredTimeZone"in X?X.preferredTimeZone:null,viewTimeZone:ea,datesInUnknownTimezone:X&&
"datesInUnknownTimezone"in X?!!X.datesInUnknownTimezone:!1}}):O(M)}async function f(L,M){const {layer:R,graphic:T,outFields:V,objectIds:X,returnGeometry:ca,spatialReference:ea}=L;L=X[0];if("number"!==typeof L&&"string"!==typeof L)return M={layer:R,graphic:T,objectId:L,requiredFields:V},k.getLogger("esri.widgets.Feature.support.featureUtils").warn("Could not query required fields for the specified feature. The feature's ID is invalid.",M),null;if(!J.getEffectiveLayerCapabilities(R)?.operations?.supportsQuery)return M=
{layer:R,graphic:T,requiredFields:V,returnGeometry:ca},k.getLogger("esri.widgets.Feature.support.featureUtils").warn("The specified layer cannot be queried. The following fields will not be available.",M),null;L=R.createQuery();L.objectIds=X;L.outFields=V?.length?V:[R.objectIdField];L.returnGeometry=!!ca;L.returnZ=!!ca;L.returnM=!!ca;L.outSpatialReference=ea;return(await R.queryFeatures(L,M)).features[0]}async function B(L){if(!L.expressionInfos?.length)return!1;var M=await Q.loadArcade();({arcadeUtils:{hasGeometryFunctions:M}}=
M);return M(L)}function G(L=""){return L?L.includes("relationships/"):!1}function u({attributes:L,graphic:M,relatedInfo:R,fieldInfos:T,fieldInfoMap:V,layer:X,timeZone:ca}){L&&M&&R&&Object.keys(M.attributes).forEach(ea=>{var ha=(ha={layerId:R.relation.id.toString(),fieldName:ea},`${"relationships/"}${ha.layerId}/${ha.fieldName}`);L[ha]=S({fieldName:ha,fieldInfos:T,fieldInfoMap:V,layer:X,value:M.attributes[ea],graphic:M,timeZone:ca})})}function N({attributes:L,relatedInfo:M,fieldInfoMap:R,fieldInfos:T,
layer:V,timeZone:X}){L&&M&&(M.relatedFeatures?.forEach(ca=>u({attributes:L,graphic:ca,relatedInfo:M,fieldInfoMap:R,fieldInfos:T,layer:V,timeZone:X})),M.relatedStatsFeatures?.forEach(ca=>u({attributes:L,graphic:ca,relatedInfo:M,fieldInfoMap:R,fieldInfos:T,layer:V,timeZone:X})))}function t(L,M,{relatedTableId:R}){const T="scene"===M.type&&M.associatedLayer?M.associatedLayer.url:M.url;return L.filter(e).find(V=>V!==M&&V.url===T&&V.layerId===R)}const r=/href=(""|'')/gi,E=/(\{([^\{\r\n]+)\})/g,P=/'/g,
U=/^\s*expression\//i,W=/(\n)/gi,aa=/[\u00A0-\u9999<>&]/gim,da=/href\s*=\s*(?:"([^"]+)"|'([^']+)')/gi,Z=/^(?:mailto:|tel:)/,fa=y.convertDateFormatToIntlOptions("short-date-short-time"),Y=L=>{if(!L)return!1;L=L.toUpperCase();return L.includes("CURRENT_TIMESTAMP")||L.includes("CURRENT_DATE")||L.includes("CURRENT_TIME")},ba=({layer:L,method:M,query:R,definitionExpression:T})=>{L.capabilities?.query?.supportsCacheHint&&"attachments"!==M&&(L=null!=R.where?R.where:null,M=null!=R.geometry?R.geometry:null,
Y(T)||Y(L)||"extent"===M?.type||"tile"===R.resultType||(R.cacheHint=!0))};b.applyTextFormattingHTML=O;b.createFieldInfoMap=function(L,M){const R=new Map;if(!L)return R;L.forEach(T=>{const V=n(T.fieldName,M);T.fieldName=V;R.set(V.toLowerCase(),T)});return R};b.findRelatedLayer=function(L,M,R){return L&&M&&R?t(L.allLayers,M,R)||t(L.allTables,M,R):null};b.fixTokens=z;b.formatAttributes=function({fieldInfos:L,attributes:M,layer:R,graphic:T,fieldInfoMap:V,relatedInfos:X,timeZone:ca}){const ea={};X?.forEach(ha=>
N({attributes:ea,relatedInfo:ha,fieldInfoMap:V,fieldInfos:L,layer:R,timeZone:ca}));M&&Object.keys(M).forEach(ha=>{ea[ha]=S({fieldName:ha,fieldInfos:L,fieldInfoMap:V,layer:R,value:M[ha],graphic:T,timeZone:ca})});return ea};b.formatEditInfo=function(L,M,R,T){const {creatorField:V,creationDateField:X,editorField:ca,editDateField:ea}=L;if(M){L=H.getTimeZoneFormattingOptions(T&&"preferredTimeZone"in T?T.preferredTimeZone:null,T&&"datesInUnknownTimezone"in T?!!T.datesInUnknownTimezone:!1,R,fa,"date");L=
{...fa,...L};R=M[ea];if("number"===typeof R)return M=M[ca],{type:"edit",date:y.formatDate(R,L),user:M};R=M[X];return"number"===typeof R?(M=M[V],{type:"create",date:y.formatDate(R,L),user:M}):null}};b.formatValueToFieldInfo=d;b.getAllFieldInfos=function(L){const M=[];if(!L)return M;const {fieldInfos:R,content:T}=L;R&&M.push(...R);if(!T||!Array.isArray(T))return M;T.forEach(V=>{"fields"===V.type&&(V=V?.fieldInfos)&&M.push(...V)});return M};b.getFieldInfo=m;b.getFieldInfoLabel=function(L,M){return(M=
c(M,L?.fieldName))?M.title||null:L?L.label||L.fieldName:null};b.getFixedFieldName=n;b.getFixedFieldNames=function(L,M){return L&&L.map(R=>n(R,M))};b.getHighlightKeyForFeature=function(L){const M=L.getObjectId();return null!=M?`oid:${M}`:`uid:${L.uid}`};b.getSourceLayer=function(L){if(null!=L)return(L.sourceLayer||L.layer)??void 0};b.graphicCallback=async function(L,M){return"function"===typeof L?L(M):L};b.htmlEntities=function(L){return L.replaceAll(aa,M=>`&#${M.charCodeAt(0)};`)};b.isExpressionField=
F;b.isFeatureSupportedLayer=D;b.isGraphicForRelatableFeatureSupportedLayer=function(L){return!!L&&"object"===typeof L&&"sourceLayer"in L&&e(L.sourceLayer)};b.isRelatableFeatureSupportedLayer=e;b.isRelatableLayer=v;b.isRelatedField=G;b.preLayerQueryCallback=({query:L,layer:M,method:R})=>{ba({layer:M,method:R,query:L,definitionExpression:`${M.definitionExpression} ${M.serviceDefinitionExpression}`})};b.preRequestCallback=({queryPayload:L,layer:M,method:R})=>{ba({layer:M,method:R,query:L,definitionExpression:`${M.definitionExpression} ${M.serviceDefinitionExpression}`})};
b.querySourceLayer=f;b.queryUpdatedFeature=async function({graphic:L,popupTemplate:M,layer:R,spatialReference:T},V){if(R&&M&&("function"===typeof R.load&&await R.load(V),L.attributes)){var X=L.attributes[R.objectIdField];if(null!=X){X=[X];var ca=await M.getRequiredFields(R.fieldsIndex),ea=C.featureHasFields(ca,L);ca=ea?[]:ca;M=M.returnGeometry||await B(M);if(!ea||M)if(R=await f({layer:R,graphic:L,outFields:ca,objectIds:X,returnGeometry:M,spatialReference:T},V))R.geometry&&(L.geometry=R.geometry),
R.attributes&&(L.attributes={...L.attributes,...R.attributes})}}};b.shouldOpenInNewTab=function(L=""){if(L)return!Z.test(L.trim().toLowerCase())};b.substituteAttributes=l;b.substituteFieldsInLinksAndAttributes=function({attributes:L,globalAttributes:M,layer:R,text:T,expressionAttributes:V,fieldInfoMap:X}){return T?l({formattedAttributes:M,template:p(T,{...M,...V,...L},R),fieldInfoMap:X}):""};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/smartMapping/support/utils":function(){define("exports ../../intl/date ../../layers/support/fieldUtils ../../support/arcadeOnDemand ../../support/basemapUtils ../../time/timeZoneUtils".split(" "),
function(b,k,h,y,w,C){function J(g){return String(g).padStart(2,"0")}function K(g,l,x){if("date"===l||"number"===l){"number"===l&&(g=new Date(g));l=x?g.getFullYear():g.getUTCFullYear();const q=J((x?g.getMonth():g.getUTCMonth())+1),z=J(x?g.getDate():g.getUTCDate()),p=J(x?g.getHours():g.getUTCHours()),D=J(x?g.getMinutes():g.getUTCMinutes());g=J(x?g.getSeconds():g.getUTCSeconds());g=`TIMESTAMP'${l}-${q}-${z} ${p}:${D}:${g}'`}return g}function Q(g,l){if(l instanceof Date)return"date";if("number"===typeof l)return"number";
if("string"===typeof l&&(g=g.getField(l),"\x3cnow\x3e"!==l.toLowerCase()&&h.isDateField(g)))return"field"}const H={light:"streets gray topo terrain oceans osm gray-vector streets-vector topo-vector streets-relief-vector streets-navigation-vector topo-3d navigation-3d streets-3d osm-3d gray-3d arcgis-light-gray arcgis-navigation arcgis-streets arcgis-streets-relief arcgis-topographic arcgis-oceans osm-standard osm-standard-relief osm-streets osm-streets-relief osm-light-gray arcgis-terrain arcgis-charted-territory arcgis-community arcgis-colored-pencil arcgis-modern-antique arcgis-midcentury arcgis-newspaper arcgis-hillshade-light".split(" "),
dark:"satellite hybrid dark-gray dark-gray-vector streets-night-vector navigation-dark-3d streets-dark-3d dark-gray-3d arcgis-imagery arcgis-imagery-standard arcgis-dark-gray arcgis-navigation-night arcgis-streets-night osm-dark-gray arcgis-nova arcgis-hillshade-dark".split(" ")},F={years:365,months:30,days:1,hours:1/24,minutes:1/1440,seconds:1/86400,milliseconds:1/864E5},c=new Set(["integer","small-integer"]);let n=null;b.castIntegerFieldToFloat=function(g){return`cast(${g} as float)`};b.dateTypes=
["date","date-only","timestamp-offset"];b.defaultBasemapGroups=H;b.fieldDelimiter=",";b.formatAnyDate=function(g,l){const {format:x,timeZoneOptions:q,fieldType:z}=l??{};let p;q&&({timeZone:D,timeZoneName:p}=C.getTimeZoneFormattingOptions(q.layerTimeZone,q.datesInUnknownTimezone,q.viewTimeZone,k.convertDateFormatToIntlOptions(x||"short-date-short-time"),z));if("string"===typeof g&&isNaN(Date.parse("time-only"===z?`1970-01-01T${g}Z`:g)))return g;switch(z){case "date-only":var D=k.convertDateFormatToIntlOptions(x||
"short-date");return"string"===typeof g?k.formatDateOnly(g,{...D}):k.formatDate(g,{...D,timeZone:C.utc});case "time-only":return D=k.convertDateFormatToIntlOptions(x||"short-time"),"string"===typeof g?k.formatTimeOnly(g,D):k.formatDate(g,{...D,timeZone:C.utc});case "timestamp-offset":if(!D&&"string"===typeof g&&(new Date(g)).toISOString()!==g)return g;D=(l=x||q?k.convertDateFormatToIntlOptions(x||"short-date-short-time"):void 0)?{...l,timeZone:D,timeZoneName:p}:void 0;return"string"===typeof g?k.formatTimestamp(g,
D):k.formatDate(g,D);default:return l=x||q?k.convertDateFormatToIntlOptions(x||"short-date-short-time"):void 0,k.formatDate("string"===typeof g?new Date(g):g,l?{...l,timeZone:D,timeZoneName:p}:void 0)}};b.getBasemapGroup=function(g,l=H){for(const x in l)if(l[x].includes(g))return x};b.getBasemapId=function(g,l,x=!0){let q=null;g&&("string"===typeof g?l.includes(g)&&(q=g):q=w.getWellKnownBasemapId(g));return x?q||"gray":q};b.getDateDiffSQL=function(g,l,x,q){const {hasQueryEngine:z}=g;x=K(x,Q(g,x),
z);g=K(l,Q(g,l),z);g=`(${x} - ${g})`;q=F[q];l="/";1>q&&(q=1/q,l="*");return{sqlExpression:1===q?g:`(${g} ${l} ${q})`,sqlWhere:null}};b.getDateType=Q;b.getFieldsList=async function(g){const {field:l,field2:x,field3:q,normalizationField:z,valueExpression:p}=g;g=[];p&&(n||({arcadeUtils:g}=await y.loadArcade(),n=g),g=n.extractFieldNames(p));l&&g.push(l);x&&g.push(x);q&&g.push(q);z&&g.push(z);return g};b.getNormalizationType=function(g){let l=g.normalizationType;l||(g.normalizationField?l="field":null!=
g.normalizationTotal&&(l="percent-of-total"));return l??void 0};b.isAnyDateField=function(g){return h.isDateField(g)||h.isDateOnlyField(g)||h.isTimestampOffsetField(g)};b.isIntegerField=function(g,l){g=l&&g.getField(l);return!!g&&c.has(g.type)};b.unitValueInDays=F;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Attachments/support/attachmentUtils":function(){define(["exports","../../../assets"],function(b,k){b.getIconPath=function(h){const y=k.getAssetUrl("esri/themes/base/images/files/");
return h?"text/plain"===h?`${y}text-32.svg`:"application/pdf"===h?`${y}pdf-32.svg`:"text/csv"===h?`${y}csv-32.svg`:"application/gpx+xml"===h?`${y}gpx-32.svg`:"application/x-dwf"===h?`${y}cad-32.svg`:"application/postscript"===h||"application/json"===h||"text/xml"===h||"model/vrml"===h?`${y}code-32.svg`:"application/x-zip-compressed"===h||"application/x-7z-compressed"===h||"application/x-gzip"===h||"application/x-tar"===h||"application/x-gtar"===h||"application/x-bzip2"===h||"application/gzip"===h||
"application/x-compress"===h||"application/x-apple-diskimage"===h||"application/x-rar-compressed"===h||"application/zip"===h?`${y}zip-32.svg`:h.includes("image/")?`${y}image-32.svg`:h.includes("audio/")?`${y}sound-32.svg`:h.includes("video/")?`${y}video-32.svg`:h.includes("msexcel")||h.includes("ms-excel")||h.includes("spreadsheetml")?`${y}excel-32.svg`:h.includes("msword")||h.includes("ms-word")||h.includes("wordprocessingml")?`${y}word-32.svg`:h.includes("powerpoint")||h.includes("presentationml")?
`${y}report-32.svg`:`${y}generic-32.svg`:`${y}generic-32.svg`};b.isSupportedImage=function(h){h=h.toLowerCase();return"image/bmp"===h||"image/emf"===h||"image/exif"===h||"image/gif"===h||"image/x-icon"===h||"image/jpeg"===h||"image/png"===h||"image/tiff"===h||"image/x-wmf"===h};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/globalCss":function(){define(["exports"],function(b){b.globalCss={anchor:"esri-widget__anchor",anchorDisabled:"esri-widget__anchor--disabled",
button:"esri-button",buttonDisabled:"esri-button--disabled",buttonHalf:"esri-button--half",buttonSecondary:"esri-button--secondary",buttonSmall:"esri-button--small",buttonTertiary:"esri-button--tertiary",buttonThird:"esri-button--third",disabled:"esri-disabled",disabledElement:"esri-disabled-element",empty:"esri-widget__content--empty",emptyIllustration:"esri-widget__content-illustration--empty",heading:"esri-widget__heading",hidden:"esri-hidden",input:"esri-input",interactive:"esri-interactive",
loader:"esri-widget__loader",loaderAnimation:"esri-widget__loader-animation",loaderText:"esri-widget__loader-text",menu:"esri-menu",menuHeader:"esri-menu__header",menuItem:"esri-menu__list-item",menuItemActive:"esri-menu__list-item--active",menuItemFocus:"esri-menu__list-item--focus",menuList:"esri-menu__list",noBookmarksIcon:"esri-widget__no-bookmark-icon",panel:"esri-widget--panel",panelHeightOnly:"esri-widget--panel-height-only",primaryTick:"primary-tick",primaryTickAmPm:"primary-tick__ampm",primaryTickLabel:"primary-tick__label",
rotating:"esri-rotating",secondaryTick:"secondary-tick",select:"esri-select",table:"esri-widget__table",widget:"esri-widget",widgetButton:"esri-widget--button",widgetButtonActive:"esri-widget--button-active",widgetDisabled:"esri-widget--disabled"};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/FeatureAttachments/FeatureAttachmentsViewModel":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../Attachments/AttachmentsViewModel".split(" "),
function(b,k,h,y,w,C,J){h=class extends J{constructor(K){super(K);this.title=this.description=null}};b.__decorate([k.property()],h.prototype,"description",void 0);b.__decorate([k.property()],h.prototype,"title",void 0);return h=b.__decorate([C.subclass("esri.widgets.Feature.FeatureAttachments.FeatureAttachmentsViewModel")],h)})},"esri/widgets/Feature/support/FeatureElementInfo":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../Widget ../../support/Heading ../../support/widgetUtils ../../support/jsxFactory".split(" "),
function(b,k,h,y,w,C,J,K,Q,H){h=class extends J{constructor(F,c){super(F,c);this.description=null;this.headingLevel=2;this.title=null}render(){return H.tsx("div",{class:"esri-feature-element-info"},this._renderTitle(),this._renderDescription())}_renderTitle(){const {title:F}=this;return F?H.tsx(K.Heading,{class:"esri-feature-element-info__title",level:this.headingLevel},F):null}_renderDescription(){const {description:F}=this;return F?H.tsx("div",{class:"esri-feature-element-info__description",key:"description"},
F):null}};b.__decorate([k.property()],h.prototype,"description",void 0);b.__decorate([k.property()],h.prototype,"headingLevel",void 0);b.__decorate([k.property()],h.prototype,"title",void 0);return h=b.__decorate([C.subclass("esri.widgets.Feature.support.FeatureElementInfo")],h)})},"esri/widgets/support/Heading":function(){define(["exports","../../core/mathUtils","./globalCss","./widgetUtils","./jsxFactory"],function(b,k,h,y,w){b.Heading=function({level:C,class:J,...K},Q){C=k.clamp(Math.ceil(C),1,
6);return w.tsx(`h${C}`,{...K,"aria-level":String(C),class:y.classes(h.globalCss.heading,J),role:"heading"},Q)};b.incrementHeadingLevel=function(C,J=1){return k.clamp(Math.ceil(C+J),1,6)};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/FeatureContent":function(){define("../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../Widget ./FeatureContent/FeatureContentViewModel ./support/featureUtils ../support/widget ../support/jsxFactory".split(" "),
function(b,k,h,y,w,C,J,K,Q,H,F){h=class extends J{constructor(c,n){super(c,n);this.viewModel=null;this._addTargetToAnchors=g=>{Array.from(g.querySelectorAll("a")).forEach(l=>{Q.shouldOpenInNewTab(l.href)&&!l.hasAttribute("target")&&l.setAttribute("target","_blank")})}}get creator(){return this.viewModel?.creator}set creator(c){this.viewModel&&(this.viewModel.creator=c)}get graphic(){return this.viewModel?.graphic}set graphic(c){this.viewModel&&(this.viewModel.graphic=c)}render(){return F.tsx("div",
{class:"esri-feature-content"},"loading"===this.viewModel?.state?this._renderLoading():this._renderCreated())}_renderLoading(){return F.tsx("div",{class:"esri-feature-content__loader-container",key:"loader"},F.tsx("div",{class:"esri-feature-content__loader"}))}_renderCreated(){const c=this.viewModel?.created;return c?c instanceof HTMLElement?F.tsx("div",{afterCreate:this._attachToNode,bind:c,key:c}):H.isWidget(c)?F.tsx("div",{key:c},!c.destroyed&&c.render()):F.tsx("div",{afterCreate:this._addTargetToAnchors,
innerHTML:c,key:c}):null}_attachToNode(c){c.appendChild(this)}};b.__decorate([k.property()],h.prototype,"creator",null);b.__decorate([k.property()],h.prototype,"graphic",null);b.__decorate([k.property({type:K})],h.prototype,"viewModel",void 0);return h=b.__decorate([C.subclass("esri.widgets.Feature.FeatureContent")],h)})},"esri/widgets/Feature/FeatureContent/FeatureContentViewModel":function(){define("../../../chunks/tslib.es6 ../../../Graphic ../../../core/Accessor ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../support/featureUtils".split(" "),
function(b,k,h,y,w,C,J,K,Q,H){h=class extends h{constructor(F){super(F);this.graphic=this.destroyer=this.creator=this.created=this._loadingPromise=null;this.addHandles(y.watch(()=>this.creator,c=>{this._destroyContent();this._createContent(c)},y.initial))}destroy(){this._destroyContent()}get state(){return this._loadingPromise?"loading":"ready"}_destroyContent(){const {created:F,graphic:c,destroyer:n}=this;F&&c&&(H.graphicCallback(n,{graphic:c}).catch(()=>null),this._set("created",null))}async _createContent(F){var c=
this.graphic;c&&F&&(this._loadingPromise=F=H.graphicCallback(F,{graphic:c}).catch(()=>null),this.notifyChange("state"),c=await F,F===this._loadingPromise&&(this._loadingPromise=null,this.notifyChange("state"),this._set("created",c)))}};b.__decorate([w.property({readOnly:!0})],h.prototype,"created",void 0);b.__decorate([w.property()],h.prototype,"creator",void 0);b.__decorate([w.property()],h.prototype,"destroyer",void 0);b.__decorate([w.property({type:k})],h.prototype,"graphic",void 0);b.__decorate([w.property({readOnly:!0})],
h.prototype,"state",null);return h=b.__decorate([Q.subclass("esri.widgets.Feature.FeatureContent.FeatureContentViewModel")],h)})},"esri/widgets/Feature/FeatureExpression":function(){define("../../chunks/tslib.es6 ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../Widget ./FeatureContent ./FeatureFields ./FeatureMedia ./FeatureExpression/FeatureExpressionViewModel ../support/globalCss ../support/legacyIcon ../support/widgetUtils ../support/jsxFactory".split(" "),
function(b,k,h,y,w,C,J,K,Q,H,F,c,n,g,l,x){y=class extends K{constructor(q,z){super(q,z);this._contentWidget=null;this.viewModel=new c}initialize(){this.addHandles(k.watch(()=>this.viewModel?.contentElementViewModel,()=>this._setupExpressionWidget(),k.initial))}destroy(){this._destroyContentWidget()}render(){const {state:q}=this.viewModel;return x.tsx("div",{class:"esri-feature-expression"},"loading"===q?this._renderLoading():"disabled"===q?null:this._contentWidget?.render())}_renderLoading(){return x.tsx("div",
{class:"esri-feature__loading-container",key:"loading-container"},x.tsx("span",{class:this.classes(g.legacyIcon.loadingIndicator,n.globalCss.rotating,"esri-feature__loading-spinner")}))}_destroyContentWidget(){const {_contentWidget:q}=this;q&&(q.viewModel=null,q.destroy());this._contentWidget=null}_setupExpressionWidget(){const {contentElementViewModel:q,contentElement:z}=this.viewModel,p=z?.type;this._destroyContentWidget();this._contentWidget=q?"fields"===p?new H({viewModel:q}):"media"===p?new F({viewModel:q}):
"text"===p?new Q({viewModel:q}):null:null;this.scheduleRender()}};b.__decorate([h.property({type:c})],y.prototype,"viewModel",void 0);return y=b.__decorate([J.subclass("esri.widgets.Feature.FeatureExpression")],y)})},"esri/widgets/Feature/FeatureFields":function(){define("../../chunks/tslib.es6 ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../Widget ./FeatureFields/FeatureFieldsViewModel ./support/FeatureElementInfo ../support/globalCss ../support/uriUtils ../support/widgetUtils ../support/decorators/messageBundle ../support/jsxFactory".split(" "),
function(b,k,h,y,w,C,J,K,Q,H,F,c,n,g,l){y=class extends K{constructor(x,q){super(x,q);this._featureElementInfo=null;this.viewModel=new Q;this.messagesURIUtils=this.messages=null}initialize(){this._featureElementInfo=new H;this.addHandles(k.watch(()=>[this.viewModel?.description,this.viewModel?.title],()=>this._setupFeatureElementInfo(),k.initial))}destroy(){this._featureElementInfo?.destroy()}get attributes(){return this.viewModel.attributes}set attributes(x){this.viewModel.attributes=x}get description(){return this.viewModel.description}set description(x){this.viewModel.description=
x}get expressionInfos(){return this.viewModel.expressionInfos}set expressionInfos(x){this.viewModel.expressionInfos=x}get fieldInfos(){return this.viewModel.fieldInfos}set fieldInfos(x){this.viewModel.fieldInfos=x}get title(){return this.viewModel.title}set title(x){this.viewModel.title=x}render(){return l.tsx("div",{class:"esri-feature-fields"},this._featureElementInfo?.render(),this._renderFields())}_renderFieldInfo(x,q){var {attributes:z}=this.viewModel;const p=x.fieldName,D=x.label||p;z=z?null==
z[p]?"":z[p]:"";x=!(!x.format||!x.format.dateFormat);z="number"!==typeof z||x?c.autoLink(this.messagesURIUtils,z):this._forceLTR(z);x={["esri-feature-fields__field-data--date"]:x};return l.tsx("tr",{key:`fields-element-info-row-${p}-${q}`},l.tsx("th",{class:"esri-feature-fields__field-header",innerHTML:D,key:`fields-element-info-row-header-${p}-${q}`}),l.tsx("td",{class:this.classes("esri-feature-fields__field-data",x),innerHTML:z,key:`fields-element-info-row-data-${p}-${q}`}))}_renderFields(){const {formattedFieldInfos:x}=
this.viewModel;return x?.length?l.tsx("table",{class:F.globalCss.table,summary:this.messages.fieldsSummary},l.tsx("tbody",null,x.map((q,z)=>this._renderFieldInfo(q,z)))):null}_setupFeatureElementInfo(){const {description:x,title:q}=this;this._featureElementInfo?.set({description:x,title:q})}_forceLTR(x){return`&lrm;${x}`}};b.__decorate([h.property()],y.prototype,"attributes",null);b.__decorate([h.property()],y.prototype,"description",null);b.__decorate([h.property()],y.prototype,"expressionInfos",
null);b.__decorate([h.property()],y.prototype,"fieldInfos",null);b.__decorate([h.property()],y.prototype,"title",null);b.__decorate([h.property({type:Q,nonNullable:!0})],y.prototype,"viewModel",void 0);b.__decorate([h.property(),g.messageBundle("esri/widgets/Feature/t9n/Feature")],y.prototype,"messages",void 0);b.__decorate([h.property(),g.messageBundle("esri/widgets/support/t9n/uriUtils")],y.prototype,"messagesURIUtils",void 0);return y=b.__decorate([J.subclass("esri.widgets.Feature.FeatureFields")],
y)})},"esri/widgets/Feature/FeatureFields/FeatureFieldsViewModel":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../../popup/ExpressionInfo ../../../popup/FieldInfo ../support/featureUtils".split(" "),function(b,k,h,y,w,C,J,K,Q,H){k=class extends k{constructor(F){super(F);this.title=this.fieldInfos=this.description=
this.expressionInfos=this.attributes=null}get formattedFieldInfos(){const {expressionInfos:F,fieldInfos:c}=this,n=[];c?.forEach(g=>{if(!g.hasOwnProperty("visible")||g.visible)g=g.clone(),g.label=H.getFieldInfoLabel(g,F),n.push(g)});return n}};b.__decorate([h.property()],k.prototype,"attributes",void 0);b.__decorate([h.property({type:[K]})],k.prototype,"expressionInfos",void 0);b.__decorate([h.property()],k.prototype,"description",void 0);b.__decorate([h.property({type:[Q]})],k.prototype,"fieldInfos",
void 0);b.__decorate([h.property({readOnly:!0})],k.prototype,"formattedFieldInfos",null);b.__decorate([h.property()],k.prototype,"title",void 0);return k=b.__decorate([J.subclass("esri.widgets.Feature.FeatureFields.FeatureFieldsViewModel")],k)})},"esri/widgets/support/uriUtils":function(){define(["exports","../../core/string"],function(b,k){const h=[{pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,target:"_blank",label:"{messages.view}"},{pattern:/^\s*(tel:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(mailto:([^\s]+))\s*$/i,
label:"{hierPart}"},{pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"App Studio Player"},{pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Collector"},{pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Explorer"},{pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Navigator"},{pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",
appName:"Survey123"},{pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Trek2There"},{pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Workforce"},{pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"iForm"},{pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"FlowFinity"},{pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Laserfische"},
{pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Microsoft Power Bi"}];b.autoLink=function(y,w){if("string"!==typeof w||!w)return w;const C=h.find(K=>K.pattern.test(w));if(!C)return w;const J=w.match(C.pattern);y=k.replace(k.replace(C.label,{messages:y,hierPart:J&&J[2]}),{appName:C.appName});return w.replace(C.pattern,`<a${C.target?` target="${C.target}"`:""} href="$1"${"_blank"===C.target?' rel\x3d"noreferrer"':""}>${y}</a>`)};Object.defineProperty(b,Symbol.toStringTag,
{value:"Module"})})},"esri/widgets/Feature/FeatureMedia":function(){define("require ../../chunks/tslib.es6 ../../intl ../../core/a11yUtils ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../renderers/support/utils ../Widget ./FeatureMedia/FeatureMediaViewModel ./support/FeatureElementInfo ./support/featureUtils ../../chunks/componentsUtils ../support/widgetUtils ../support/decorators/messageBundle ../support/jsxFactory ../../support/themeUtils ../../intl/substitute".split(" "),
function(b,k,h,y,w,C,J,K,Q,H,F,c,n,g,l,x,q,z,p,D,v){h=class extends c{constructor(e,d){super(e,d);this._featureElementInfo=this._refreshIntervalInfo=this._refreshTimer=null;this._chartRootMap=new WeakMap;this.viewModel=new n;this.messages=null;this._disposeChart=a=>{this._chartRootMap.get(a)?.dispose();this._chartRootMap.delete(a)};this._createChart=async a=>{const {destroyed:m,viewModel:A}=this;if(!m&&A&&a){var {createRoot:I}=await new Promise((O,S)=>b(["../support/chartUtilsAm5"],O,S));I=await I(a);
this._chartRootMap.set(a,I);this._renderChart({mediaInfo:A.activeMediaInfo,root:I})}}}initialize(){this._featureElementInfo=new g;this.addHandles([w.watch(()=>[this.viewModel?.activeMediaInfo,this.viewModel?.activeMediaInfoIndex],()=>this._setupMediaRefreshTimer(),w.initial),w.watch(()=>[this.viewModel?.description,this.viewModel?.title],()=>this._setupFeatureElementInfo(),w.initial)])}loadDependencies(){return x.loadCalciteComponents({icon:()=>new Promise((e,d)=>b(["../../chunks/calcite-icon"],e,
d))})}destroy(){this._clearMediaRefreshTimer();this._featureElementInfo?.destroy()}get attributes(){return this.viewModel.attributes}set attributes(e){this.viewModel.attributes=e}get activeMediaInfoIndex(){return this.viewModel.activeMediaInfoIndex}set activeMediaInfoIndex(e){this.viewModel.activeMediaInfoIndex=e}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get fieldInfoMap(){return this.viewModel.fieldInfoMap}set fieldInfoMap(e){this.viewModel.fieldInfoMap=
e}get layer(){return this.viewModel.layer}set layer(e){this.viewModel.layer=e}get mediaInfos(){return this.viewModel.mediaInfos}set mediaInfos(e){this.viewModel.mediaInfos=e}get popupTemplate(){return this.viewModel.popupTemplate}set popupTemplate(e){this.viewModel.popupTemplate=e}get relatedInfos(){return this.viewModel.relatedInfos}set relatedInfos(e){this.viewModel.relatedInfos=e}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}render(){return p.tsx("div",{bind:this,
class:"esri-feature-media",onkeyup:this._handleMediaKeyup},this._featureElementInfo?.render(),this._renderMedia())}_renderMedia(){const {formattedMediaInfoCount:e,activeMediaInfoIndex:d}=this.viewModel,a=this._renderMediaText();return e?p.tsx("div",{class:"esri-feature-media__container",key:"media-element-container"},this._renderMediaInfo(),p.tsx("div",{class:"esri-feature-media__item-navigation"},a,1<e?p.tsx("div",{class:"esri-feature-media__pagination"},this._renderMediaPageButton("previous"),p.tsx("span",
{class:"esri-feature-media__pagination-text"},v.substitute(this.messages.pageText,{index:d+1,total:e})),this._renderMediaPageButton("next")):null)):null}_renderMediaText(){var {activeMediaInfo:e}=this.viewModel;if(!e)return null;const d=e&&e.title?p.tsx("div",{class:"esri-feature-media__item-title",innerHTML:e.title,key:"media-title"}):null;e=e&&e.caption?p.tsx("div",{class:"esri-feature-media__item-caption",innerHTML:e.caption,key:"media-caption"}):null;return d||e?p.tsx("div",{class:"esri-feature-media__item-text",
key:"media-text"},d,e):null}_renderImageMediaInfo(e){var {_refreshIntervalInfo:d}=this;const {activeMediaInfoIndex:a,formattedMediaInfoCount:m}=this.viewModel,{value:A,refreshInterval:I,altText:O,title:S,type:f}=e,{sourceURL:B,linkURL:G}=A;e=l.shouldOpenInNewTab(G??void 0)?"_blank":"_self";const u="_blank"===e?"noreferrer":"";d=I?d:null;d=p.tsx("img",{alt:O||S,key:`media-${f}-${a}-${m}-${d?d.timestamp:0}`,src:(d?d.sourceURL:B)??void 0});return(G?p.tsx("a",{href:G,rel:u,target:e,title:S},d):null)??
d}_renderChartMediaInfo(e){const {activeMediaInfoIndex:d,formattedMediaInfoCount:a}=this.viewModel;return p.tsx("div",{afterCreate:this._createChart,afterRemoved:this._disposeChart,bind:this,class:"esri-feature-media__chart",key:`media-${e.type}-${d}-${a}`})}_renderMediaInfoType(){const {activeMediaInfo:e}=this.viewModel;return e?"image"===e.type?this._renderImageMediaInfo(e):e.type.includes("chart")?this._renderChartMediaInfo(e):null:null}_renderMediaInfo(){const {activeMediaInfo:e}=this.viewModel;
return e?p.tsx("div",{class:"esri-feature-media__item-container",key:"media-container"},p.tsx("div",{class:"esri-feature-media__item",key:"media-item-container"},this._renderMediaInfoType())):null}_renderMediaPageButton(e){if(2>this.viewModel.formattedMediaInfoCount)return null;const d=(e="previous"===e)?this.messages.previous:this.messages.next;return p.tsx("button",{"aria-label":d,bind:this,class:"esri-feature-media__pagination-button",key:e?"media-previous":"media-next",onclick:e?this._previous:
this._next,tabIndex:0,title:d,type:"button"},p.tsx("calcite-icon",{class:"esri-feature-media__pagination-icon",icon:e?"chevron-left":"chevron-right",scale:"s"}))}_setupFeatureElementInfo(){const {description:e,title:d}=this;this._featureElementInfo?.set({description:e,title:d})}_next(){this.viewModel.next()}_previous(){this.viewModel.previous()}_getRenderer(){if(this.viewModel){var {isAggregate:e,layer:d}=this.viewModel;return e&&d?.featureReduction&&"renderer"in d.featureReduction?d.featureReduction.renderer:
d?.renderer}}async _getSeriesColors(e){const {colorAm5:d}=await new Promise((m,A)=>b(["./FeatureMedia/chartCommon"],m,A)),a=new Map;e.forEach(m=>{m.color&&a.set(m,d(m.color.toCss(!0)))});return a}async _getRendererColors(){const {colorAm5:e}=await new Promise((A,I)=>b(["./FeatureMedia/chartCommon"],A,I)),d=new Map,a=this._getRenderer();if(!a)return d;const m=await F.getColorsFromRenderer(a);m.delete("default");if(!Array.from(m.values()).every(A=>1===A?.length))return d;Array.from(m.keys()).forEach(A=>
{const I=m.get(A)?.[0]?.toCss(!0);I&&d.set(A,e(I))});return d}_handleMediaKeyup(e){const {key:d}=e;"ArrowLeft"===d&&(e.stopPropagation(),this.viewModel.previous());"ArrowRight"===d&&(e.stopPropagation(),this.viewModel.next())}_canAnimateChart(){return this.viewModel?!!this.viewModel.abilities.chartAnimation&&!y.prefersReducedMotion():!1}_getChartAnimationMS(){return this._canAnimateChart()?250:0}_getChartSeriesAnimationMS(){return this._canAnimateChart()?500:0}async _renderChart(e){const {root:d,
mediaInfo:a}=e,{value:m,type:A}=a,{ResponsiveThemeAm5:I,DarkThemeAm5:O,AnimatedThemeAm5:S,ColorSetAm5:f,ThemeAm5:B,esriChartColorSet:G}=await new Promise((P,U)=>b(["./FeatureMedia/chartCommon"],P,U));var u=B.new(d);u.rule("ColorSet").set("colors",G);u.rule("ColorSet").set("reuse",!0);u=[I.new(d),u];D.isDarkTheme()&&u.push(O.new(d));this._canAnimateChart()&&u.push(S.new(d));d.setThemes(u);const N=await this._getRendererColors(),t=await this._getSeriesColors(m.series),r=f.new(d,{}),E=(u=t.get(m.series[0]))?
{lineSettings:{stroke:u}}:void 0;u=m.series.map((P,U)=>{U=t.get(P)||N.get(P.fieldName)||r.getIndex(U);return{category:P.tooltip,value:P.value,columnSettings:{fill:U,stroke:U},...E}}).filter(P=>"pie-chart"===A?null!=P.value&&0<P.value:!0);"pie-chart"===A?this._createPieChart(e,u):this._createXYChart(e,u)}_getDirection(){return q.isRTL(this.container)?"rtl":"ltr"}_isInversed(){return!!q.isRTL(this.container)}async _customizeChartTooltip(e,d="horizontal"){const {colorAm5:a}=await new Promise((m,A)=>
b(["./FeatureMedia/chartCommon"],m,A));e.setAll({pointerOrientation:d});e.get("background")?.setAll({stroke:a("rgba(50, 50, 50, 1)")});e.label.setAll({direction:this._getDirection(),oversizedBehavior:"wrap",maxWidth:200})}async _createPieChart(e,d){var {TooltipAm5:a}=await new Promise((f,B)=>b(["./FeatureMedia/chartCommon"],f,B));const {PieChartAm5:m,PieSeriesAm5:A}=await new Promise((f,B)=>b(["./FeatureMedia/pieChart"],f,B)),{mediaInfo:I,root:O}=e;var {title:S}=I;e=O.container.children.push(m.new(O,
{ariaLabel:I?.altText||I?.title||"",focusable:!0,paddingBottom:5,paddingTop:5,paddingLeft:5,paddingRight:5}));a=a.new(O,{labelText:"{category}: {valuePercentTotal.formatNumber('0.00')}%\n ({value})"});S=e.series.push(A.new(O,{name:S,valueField:"value",categoryField:"category",tooltip:a}));S.ticks.template.set("forceHidden",!0);S.labels.template.set("forceHidden",!0);S.slices.template.states.create("active",{shiftRadius:5});this._customizeChartTooltip(a);S.slices.template.setAll({ariaLabel:"{category}: {valuePercentTotal.formatNumber('0.00')}%\n ({value})",
focusable:!0,templateField:"columnSettings"});S.data.setAll(d);S.appear(this._getChartSeriesAnimationMS());e.appear(this._getChartAnimationMS());e.root.dom.classList.toggle("esri-feature-media__chart--rendered",!0)}_getMinSeriesValue(e){let d=0;e.forEach(a=>d=Math.min(a.value,d));return d}async _createColumnChart(e,d,a){const {TooltipAm5:m,ScrollbarAm5:A}=await new Promise((P,U)=>b(["./FeatureMedia/chartCommon"],P,U)),{CategoryAxisAm5:I,AxisRendererXAm5:O,ValueAxisAm5:S,AxisRendererYAm5:f,ColumnSeriesAm5:B}=
await new Promise((P,U)=>b(["./FeatureMedia/xyChart"],P,U)),{mediaInfo:G,root:u}=d,{value:N,title:t}=G;e.setAll({wheelX:"panX",wheelY:"zoomX"});d=e.xAxes.push(I.new(u,{renderer:O.new(u,{inversed:this._isInversed()}),categoryField:"category"}));d.get("renderer").labels.template.setAll({forceHidden:!0});var r=e.yAxes.push(S.new(u,{renderer:f.new(u,{inside:!1}),min:this._getMinSeriesValue(N.series)}));r.get("renderer").labels.template.setAll({direction:this._getDirection()});const E=m.new(u,{labelText:"{categoryX}"});
r=e.series.push(B.new(u,{name:t,xAxis:d,yAxis:r,valueYField:"value",categoryXField:"category",tooltip:E}));this._customizeChartTooltip(E);r.columns.template.setAll({ariaLabel:"{categoryX}",focusable:!0,templateField:"columnSettings"});15<N.series.length&&e.set("scrollbarX",A.new(u,{orientation:"horizontal"}));d.data.setAll(a);r.data.setAll(a);r.appear(this._getChartSeriesAnimationMS());e.appear(this._getChartAnimationMS())}async _createBarChart(e,d,a){const {TooltipAm5:m,ScrollbarAm5:A}=await new Promise((P,
U)=>b(["./FeatureMedia/chartCommon"],P,U)),{CategoryAxisAm5:I,AxisRendererXAm5:O,ValueAxisAm5:S,AxisRendererYAm5:f,ColumnSeriesAm5:B}=await new Promise((P,U)=>b(["./FeatureMedia/xyChart"],P,U)),{mediaInfo:G,root:u}=d,{value:N,title:t}=G;e.setAll({wheelX:"panY",wheelY:"zoomY"});d=e.yAxes.push(I.new(u,{renderer:f.new(u,{inversed:!0}),categoryField:"category"}));d.get("renderer").labels.template.setAll({forceHidden:!0});var r=e.xAxes.push(S.new(u,{renderer:O.new(u,{inside:!1,inversed:this._isInversed()}),
min:this._getMinSeriesValue(N.series)}));r.get("renderer").labels.template.setAll({direction:this._getDirection()});const E=m.new(u,{labelText:"{categoryY}"});r=e.series.push(B.new(u,{name:t,xAxis:r,yAxis:d,valueXField:"value",categoryYField:"category",tooltip:E}));this._customizeChartTooltip(E,"vertical");r.columns.template.setAll({ariaLabel:"{categoryY}",focusable:!0,templateField:"columnSettings"});15<N.series.length&&e.set("scrollbarY",A.new(u,{orientation:"vertical"}));d.data.setAll(a);r.data.setAll(a);
r.appear(this._getChartSeriesAnimationMS());e.appear(this._getChartAnimationMS())}async _createLineChart(e,d,a){const {TooltipAm5:m,ScrollbarAm5:A}=await new Promise((U,W)=>b(["./FeatureMedia/chartCommon"],U,W)),{CategoryAxisAm5:I,AxisRendererXAm5:O,ValueAxisAm5:S,AxisRendererYAm5:f,LineSeriesAm5:B}=await new Promise((U,W)=>b(["./FeatureMedia/xyChart"],U,W)),{root:G,mediaInfo:u}=d,{value:N,title:t}=u;e.setAll({wheelX:"panX",wheelY:"zoomX"});d=e.xAxes.push(I.new(G,{renderer:O.new(G,{inversed:this._isInversed()}),
categoryField:"category"}));d.get("renderer").labels.template.setAll({forceHidden:!0});var r=e.yAxes.push(S.new(G,{renderer:f.new(G,{inside:!1}),min:this._getMinSeriesValue(N.series)}));r.get("renderer").labels.template.setAll({direction:this._getDirection()});const E=a[0]?.lineSettings?.stroke,P=m.new(G,{getFillFromSprite:!E,labelText:"{categoryX}"});E&&P.get("background")?.setAll({fill:E});r=e.series.push(B.new(G,{name:t,xAxis:d,yAxis:r,valueYField:"value",categoryXField:"category",tooltip:P}));
r.strokes.template.setAll({templateField:"lineSettings"});this._customizeChartTooltip(P,"vertical");15<N.series.length&&e.set("scrollbarX",A.new(G,{orientation:"horizontal"}));d.data.setAll(a);r.data.setAll(a);r.appear(this._getChartSeriesAnimationMS());e.appear(this._getChartAnimationMS())}async _createXYChart(e,d){const {XYChartAm5:a,XYCursorAm5:m}=await new Promise((f,B)=>b(["./FeatureMedia/xyChart"],f,B)),{root:A,mediaInfo:I}=e,{type:O}=I,S=A.container.children.push(a.new(A,{ariaLabel:I?.altText||
I?.title||"",focusable:!0,panX:!0,panY:!0}));S.set("cursor",m.new(A,{}));"column-chart"===O&&await this._createColumnChart(S,e,d);"bar-chart"===O&&await this._createBarChart(S,e,d);"line-chart"===O&&await this._createLineChart(S,e,d);S.root.dom.classList.toggle("esri-feature-media__chart--rendered",!0)}_clearMediaRefreshTimer(){const {_refreshTimer:e}=this;e&&(clearTimeout(e),this._refreshTimer=null)}_updateMediaInfoTimestamp(e){const d=Date.now();this._refreshIntervalInfo={timestamp:d,sourceURL:e&&
this._getImageSource(e,d)}}_setupMediaRefreshTimer(){this._clearMediaRefreshTimer();const {activeMediaInfo:e}=this.viewModel;e&&"image"===e.type&&e.refreshInterval&&this._setRefreshTimeout(e)}_setRefreshTimeout(e){const {refreshInterval:d,value:a}=e;d&&(e=6E4*d,this._updateMediaInfoTimestamp(a.sourceURL),this._refreshTimer=setInterval(()=>{this._updateMediaInfoTimestamp(a.sourceURL)},e))}_getImageSource(e,d){const a=e.includes("?")?"\x26":"?",[m,A=""]=e.split("#");return`${m}${a}timestamp=${d}${A?
"#":""}${A}`}};k.__decorate([C.property()],h.prototype,"_refreshIntervalInfo",void 0);k.__decorate([C.property()],h.prototype,"attributes",null);k.__decorate([C.property()],h.prototype,"activeMediaInfoIndex",null);k.__decorate([C.property()],h.prototype,"description",null);k.__decorate([C.property()],h.prototype,"fieldInfoMap",null);k.__decorate([C.property()],h.prototype,"layer",null);k.__decorate([C.property()],h.prototype,"mediaInfos",null);k.__decorate([C.property()],h.prototype,"popupTemplate",
null);k.__decorate([C.property()],h.prototype,"relatedInfos",null);k.__decorate([C.property()],h.prototype,"title",null);k.__decorate([C.property({type:n})],h.prototype,"viewModel",void 0);k.__decorate([C.property(),z.messageBundle("esri/widgets/Feature/t9n/Feature")],h.prototype,"messages",void 0);return h=k.__decorate([H.subclass("esri.widgets.Feature.FeatureMedia")],h)})},"esri/core/a11yUtils":function(){define(["exports"],function(b){b.prefersReducedMotion=()=>window.matchMedia("(prefers-reduced-motion: reduce)").matches;
Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/utils":function(){define("exports ../../core/arrayUtils ../../core/Logger ../../core/MapUtils ../../intl/date ../../layers/support/fieldUtils ./numberUtils ../visualVariables/support/ColorStop ../../smartMapping/support/utils ../../symbols/support/utils ../../widgets/Legend/support/colorRampUtils ../../widgets/Legend/support/heatmapRampUtils".split(" "),function(b,k,h,y,w,C,J,K,Q,H,F,c){async function n(D,v,e){y.getOrCreateMapValue(D,
v,()=>[]).push(...e)}async function g(D,v,e){D=y.getOrCreateMapValue(D,v,()=>new Map);for(const d of e)D.set(d.value,d.color)}function l(D){let v=D.minValue,e=D.maxValue;const d=D.isFirstBreak?"":q.gt+" ";D="percent-of-total"===D.normalizationType?q.pct:"";v=null==v?"":J.format(v);e=null==e?"":J.format(e);return d+v+D+" "+q.ld+" "+e+D}function x(D,v){return"normalizationField"in D&&D.normalizationField?{type:"normalized-field",field:D.field,normalizationField:D.normalizationField}:"field"in D&&D.field?
{type:"field",field:D.field}:"valueExpression"in D&&D.valueExpression?{type:"expression",expression:D.valueExpression,title:D.valueExpressionTitle,returnType:v}:null}const q={lte:"\x3c\x3d",gte:"\x3e\x3d",lt:"\x3c",gt:"\x3e",pct:"%",ld:"\u2013"},z={millisecond:0,second:1,minute:2,hour:3,day:4,month:5,year:6},p=w.convertDateFormatToIntlOptions("short-date");b.calculateDateFormatInterval=function(D){D=D.map(m=>new Date(m));const v=D.length;let e=Infinity,d=null;for(let m=0;m<v-1;m++){const A=D[m];let I=
Infinity,O=null;for(let S=m+1;S<v;S++){var a=D[S];a=A.getFullYear()!==a.getFullYear()&&"year"||A.getMonth()!==a.getMonth()&&"month"||A.getDate()!==a.getDate()&&"day"||A.getHours()!==a.getHours()&&"hour"||A.getMinutes()!==a.getMinutes()&&"minute"||A.getSeconds()!==a.getSeconds()&&"second"||"millisecond";const f=z[a];f<I&&(I=f,O=a)}I<e&&(e=I,d=O)}return d};b.createClassBreakLabel=l;b.createColorStops=function(D){const {values:v,colors:e,labelIndexes:d,isDate:a}=D;return v.map((m,A)=>{var I=null;if(!d||
d.includes(A)){const O=a?w.formatDate(m):J.format(m);O&&(I="",0===A?I=q.lt+" ":A===v.length-1&&(I=q.gt+" "),I+=O)}return new K({value:m,color:e[A],label:I})})};b.createUniqueValueLabel=function(D){const {value:v,domain:e,fieldInfo:d,dateFormatOptions:a}=D;D=String(v);const m=e&&"codedValues"in e&&e.codedValues?e.getName(v):null;m?D=m:null!=v&&d&&(Q.isAnyDateField(d)||C.isTimeOnlyField(d))?D=Q.formatAnyDate(v,a??{fieldType:d.type}):"number"===typeof v&&(D=J.format(v));return D};b.dateFormatIntervalOptions=
{millisecond:"long-month-day-year-long-time",second:"long-month-day-year-long-time",minute:"long-month-day-year-short-time",hour:"long-month-day-year-short-time",day:"long-month-day-year",month:"long-month-day-year",year:"year"};b.getAttribute=x;b.getAttributes=function(D,v){const e=[];if("class-breaks"===D.type||"heatmap"===D.type)e.push(x(D,"number"));else if("unique-value"===D.type){var d=D.authoringInfo;if(d&&"relationship"===d.type){if(d.field1&&d.field2){var a=d.field2.field;const m=d.field2.normalizationField;
e.push(x({field:d.field1.field,normalizationField:d.field1.normalizationField}));e.push(x({field:a,normalizationField:m}))}}else a=D.uniqueValueInfos?.[0],d=null,a?.value&&(a=typeof a.value,"string"===a||"number"===a)&&(d=a),e.push(x(D,d)),[D.field2,D.field3].forEach(m=>m&&e.push({type:"field",field:m}))}else"attributes"in D&&D.attributes?.forEach(m=>e.push(x(m,"number")));(D=v?v(D):"visualVariables"in D?D.visualVariables:null)&&D.forEach(m=>e.push(x(m,"number")));return k.unique(e.filter(k.isSome),
(m,A)=>"field"===m.type&&"field"===A.type?m.field===A.field:"normalized-field"===m.type&&"normalized-field"===A.type?m.field===A.field&&m.normalizationField===A.normalizationField:"expression"===m.type&&"expression"===A.type?m.expression===A.expression:!1)};b.getColorsForRendererValues=async function(D){const v=new Map;if(!D)return v;if("unique-value"!==D.type||D.authoringInfo?.type)if("class-breaks"===D.type){var e=D.classBreakInfos.map(m=>({value:m.minValue,color:H.getColorFromSymbol(m.symbol,null)})).reverse();
const {field:d,valueExpression:a}=D;await g(v,d??a,e)}else"simple"===D.type&&await g(v,"default",[{value:"default",color:H.getColorFromSymbol(D.symbol,null)}]);else{e=(D.uniqueValueInfos??[]).map(S=>({value:S.value,color:H.getColorFromSymbol(S.symbol,null)}));const {field:d,field2:a,field3:m,valueExpression:A,fieldDelimiter:I}=D,O=[d,a,m].filter(Boolean).join(I||"");(O||A)&&await g(v,O||A,e)}"defaultSymbol"in D&&D.defaultSymbol&&await g(v,"default",[{value:"default",color:H.getColorFromSymbol(D.defaultSymbol,
null)}]);if("visualVariables"in D&&D.visualVariables){D=D.visualVariables.filter(d=>"color"===d.type);for(const d of D)D=await F.getRampStops(d)??[],await g(v,d.field||d.valueExpression,D)}return v};b.getColorsFromRenderer=async function(D){const v=new Map;if(!D)return v;if("visualVariables"in D&&D.visualVariables){var e=D.visualVariables.filter(a=>"color"===a.type);for(var d of e)e=(await F.getRampStops(d)??[]).map(a=>a.color),await n(v,d.field||d.valueExpression,e)}if("heatmap"===D.type)d=c.getHeatmapRampStops(D).map(a=>
a.color),await n(v,D.field||D.valueExpression,d);else if("pie-chart"===D.type){for(const a of D.attributes)await n(v,a.field||a.valueExpression,[a.color]);await n(v,"default",[D?.othersCategory?.color,H.getColorFromSymbol(D.backgroundFillSymbol,null)])}else if("dot-density"===D.type){for(const a of D.attributes)await n(v,a.field||a.valueExpression,[a.color]);await n(v,"default",[D.backgroundColor])}else if("unique-value"===D.type)if("predominance"===D.authoringInfo?.type)for(const a of D.uniqueValueInfos??
[])await n(v,a.value.toString(),[H.getColorFromSymbol(a.symbol,null)]);else{d=(D.uniqueValueInfos??[]).map(O=>H.getColorFromSymbol(O.symbol,null));const {field:a,field2:m,field3:A,valueExpression:I}=D;(a||I)&&await n(v,a||I,d);m&&await n(v,m,d);A&&await n(v,A,d)}else if("class-breaks"===D.type){d=D.classBreakInfos.map(A=>H.getColorFromSymbol(A.symbol,null));const {field:a,valueExpression:m}=D;await n(v,a??m,d)}else"simple"===D.type&&await n(v,"default",[H.getColorFromSymbol(D.symbol,null)]);"defaultSymbol"in
D&&D.defaultSymbol&&await n(v,"default",[H.getColorFromSymbol(D.defaultSymbol,null)]);v.forEach((a,m)=>{a=k.unique(a.filter(Boolean),(A,I)=>JSON.stringify(A)===JSON.stringify(I));v.set(m,a)});return v};b.setLabelsForClassBreaks=function(D){const v=D.classBreakInfos,e=D.normalizationType;let d=[];if(v?.length)if("standard-deviation"===D.classificationMethod)h.getLogger("esri.renderers.support.utils").warn("setLabelsForClassBreaks","cannot set labels for class breaks generated using 'standard-deviation' method.");
else if(D.round){d.push(v[0].minValue);for(const a of v)d.push(a.maxValue);d=J.round(d);v.forEach((a,m)=>{a.label=l({minValue:0===m?d[0]:d[m],maxValue:d[m+1],isFirstBreak:0===m,normalizationType:e})})}else v.forEach((a,m)=>{a.label=l({minValue:a.minValue,maxValue:a.maxValue,isFirstBreak:0===m,normalizationType:e})})};b.timelineDateFormatOptions=p;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/numberUtils":function(){define(["exports","../../intl","../../intl/number"],
function(b,k,h){function y(F,c){return F-c}function w(F,c){let n;n=Number(F.toFixed(c));n<F?F=n+1/10**c:(F=n,n-=1/10**c);n=Number(n.toFixed(c));F=Number(F.toFixed(c));return[n,F]}function C(F,c,n,g,l){F=K(F,c,n,g);c=null==F.next||F.next<=l;return(null==F.previous||F.previous<=l)&&c||F.previous+F.next<=2*l}function J(F){F=String(F);var c=F.match(Q);if(c&&c[1])return{integer:c[1].split("").length,fractional:c[3]?c[3].split("").length:0};if(F.toLowerCase().includes("e")&&(c=F.split("e"),F=c[0],c=c[1],
F&&c)){F=Number(F);c=Number(c);const n=0<c;n||(c=Math.abs(c));F=J(F);n?(F.integer+=c,F.fractional=c>F.fractional?0:F.fractional-c):(F.fractional+=c,F.integer=c>F.integer?1:F.integer-c);return F}return{integer:0,fractional:0}}function K(F,c,n,g){const l={previous:null,next:null};if(null!=n){const x=F-n;l.previous=Math.floor(Math.abs(100*(c-n-x)/x))}null!=g&&(F=g-F,l.next=Math.floor(Math.abs(100*(g-c-F)/F)));return l}const Q=/^-?(\d+)(\.(\d+))?$/i,H={maximumFractionDigits:20};b.format=function(F){return h.formatNumber(F,
H)};b.numDigits=J;b.percentChange=K;b.round=function(F,c={}){F=F.slice(0);const {tolerance:n=2,strictBounds:g=!1,indexes:l=F.map((q,z)=>z)}=c;l.sort(y);for(c=0;c<l.length;c++){const q=l[c],z=F[q],p=0===q?null:F[q-1],D=q===F.length-1?null:F[q+1],v=J(z).fractional;if(v){let e=0,d=!1;for(var x=void 0;e<=v&&!d;)x=w(z,e),x=g&&0===c?x[1]:x[0],d=C(z,x,p,D,n),e++;d&&(F[q]=x)}}return F};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/utils":function(){define("require exports ../../Color ../../symbols ../../core/asyncUtils ../../core/has ../../core/screenUtils ../../core/libs/gl-matrix-2/factories/vec3f64 ../../layers/effects/jsonUtils ./cimSymbolUtils ./gfxUtils ./Symbol3DMaterial".split(" "),
function(b,k,h,y,w,C,J,K,Q,H,F,c){function n(a){a=a.symbolLayers;if(!a)return null;let m=null;a.forEach(A=>{"object"===A.type&&A.resource?.href||(m="water"===A.type?A.color:A.material?A.material.color:null)});return m?new h(m):null}function g(a,m){if(null==m||null==a)return a;a=a.toRgba();a[3]*=m;return new h(a)}function l(a,m,A){if(a=a.symbolLayers){var I=O=>{m=m??O??(null!=A?d:null);return g(m,A)};a.forEach(O=>{if("object"!==O.type||!O.resource?.href||m)if("water"===O.type)O.color=I(O.color);else{const S=
I(null!=O.material?O.material.color:null);null==O.material?O.material=new c.Symbol3DMaterial({color:S}):O.material.color=S;null!=A&&"outline"in O&&null!=O.outline?.color&&(O.outline.color=g(O.outline.color,A))}})}}async function x(a,m){(a=a.symbolLayers)&&await w.forEach(a,async A=>q(A,m))}async function q(a,m){switch(a.type){case "extrude":a.size="number"===typeof m[2]?m[2]:0;break;case "icon":case "line":case "text":m=z(m);null!=m&&(a.size=m);break;case "path":const A=D(m,K.ONES,[a.width,void 0,
a.height]);a.width=e(m[0],a.width,1,A);a.height=e(m[2],a.height,1,A);break;case "object":await p(a,m)}}function z(a){for(const m of a)if("number"===typeof m)return m;return null}async function p(a,m){const {resourceSize:A,symbolSize:I}=await v(a),O=D(m,A,I);a.width=e(m[0],I[0],A[0],O);a.depth=e(m[1],I[1],A[1],O);a.height=e(m[2],I[2],A[2],O)}function D(a,m,A){for(let I=0;3>I;I++){const O=a[I];switch(O){case "symbol-value":return a=A[I],null!=a?a/m[I]:1;case "proportional":break;default:if(O&&m[I])return O/
m[I]}}return 1}async function v(a){var {computeObjectLayerResourceSize:m}=await new Promise((B,G)=>b(["./symbolLayerUtils"],B,G));m=await m(a,10);const {width:A,height:I,depth:O}=a;a=[A,O,I];let S=1;for(var f=0;3>f;f++){const B=a[f];if(null!=B){S=B/m[f];break}}for(f=0;3>f;f++)null==a[f]&&(a[f]=m[f]*S);return{resourceSize:m,symbolSize:a}}function e(a,m,A,I){switch(a){case "proportional":return A*I;case "symbol-value":return null!=m?m:A;default:return a}}const d=new h("white");k.applyColorToSymbol=
function(a,m,A){if(a&&(m||null!=A))if(m&&=new h(m),y.isSymbol3D(a))l(a,m,A);else if(y.isSymbol2D(a)){if(m=m??a.color)a.color=g(m,A);null!=A&&"outline"in a&&a.outline?.color&&(a.outline.color=g(a.outline.color,A))}};k.applyOpacityToColor=g;k.applyRotationToSymbol=function(a,m,A){a&&null!=m&&(y.isSymbol3D(a)?(a=a.symbolLayers)&&a.forEach(I=>{if(I&&"object"===I.type)switch(A){case "tilt":I.tilt=(I.tilt??0)+m;break;case "roll":I.roll=(I.roll??0)+m;break;default:I.heading=(I.heading??0)+m}}):!y.isSymbol2D(a)||
"simple-marker"!==a.type&&"picture-marker"!==a.type&&"text"!==a.type||(a.angle+=m))};k.applySizesToSymbol=async function(a,m){if(a&&m){if(y.isSymbol3D(a))return x(a,m);if(y.isSymbol2D(a)&&(m=z(m),null!=m))switch(a.type){case "simple-marker":a.size=m;break;case "picture-marker":const A=a.width/a.height;1<A?(a.width=m,a.height=m*A):(a.width=m*A,a.height=m);break;case "simple-line":a.width=m;break;case "text":a.font.size=m}}};k.fetchWebStyleSymbol=async function(a,m){const A=await a.fetchSymbol(m);return A?
A:a.fetchCIMSymbol(m)};k.getCSSFilterFromEffectList=function(a){if(!a)return null;a=a.effects.filter(m=>"bloom"!==m.type).map(m=>m.toJSON());return Q.effectFunctionsFromJSON(a)};k.getColorFromSymbol=function(a,m){if(!a)return null;let A=null;y.isSymbol3D(a)?A=n(a):y.isSymbol2D(a)&&(A="cim"===a.type?H.getCIMSymbolColor(a):a.color?new h(a.color):null);return A?g(A,m):null};k.getIconHref=function(a){return a.resource?.href??""};k.getSymbolOutlineSize=function(a){return a?y.isSymbol3D(a)?(a=(a=a.symbolLayers?.at(-1))&&
"outline"in a?a?.outline?.size:void 0,null!=a?a:0):J.px2pt(F.getStroke(a)?.width):0};k.isVolumetricSymbol=function(a){if(null==a||!("symbolLayers"in a)||null==a.symbolLayers)return!1;switch(a.type){case "point-3d":return a.symbolLayers.some(m=>"object"===m.type);case "line-3d":return a.symbolLayers.some(m=>"path"===m.type);case "polygon-3d":return a.symbolLayers.some(m=>"object"===m.type||"extrude"===m.type);default:return!1}};k.symbolHasExtrudeSymbolLayer=function(a){return null!=a&&"polygon-3d"===
a.type&&a.symbolLayers.some(m=>"extrude"===m.type)};Object.defineProperty(k,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/cimSymbolUtils":function(){define(["exports","../../Color","../cim/utils"],function(b,k,h){function y(c){c=h.toCIMSymbolJSON(c);if("CIMTextSymbol"===c?.type)return c.height??0;let n=0;if(c?.symbolLayers)for(const g of c.symbolLayers)h.isCIMMarker(g)&&null!=g.size&&g.size>n?n=g.size:h.isCIMStroke(g)&&null!=g.width&&g.width>n?n=g.width:h.isCIMFill(g);return n}function w(c,
n,g,l){if(c)if("CIMTextSymbol"===c.type)null!=c.height&&(c.height*=n);else{if(g&&c.effects)for(const x of c.effects)K(x,n);if(c.symbolLayers)for(const x of c.symbolLayers)switch(x.type){case "CIMPictureMarker":case "CIMVectorMarker":C(x,n,l);break;case "CIMPictureStroke":case "CIMSolidStroke":!l?.preserveOutlineWidth&&x.width&&(x.width*=n);break;case "CIMPictureFill":x.height&&(x.height*=n);x.offsetX&&(x.offsetX*=n);x.offsetY&&(x.offsetY*=n);break;case "CIMHatchFill":w(x.lineSymbol,n,!0,{...l,preserveOutlineWidth:!1}),
x.offsetX&&(x.offsetX*=n),x.offsetY&&(x.offsetY*=n),x.separation&&(x.separation*=n)}}}function C(c,n,g){if(c&&(c.markerPlacement&&J(c.markerPlacement,n),c.offsetX&&(c.offsetX*=n),c.offsetY&&(c.offsetY*=n),c.anchorPoint&&"Absolute"===c.anchorPointUnits&&(c.anchorPoint={x:c.anchorPoint.x*n,y:c.anchorPoint.y*n}),c.size=null!=c.size?c.size*n:0,"CIMVectorMarker"===c.type&&c.markerGraphics))for(const l of c.markerGraphics)c.scaleSymbolsProportionally||w(l.symbol,n,!0,g)}function J(c,n){h.isCIMMarkerStrokePlacement(c)&&
c.offset&&(c.offset*=n);switch(c.type){case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineSameSize":c.customEndingOffset&&(c.customEndingOffset*=n);c.offsetAlongLine&&(c.offsetAlongLine*=n);if(c.placementTemplate&&c.placementTemplate.length){var g=c.placementTemplate.map(l=>l*n);c.placementTemplate=g}break;case "CIMMarkerPlacementAlongLineVariableSize":c.maxRandomOffset&&(c.maxRandomOffset*=n);c.placementTemplate&&c.placementTemplate.length&&(g=c.placementTemplate.map(l=>
l*n),c.placementTemplate=g);break;case "CIMMarkerPlacementOnLine":c.startPointOffset&&(c.startPointOffset*=n);break;case "CIMMarkerPlacementAtExtremities":c.offsetAlongLine&&(c.offsetAlongLine*=n);break;case "CIMMarkerPlacementAtRatioPositions":c.beginPosition&&(c.beginPosition*=n);c.endPosition&&(c.endPosition*=n);break;case "CIMMarkerPlacementPolygonCenter":c.offsetX&&(c.offsetX*=n);c.offsetY&&(c.offsetY*=n);break;case "CIMMarkerPlacementInsidePolygon":c.offsetX&&(c.offsetX*=n),c.offsetY&&(c.offsetY*=
n),c.stepX&&(c.stepX*=n),c.stepY&&(c.stepY*=n)}}function K(c,n){switch(c.type){case "CIMGeometricEffectArrow":case "CIMGeometricEffectDonut":c.width&&(c.width*=n);break;case "CIMGeometricEffectBuffer":c.size&&(c.size*=n);break;case "CIMGeometricEffectCut":c.beginCut&&(c.beginCut*=n);c.endCut&&(c.endCut*=n);c.middleCut&&(c.middleCut*=n);break;case "CIMGeometricEffectDashes":c.customEndingOffset&&(c.customEndingOffset*=n);c.offsetAlongLine&&(c.offsetAlongLine*=n);if(c.dashTemplate&&c.dashTemplate.length){const g=
c.dashTemplate.map(l=>l*n);c.dashTemplate=g}break;case "CIMGeometricEffectExtension":case "CIMGeometricEffectJog":case "CIMGeometricEffectRadial":c.length&&(c.length*=n);break;case "CIMGeometricEffectMove":c.offsetX&&(c.offsetX*=n);c.offsetY&&(c.offsetY*=n);break;case "CIMGeometricEffectOffset":case "CIMGeometricEffectOffsetTangent":c.offset&&(c.offset*=n);break;case "CIMGeometricEffectRegularPolygon":c.radius&&(c.radius*=n);break;case "CIMGeometricEffectTaperedPolygon":c.fromWidth&&(c.fromWidth*=
n);c.length&&(c.length*=n);c.toWidth&&(c.toWidth*=n);break;case "CIMGeometricEffectWave":c.amplitude&&(c.amplitude*=n),c.period&&(c.period*=n)}}function Q(c,n){if(c){var g="CIMTextSymbol"===c.type?c.symbol:c;c="CIMPolygonSymbol"===c.type;if(g?.symbolLayers)for(const l of g.symbolLayers)if(!(l.colorLocked||c&&(h.isCIMStroke(l)||h.isCIMMarker(l)&&l.markerPlacement&&h.isCIMMarkerStrokePlacement(l.markerPlacement))))switch(l.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":l.tintColor&&
H(n,l.tintColor);break;case "CIMVectorMarker":l.markerGraphics?.forEach(x=>{Q(x.symbol,n)});break;case "CIMSolidStroke":case "CIMSolidFill":H(n,l.color);break;case "CIMHatchFill":Q(l.lineSymbol,n)}}}function H(c,n){for(const g of c)if(g.join(".")===n.join("."))return;c.push(n)}function F(c,n,g){if(c){var l="CIMTextSymbol"===c.type?c.symbol:c;c="CIMPolygonSymbol"===l?.type;if(l?.symbolLayers)for(const x of l.symbolLayers)if(!x.colorLocked){if(c)if(g){if({layersToColor:l}=g,(h.isCIMStroke(x)||h.isCIMMarker(x)&&
x.markerPlacement&&h.isCIMMarkerStrokePlacement(x.markerPlacement))&&"fill"===l||h.isCIMFill(x)&&"outline"===l)continue}else if(h.isCIMStroke(x)||h.isCIMMarker(x)&&x.markerPlacement&&h.isCIMMarkerStrokePlacement(x.markerPlacement))continue;l=n.toArray();switch(x.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":x.tintColor=l;break;case "CIMVectorMarker":x.markerGraphics?.forEach(q=>{F(q.symbol,n,g)});break;case "CIMSolidStroke":case "CIMSolidFill":x.color=l;break;case "CIMHatchFill":F(x.lineSymbol,
n,g)}}}}b.applyCIMSymbolColor=function(c,n,g){n instanceof k||(n=new k(n));(c=h.toCIMSymbolJSON(c))&&F(c,n,g)};b.applyCIMSymbolRotation=function(c,n,g=!1){c=h.toCIMSymbolJSON(c);g&&0!==n&&(n=360-n);if("CIMTextSymbol"===c?.type)c.angle=n;else if("CIMPointSymbol"===c?.type&&c.symbolLayers){g=n-(c.angle||0);for(const l of c.symbolLayers)if(h.isCIMMarker(l)){let x=l.rotation||0;x=l.rotateClockwise?x-g:x+g;l.rotation=x}c.angle=n}};b.getCIMSymbolColor=function(c){c=h.toCIMSymbolJSON(c);const n=[];Q(c,n);
return n.length?new k(h.normalizeAlpha(n[0])):null};b.getCIMSymbolRotation=function(c,n=!1){c=h.toCIMSymbolJSON(c);return"CIMTextSymbol"===c?.type||"CIMPointSymbol"===c?.type?(c=c.angle,null!=c&&0!==c&&n?360-c:c??0):0};b.getCIMSymbolSize=y;b.getCIMSymbolType=function(c){c=h.toCIMSymbolJSON(c);if(!c)return null;switch(c.type){case "CIMPointSymbol":return"CIMPointSymbol";case "CIMLineSymbol":return"CIMLineSymbol";case "CIMPolygonSymbol":return"CIMPolygonSymbol";case "CIMTextSymbol":return"CIMTextSymbol";
case "CIMMeshSymbol":return"CIMMeshSymbol";default:return null}};b.scaleCIMMarker=C;b.scaleCIMSymbol=w;b.scaleCIMSymbolTo=function(c,n,g){if(c){var l=h.toCIMSymbolJSON(c);c=y(c);if(0===c){if(l)if("CIMTextSymbol"===l.type)l.height=n;else if(l.symbolLayers)for(const x of l.symbolLayers)switch(x.type){case "CIMPictureMarker":case "CIMVectorMarker":x.size=n;break;case "CIMPictureStroke":case "CIMSolidStroke":x.width=n}}else w(l,n/c,!1,g)}};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},
"esri/symbols/support/gfxUtils":function(){define("exports ../../assets ../../Color ../../request ../../core/LRUCache ../../core/screenUtils ./cimSymbolUtils".split(" "),function(b,k,h,y,w,C,J){function K(n){if(!n)return null;let g=null;switch(n.type){case "simple-fill":case "picture-fill":case "simple-marker":g=K(n.outline);break;case "simple-line":const l=C.pt2px(n.width);null!=n.style&&"none"!==n.style&&0!==l&&(g={color:n.color,style:c(n.style),width:l,cap:n.cap,join:"miter"===n.join?C.pt2px(n.miterLimit):
n.join},g.dashArray=Q(g).join(",")||"none");break;default:g=null}return g}function Q(n){if(!n?.style)return[];const {dashArray:g,style:l,width:x}=n;if("string"===typeof g&&"none"!==g)return g.split(",").map(p=>Number(p));const q=x??0,z=H.has(l)?H.get(l).map(p=>p*q):[];if("butt"!==n.cap)for(const [p,D]of z.entries())z[p]=1===p%2?D+q:Math.max(D-q,1);return z}const H=new Map([["dash",[4,3]],["dashdot",[4,3,1,3]],["dot",[1,3]],["longdash",[8,3]],["longdashdot",[8,3,1,3]],["longdashdotdot",[8,3,1,3,1,
3]],["shortdash",[4,1]],["shortdashdot",[4,1,1,1]],["shortdashdotdot",[4,1,1,1,1,1]],["shortdot",[1,1]],["solid",[]]]),F=new w.LRUCache(1E3),c=(()=>{const n={};return g=>{if(n[g])return n[g];const l=g.replaceAll("-","");return n[g]=l}})();h=new h([128,128,128]);b.defaultThematicColor=h;b.dekebabifyLineStyle=c;b.getDashArray=Q;b.getFill=function(n){const g=n.style;let l=null;if(n)switch(n.type){case "simple-marker":"cross"!==g&&"x"!==g&&(l=n.color);break;case "simple-fill":g&&"solid"!==g?"none"!==
g&&(l={type:"pattern",x:0,y:0,src:k.getAssetUrl(`esri/symbols/patterns/${g}.png`),width:5,height:5}):l=n.color;break;case "picture-fill":l={type:"pattern",src:n.url,width:C.pt2px(n.width)*n.xscale,height:C.pt2px(n.height)*n.yscale,x:C.pt2px(n.xoffset),y:C.pt2px(n.yoffset)};break;case "text":l=n.color;break;case "cim":l=J.getCIMSymbolColor(n)}return l};b.getPatternUrlWithColor=function(n,g){const l=n+"-"+g;return void 0!==F.get(l)?Promise.resolve(F.get(l)):y(n,{responseType:"image"}).then(x=>{x=x.data;
const q=x.naturalWidth,z=x.naturalHeight,p=document.createElement("canvas");p.width=q;p.height=z;const D=p.getContext("2d");D.fillStyle=g;D.fillRect(0,0,q,z);D.globalCompositeOperation="destination-in";D.drawImage(x,0,0);x=p.toDataURL();F.put(l,x);return x})};b.getStroke=K;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/colorRampUtils":function(){define(["require","exports","../../../Color","./utils"],function(b,k,h,y){function w(H,F){const c=[],n=H.length-
1;5===H.length?c.push(0,2,4):c.push(0,n);return H.map((g,l)=>c.includes(l)?y.createStopLabel(g,l,n,F):null)}async function C(H,F,c){c=new h(c??Q);H=(await new Promise((n,g)=>b(["../../../renderers/visualVariables/support/visualVariableUtils"],n,g))).getOpacity(F,H);null!=H&&(c.a=H);return c}function J(H,F){const {startIndex:c,endIndex:n,weight:g}=K(H,F);if(c===n)return F[c].color;H=h.blendColors(F[c].color,F[n].color,g);return new h(H)}function K(H,F){let c=0,n=F.length-1;F.some((g,l)=>{if(H<g.value)return n=
l,!0;c=l;return!1});return{startIndex:c,endIndex:n,weight:(H-F[c].value)/(F[n].value-F[c].value)}}const Q=new h([64,64,64]);k.getColorFromPointCloudStops=J;k.getRampStops=async function(H,F,c){let n=!1,g=[],l=[];if(H.stops){var x=H.stops;g=x.map(z=>z.value);(n=x.some(z=>!!z.label))&&(l=x.map(z=>z.label))}x=g[g.length-1];if(null==g[0]&&null==x)return null;const q=n?null:w(g,c);return(await Promise.all(g.map(async(z,p)=>{const D="opacity"===H.type?await C(z,H,F):(await new Promise((v,e)=>b(["../../../renderers/visualVariables/support/visualVariableUtils"],
v,e))).getColor(H,z);return{value:z,color:D,label:n?l[p]:q?.[p]??""}}))).reverse()};k.getRampStopsForPointCloud=function(H){let F=!1,c=[],n=[];c=H.map(x=>x.value);(F=H.some(x=>!!x.label))&&(n=H.map(x=>x.label??""));const g=c[c.length-1];if(null==c[0]&&null==g)return null;const l=F?null:w(c);return c.map((x,q)=>{const z=J(x,H);return{value:x,color:z,label:F?n[q]:l?.[q]??""}}).reverse()};k.getStretchRampStops=function(H,F){let c=[];if(H&&"multipart"===H.type)H.colorRamps.reverse().forEach((n,g)=>{0===
g?c.push({value:F.max,color:new h(n.toColor),label:"high"}):c.push({value:null,color:new h(n.toColor),label:""});g===H.colorRamps.length-1?c.push({value:F.min,color:new h(n.fromColor),label:"low"}):c.push({value:null,color:new h(n.fromColor),label:""})});else{let n,g;H&&"algorithmic"===H.type?(n=H.fromColor,g=H.toColor):(n=[0,0,0,1],g=[255,255,255,1]);c=[{value:F.max,color:new h(g),label:"high"},{value:F.min,color:new h(n),label:"low"}]}return c};Object.defineProperty(k,Symbol.toStringTag,{value:"Module"})})},
"esri/widgets/Legend/support/utils":function(){define("require exports ../../../symbols ../../../core/timeUtils ../../../layers/support/fieldUtils ../../../renderers/support/numberUtils ../../../smartMapping/support/utils ../../../symbols/SimpleLineSymbol".split(" "),function(b,k,h,y,w,C,J,K){async function Q(c){if(!("visualVariables"in c&&c.visualVariables))return null;c=c.visualVariables.find(l=>"color"===l.type);if(!c)return null;var n=null,g=null;if(c.stops){if(1===c.stops.length)return c.stops[0].color;
n=c.stops[0].value;g=c.stops[c.stops.length-1].value}n=null!=n&&null!=g?n+(g-n)/2:0;({getColor:g}=await new Promise((l,x)=>b(["../../../renderers/visualVariables/support/visualVariableUtils"],l,x)));return g(c,n)??null}function H(c,n){if(!n.field)return null;if("featureReduction"in c)switch(c.featureReduction?.type){case "cluster":case "binning":const g=c.featureReduction.fields.find(({name:l})=>l.toLowerCase()===n.field.toLowerCase());return g&&"getField"in c?c.getField(g.onStatisticField):null}return"getField"in
c?c.getField?.(n.field):null}function F(c,n){c="popupTemplate"in c?c.popupTemplate?.fieldInfos:null;if(c?.length&&n)return c.find(g=>g.fieldName?.toLowerCase()===n.toLowerCase())?.format?.dateFormat}k.createStopLabel=function(c,n,g,l){let x="";0===n?x="\x3c ":n===g&&(x="\x3e ");c=l?J.formatAnyDate(c,l):C.format(c);return x+c};k.getDateFormatOptions=function(c,n,g){const l=H(c,n);if(!l||!J.isAnyDateField(l)&&!w.isTimeOnlyField(l))return null;var x=F(c,l.name);if(!x&&"date"===l.type){let q=x=0;n.stops?
(x=n.stops?.at(0)?.value??x,q=n.stops?.at(-1)?.value??q):"minDataValue"in n&&"maxDataValue"in n&&(x=n.minDataValue??x,q=n.maxDataValue??q);x=q-x>2*y.millisecondsPerTimeUnit.days?"short-date":"short-date-short-time"}return{fieldType:l.type,format:x,timeZoneOptions:{layerTimeZone:"preferredTimeZone"in c?c.preferredTimeZone:null,viewTimeZone:g,datesInUnknownTimezone:"datesInUnknownTimezone"in c&&c.datesInUnknownTimezone}}};k.getMedianColor=Q;k.getSymbolForFlowRenderer=async function(c,n){const g=c.trailCap,
l=c.trailWidth||1;c=n||await Q(c)||c.color;return new K({cap:g,color:c,width:l})};k.isRasterBandStatistics=function(c){return null!=c&&"object"===typeof c&&"min"in c&&"max"in c};k.rgbImgSource=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII\x3d","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII\x3d",
"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII\x3d"];k.specialCharsGreaterThan="\x3e";k.specialCharsLessThan="\x3c";Object.defineProperty(k,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/heatmapRampUtils":function(){define(["exports","../../../renderers/support/HeatmapColorStop"],function(b,k){b.getHeatmapRampStops=function(h){if(!h.colorStops)return[];
const y=[...h.colorStops].filter(C=>0<C.color?.a);let w=y.length-1;if(y&&y[0]){const C=y[w];C&&1!==C.ratio&&(y.push(new k({ratio:1,color:C.color})),w++)}return y.map((C,J)=>{let K="";0===J?K=h.legendOptions?.minLabel||"low":J===w&&(K=h.legendOptions?.maxLabel||"high");return{color:C.color,label:K,ratio:C.ratio}}).reverse()};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/FeatureMedia/FeatureMediaViewModel":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/arrayUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/cast ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../popup/FieldInfo ../../../popup/content/support/ChartMediaInfoValueSeries ../support/featureUtils ../support/relatedFeatureUtils".split(" "),
function(b,k,h,y,w,C,J,K,Q,H,F){const c={chartAnimation:!0};k=class extends k{constructor(n){super(n);this.abilities={...c};this.activeMediaInfoIndex=0;this.expressionAttributes=this.formattedAttributes=this.fieldInfoMap=this.description=this.attributes=null;this.isAggregate=!1;this.title=this.relatedInfos=this.popupTemplate=this.mediaInfos=this.layer=null}castAbilities(n){return{...c,...n}}get activeMediaInfo(){return this.formattedMediaInfos[this.activeMediaInfoIndex]||null}get formattedMediaInfos(){return this._formatMediaInfos()||
[]}get formattedMediaInfoCount(){return this.formattedMediaInfos.length}setActiveMedia(n){this._setContentElementMedia(n)}next(){this._pageContentElementMedia(1)}previous(){this._pageContentElementMedia(-1)}_setContentElementMedia(n){const {formattedMediaInfoCount:g}=this;this.activeMediaInfoIndex=(n+g)%g}_pageContentElementMedia(n){const {activeMediaInfoIndex:g}=this;this._setContentElementMedia(g+n)}_formatMediaInfos(){const {mediaInfos:n,layer:g}=this,l=this.attributes??{},x=this.formattedAttributes??
{},q=this.expressionAttributes??{},z=this.fieldInfoMap??new Map;return n?.map(p=>{p=p?.clone();if(!p)return null;p.title=H.substituteFieldsInLinksAndAttributes({attributes:l,fieldInfoMap:z,globalAttributes:x,expressionAttributes:q,layer:g,text:p.title});p.caption=H.substituteFieldsInLinksAndAttributes({attributes:l,fieldInfoMap:z,globalAttributes:x,expressionAttributes:q,layer:g,text:p.caption});p.altText=H.substituteFieldsInLinksAndAttributes({attributes:l,fieldInfoMap:z,globalAttributes:x,expressionAttributes:q,
layer:g,text:p.altText});if("image"===p.type){var {value:D}=p;this._setImageValue({value:D,formattedAttributes:x,layer:g});return p.value.sourceURL?p:void 0}return"pie-chart"===p.type||"line-chart"===p.type||"column-chart"===p.type||"bar-chart"===p.type?({value:D}=p,this._setChartValue({value:D,chartType:p.type,attributes:l,formattedAttributes:x,layer:g,expressionAttributes:q}),p):null}).filter(h.isSome)??[]}_setImageValue(n){const g=this.fieldInfoMap??new Map,{value:l,formattedAttributes:x,layer:q}=
n,{linkURL:z,sourceURL:p}=l;p&&(n=H.fixTokens(p,q),l.sourceURL=H.substituteAttributes({formattedAttributes:x,template:n,fieldInfoMap:g}));z&&(n=H.fixTokens(z,q),l.linkURL=H.substituteAttributes({formattedAttributes:x,template:n,fieldInfoMap:g}))}_setChartValue(n){const {value:g,attributes:l,formattedAttributes:x,chartType:q,layer:z,expressionAttributes:p}=n,{popupTemplate:D,relatedInfos:v}=this,{fields:e,normalizeField:d}=g;g.fields=H.getFixedFieldNames(e,z);d&&(g.normalizeField=H.getFixedFieldName(d,
z));if(e.some(m=>!!(null!=x[m]||H.isRelatedField(m)&&v?.size))){var a=D?.fieldInfos??[];e.forEach((m,A)=>{A=g.colors?.[A];H.isRelatedField(m)?g.series=[...g.series,...this._getRelatedChartInfos({fieldInfos:a,fieldName:m,formattedAttributes:x,chartType:q,value:g,color:A})]:(m=this._getChartOption({value:g,attributes:l,chartType:q,formattedAttributes:x,expressionAttributes:p,fieldName:m,fieldInfos:a,color:A}),g.series.push(m))})}}_getRelatedChartInfos(n){const {fieldInfos:g,fieldName:l,formattedAttributes:x,
chartType:q,value:z,color:p}=n,D=[],v=F.getRelatedFieldInfo(l);n=v&&this.relatedInfos?.get(v.layerId.toString());if(!n)return D;const {relatedFeatures:e,relation:d}=n;if(!d||!e)return D;({cardinality:n}=d);e.forEach(a=>{const {attributes:m}=a;m&&Object.keys(m).forEach(A=>{A===v.fieldName&&D.push(this._getChartOption({value:z,attributes:m,formattedAttributes:x,fieldName:l,chartType:q,relatedFieldName:A,hasMultipleRelatedFeatures:1<e?.length,fieldInfos:g,color:p}))})});return"one-to-many"===n||"many-to-many"===
n?D:[D[0]]}_getTooltip({label:n,value:g,chartType:l}){return"pie-chart"===l?`${n}`:`${n}: ${g}`}_getChartOption(n){const {value:g,attributes:l,formattedAttributes:x,expressionAttributes:q,fieldName:z,relatedFieldName:p,fieldInfos:D,chartType:v,hasMultipleRelatedFeatures:e,color:d}=n;var a=this.layer,m=this.fieldInfoMap??new Map;const {normalizeField:A,tooltipField:I}=g;n=A?H.isRelatedField(A)?l[F.getRelatedFieldInfo(A).fieldName]:l[A]:null;var O=H.isExpressionField(z)&&q&&void 0!==q[z]?q[z]:p&&void 0!==
l[p]?l[p]:void 0!==l[z]?l[z]:x[z];n=new Q({fieldName:z,color:d,value:void 0===O?null:O&&n?O/n:O});if(H.isRelatedField(z))return a=m.get(z.toLowerCase()),O=I&&m.get(I.toLowerCase()),m=a?.fieldName??z,O=e&&I?F.getRelatedFieldInfo(I).fieldName:O?.fieldName??I,n.tooltip=this._getTooltip({label:e&&O?l[O]:x[O]??a?.label??a?.fieldName??p,value:e&&p?l[p]:x[m],chartType:v}),n;m=H.getFieldInfo(D,z);a=H.getFixedFieldName(z,a);m=I&&void 0!==x[I]?x[I]:H.getFieldInfoLabel(m||new K({fieldName:a}),this.popupTemplate?.expressionInfos);
n.tooltip=this._getTooltip({label:m,value:x[a],chartType:v});return n}};b.__decorate([y.property()],k.prototype,"abilities",void 0);b.__decorate([w.cast("abilities")],k.prototype,"castAbilities",null);b.__decorate([y.property()],k.prototype,"activeMediaInfoIndex",void 0);b.__decorate([y.property({readOnly:!0})],k.prototype,"activeMediaInfo",null);b.__decorate([y.property()],k.prototype,"attributes",void 0);b.__decorate([y.property()],k.prototype,"description",void 0);b.__decorate([y.property()],k.prototype,
"fieldInfoMap",void 0);b.__decorate([y.property()],k.prototype,"formattedAttributes",void 0);b.__decorate([y.property()],k.prototype,"expressionAttributes",void 0);b.__decorate([y.property({readOnly:!0})],k.prototype,"formattedMediaInfos",null);b.__decorate([y.property()],k.prototype,"isAggregate",void 0);b.__decorate([y.property()],k.prototype,"layer",void 0);b.__decorate([y.property({readOnly:!0})],k.prototype,"formattedMediaInfoCount",null);b.__decorate([y.property()],k.prototype,"mediaInfos",
void 0);b.__decorate([y.property()],k.prototype,"popupTemplate",void 0);b.__decorate([y.property()],k.prototype,"relatedInfos",void 0);b.__decorate([y.property()],k.prototype,"title",void 0);return k=b.__decorate([J.subclass("esri.widgets.Feature.FeatureMedia.FeatureMediaViewModel")],k)})},"esri/widgets/Feature/support/relatedFeatureUtils":function(){define("exports ../../../request ../../../core/arrayUtils ../../../core/Error ../../../core/Logger ../../../core/promiseUtils ../../../layers/support/fieldUtils ../../../core/has ../../../layers/support/source/DataLayerSource ../../../rest/query/executeQueryJSON ../../../config ../../../kernel ../../../core/urlUtils ../../../core/unitUtils ../../../geometry/ellipsoidUtils ../../../geometry/support/spatialReferenceUtils ../../../geometry/support/aaBoundingBox ../../../core/mathUtils ../../../geometry/Extent ../../../geometry/Geometry ../../../geometry/Multipoint ../../../geometry/Point ../../../geometry/Polygon ../../../geometry/Polyline ../../../geometry/support/normalizeUtilsCommon ../../../geometry/SpatialReference ../../../geometry/support/Ellipsoid ../../../geometry ../../../core/pbf ../../../rest/support/FeatureSet ../../../rest/support/Query ../../../rest/query/support/AttachmentInfo ../../../rest/support/AttachmentQuery ../../../rest/support/RelationshipQuery ../../../rest/support/TopFeaturesQuery ../../../rest/support/StatisticDefinition ./featureUtils".split(" "),
function(b,k,h,y,w,C,J,K,Q,H,F,c,n,g,l,x,q,z,p,D,v,e,d,a,m,A,I,O,S,f,B,G,u,N,t,r,E){function P(M,R){if(!R.relationships)return null;let T=null;({relationships:R}=R);R.some(V=>V.id===parseInt(M,10)?(T=V,!0):!1);return T}function U({originRelationship:M,relationships:R,layerId:T}){return R.find(({relatedTableId:V,id:X})=>`${V}`===T&&X===M?.id)??null}function W(M,R){R=R.toLowerCase();for(const T in M)if(T.toLowerCase()===R)return M[T];return null}function aa(M,R,T,V){const X=new N;X.outFields=["*"];
X.relationshipId="number"===typeof R.id?R.id:parseInt(R.id,10);X.objectIds=[M.attributes[T.objectIdField]];return T.queryRelatedFeatures?.(X,V)??Promise.resolve({})}function da(M,R,T){let V=0;const X=[];for(;V<R.length;)X.push(`${M} IN (${R.slice(V,T+V)})`),V+=T;return X.join(" OR ")}function Z(M){return M?h.unique(M):void 0}function fa(M){return M?h.unique(M,(R,T)=>JSON.stringify(R.toJSON())===JSON.stringify(T.toJSON())):void 0}async function Y(M,R,T,V){var X=T.layerId.toString();const {layerInfo:ca,
relation:ea,relatedFields:ha,outStatistics:ia,url:ja,sourceSpatialReference:ka}=R;R=Z(ha);const la=fa(ia);if(!ca||!ea)return null;X=U({originRelationship:ea,relationships:ca.relationships,layerId:X});if(X?.relationshipTableId&&X.keyFieldInRelationshipTable){T=(await aa(M,X,T,V))[M.attributes[T.objectIdField]];if(!T)return null;const na=T.features.map(ma=>ma.attributes[ca.objectIdField]);if(la?.length&&ca.supportsStatistics)return V=new B,V.where=da(ca.objectIdField,na,1E3),V.outFields=R,V.outStatistics=
la,V.sourceSpatialReference=ka,V={features:Promise.resolve(T),statsFeatures:H.executeQueryJSON(ja,V)},C.eachAlways(V)}return(T=X?.keyField)?(X=J.isNumericField(ba(ca.fields,T)),M=W(M.attributes,ea.keyField),T=X?`${T}=${M}`:`${T}='${M}'`,M=H.executeQueryJSON(ja,new B({where:T,outFields:R,sourceSpatialReference:ka}),V),V=la?.length&&ca.supportsStatistics?H.executeQueryJSON(ja,new B({where:T,outFields:R,outStatistics:la,sourceSpatialReference:ka}),V):null,R={features:M},V&&(R.statsFeatures=V),C.eachAlways(R)):
null}function ba(M,R){if(null!=M){R=R.toLowerCase();for(const T of M)if(T&&T.name.toLowerCase()===R)return T}return null}const L=new Map;b.createRelatedInfo=function(M,R){if(M=P(M,R))return{url:`${R.url}/${M.relatedTableId}`,sourceSpatialReference:R.spatialReference,relation:M,relatedFields:[],outStatistics:[]}};b.getDestinationRelation=U;b.getRelatedFieldInfo=function(M){if(!E.isRelatedField(M))return null;const [R,T]=M.split("/").slice(1);return{layerId:R,fieldName:T}};b.getUniqueOutFields=Z;b.getUniqueOutStatistics=
fa;b.queryLayerInfos=function({relatedInfos:M,layer:R},T){const V={};M.forEach((X,ca)=>{({relation:X}=X);if(!X)throw ca=new y("relation-required","A relation is required on a layer to retrieve related records."),w.getLogger("esri.widgets.Feature.support.relatedFeatureUtils").error(ca),ca;({relatedTableId:X}=X);if("number"!==typeof X)throw ca=new y("A related table ID is required on a layer to retrieve related records."),w.getLogger("esri.widgets.Feature.support.relatedFeatureUtils").error(ca),ca;
X=`${R.url}/${X}`;const ea=L.get(X),ha=ea??k(X,{query:{f:"json"},signal:(void 0)?.signal});ea||L.set(X,ha);V[ca]=ha});return C.whenOrAbort(C.eachAlways(V),T)};b.queryRelatedFeatures=function({graphic:M,relatedInfos:R,layer:T},V){const X={};R.forEach((ca,ea)=>{ca.layerInfo&&(X[ea]=Y(M,ca,T,V))});return C.eachAlways(X)};b.setRelatedFeatures=function(M,R){if(R&&M){var {features:T,statsFeatures:V}=M;M=T?.value;R.relatedFeatures=M?M.features:[];M=V?.value;R.relatedStatsFeatures=M?M.features:[]}};b.updateRelatedInfo=
function({relatedInfo:M,fieldName:R,fieldInfo:T}){M.relatedFields?.push(R);T.statisticType&&(R=new r({statisticType:T.statisticType,onStatisticField:R,outStatisticFieldName:R}),M.outStatistics?.push(R))};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/FeatureExpression/FeatureExpressionViewModel":function(){define("../../../chunks/tslib.es6 ../../../geometry ../../../Graphic ../../../core/Accessor ../../../core/reactiveUtils ../../../core/throttle ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../../popup/content/AttachmentsContent ../../../popup/content/Content ../../../popup/content/CustomContent ../../../popup/content/ExpressionContent ../../../popup/content/FieldsContent ../../../popup/content/MediaContent ../../../popup/content/RelationshipContent ../../../popup/content/TextContent ../../../popup/ElementExpressionInfo ../FeatureContent/FeatureContentViewModel ../FeatureFields/FeatureFieldsViewModel ../FeatureMedia/FeatureMediaViewModel ../support/arcadeFeatureUtils ../../../geometry/Point".split(" "),
function(b,k,h,y,w,C,J,K,Q,H,F,c,n,g,l,x,q,z,p,D,v,e,d,a,m){k=class extends y{constructor(A){super(A);this.view=this.location=this.interceptor=this.contentElementViewModel=this.contentElement=this.graphic=this.expressionInfo=this._abortController=null;this._cancelQuery=()=>{const {_abortController:I}=this;I&&I.abort();this._abortController=null};this._createVM=()=>{var I=this.contentElement?.type;this.contentElementViewModel?.destroy();I="fields"===I?new e:"media"===I?new d:"text"===I?new v:null;
this._set("contentElementViewModel",I)};this._compile=async()=>{this._cancelQuery();const I=new AbortController;this._abortController=I;await this._compileExpression();this._abortController===I&&(this._abortController=null)};this._compileThrottled=C.throttle(this._compile,1,this);this._compileExpression=async()=>{const {expressionInfo:I,graphic:O,interceptor:S,spatialReference:f,map:B,location:G,view:u,_abortController:N}=this;if(I&&O){var t=await a.loadArcade();if(N===this._abortController)if((t=
await a.createCompiledExpression({arcade:t,expressionInfo:I,graphic:O,location:G,interceptor:S,map:B,spatialReference:f,view:u}))&&"esri.arcade.Dictionary"===t.declaredClass){t=await t.castAsJsonAsync(N?.signal);var r=t?.type;t="media"===r?q.fromJSON(t):"text"===r?p.fromJSON(t):"fields"===r?x.fromJSON(t):null;this._set("contentElement",t)}else this._set("contentElement",null)}else this._set("contentElement",null)};this.addHandles([w.watch(()=>[this.expressionInfo,this.graphic,this.map,this.spatialReference,
this.view],()=>this._compileThrottled(),w.initial),w.watch(()=>[this.contentElement],()=>this._createVM(),w.initial)])}initialize(){this.addHandles(this._compileThrottled)}destroy(){this._cancelQuery();this.contentElementViewModel?.destroy();this._set("contentElementViewModel",null);this._set("contentElement",null)}get spatialReference(){return this.view?.spatialReference??null}set spatialReference(A){this._override("spatialReference",A)}get state(){const {_abortController:A,contentElement:I,contentElementViewModel:O}=
this;return A?"loading":I||O?"ready":"disabled"}get map(){return this.view?.map??null}set map(A){this._override("map",A)}};b.__decorate([J.property()],k.prototype,"_abortController",void 0);b.__decorate([J.property({type:D})],k.prototype,"expressionInfo",void 0);b.__decorate([J.property({type:h})],k.prototype,"graphic",void 0);b.__decorate([J.property({readOnly:!0})],k.prototype,"contentElement",void 0);b.__decorate([J.property({readOnly:!0})],k.prototype,"contentElementViewModel",void 0);b.__decorate([J.property()],
k.prototype,"interceptor",void 0);b.__decorate([J.property({type:m})],k.prototype,"location",void 0);b.__decorate([J.property()],k.prototype,"spatialReference",null);b.__decorate([J.property({readOnly:!0})],k.prototype,"state",null);b.__decorate([J.property()],k.prototype,"map",null);b.__decorate([J.property()],k.prototype,"view",void 0);return k=b.__decorate([F.subclass("esri.widgets.Feature.FeatureExpression.FeatureExpressionViewModel")],k)})},"esri/widgets/Feature/support/arcadeFeatureUtils":function(){define("require exports ../../../core/Logger ../../../core/promiseUtils ../../../layers/FeatureLayer ./featureUtils ../../support/globalCss".split(" "),
function(b,k,h,y,w,C,J){function K(g){return`<ul class="esri-widget__list">${g.map(l=>`<li>${"string"===typeof l?C.applyTextFormattingHTML(C.htmlEntities(l)):l}</li>`).join("")}</ul>`}function Q(g){const l=g.keys().map(x=>{var q=g.field(x);q="string"===typeof q?C.applyTextFormattingHTML(C.htmlEntities(q)):q;return`<tr><th>${x}</th><td>${q}</td></tr>`}).join("");return`<table class="${J.globalCss.table}">${l}</table>`}function H(){return new Promise((g,l)=>b(["../../../arcade"],g,l))}async function F({graphic:g,
view:l,options:x}){const {isAggregate:q,layer:z}=g;if(!q||!z||"2d"!==l?.type)return[];l=await l.whenLayerView(z);if(!("createQuery"in l&&"queryFeatures"in l))return[];const p=l.createQuery();g=g.getObjectId();p.aggregateIds=null!=g?[g]:[];({features:x}=await l.queryFeatures(p,x));return x}function c({layer:g,aggregatedFeatures:l,interceptor:x}){const {fields:q,objectIdField:z,geometryType:p,spatialReference:D,displayField:v}=g;return new w({fields:q,objectIdField:z,geometryType:p,spatialReference:D,
displayField:v,interceptor:x,...("feature"===g.type?{templates:g.templates,typeIdField:g.typeIdField,types:g.types}:null),source:l})}async function n({expressionInfo:g,arcade:l,interceptor:x,spatialReference:q,map:z,graphic:p,location:D,view:v,options:e}){if(!g?.expression)return null;var {isAggregate:d}=p;const a=(p.sourceLayer||p.layer)??void 0;d=d?"feature-reduction-popup":"popup";const m=l.createArcadeProfile(d);l=l.createArcadeExecutor(g.expression,m).catch(S=>h.getLogger("esri.widgets.Feature.support.arcadeFeatureUtils").error("arcade-executor-error",
{error:S,expressionInfo:g}));const [A,I]=await Promise.all([F({graphic:p,view:v,options:e}),l]);if(!I)return null;const O="feature-reduction-popup"===d?c({layer:a,aggregatedFeatures:A,interceptor:x}):void 0;return await I.executeAsync({...("feature-reduction-popup"===d?{$aggregatedFeatures:O}:{$datastore:a?.url,$layer:"feature"===a?.type||"subtype-sublayer"===a?.type?a:"scene"===a?.type&&null!=a.associatedLayer?a.associatedLayer:void 0,$map:z,$userInput:D,$graph:"knowledge-graph-sublayer"===a?.type?
a?.parentCompositeLayer?.knowledgeGraph:void 0}),$feature:p},{abortSignal:e?.signal??void 0,interceptor:x??void 0,rawOutput:!0,spatialReference:q??void 0,timeZone:v?.timeZone}).catch(S=>h.getLogger("esri.widgets.Feature.support.arcadeFeatureUtils").error("arcade-execution-error",{error:S,graphic:p,expressionInfo:g})).finally(()=>O?.destroy())}k.createCompiledExpression=n;k.createCompiledExpressions=async function({expressionInfos:g,spatialReference:l,graphic:x,interceptor:q,map:z,view:p,location:D,
options:v}){if(!g?.length)return{};const e=await H(),d={};for(const a of g)d[`expression/${a.name}`]=n({expressionInfo:a,arcade:e,interceptor:q,spatialReference:l,map:z,graphic:x,location:D,view:p,options:v});g=await y.eachAlways(d);l={};for(const a in g)x=g[a].value,x="string"===typeof x?C.applyTextFormattingHTML(C.htmlEntities(x)):Array.isArray(x)?K(x):"esri.arcade.Dictionary"===x?.declaredClass?Q(x):x,l[a]=x;return l};k.loadArcade=H;Object.defineProperty(k,Symbol.toStringTag,{value:"Module"})})},
"esri/widgets/Feature/FeatureRelationship":function(){define("require ../../chunks/tslib.es6 ../../intl ../../core/maybe ../../core/promiseUtils ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/RandomLCG ../../core/has ../../core/accessorSupport/decorators/subclass ../Widget ./FeatureRelationship/FeatureRelationshipViewModel ./support/FeatureElementInfo ../../chunks/componentsUtils ../support/globalCss ../support/legacyIcon ../support/widgetUtils ../support/decorators/messageBundle ../support/jsxFactory ../../intl/substitute".split(" "),
function(b,k,h,y,w,C,J,K,Q,H,F,c,n,g,l,x,q,z,p,D,v){const e={title:!0,description:!0};h=class extends c{constructor(d,a){super(d,a);this._relatedFeatureIntersectionObserverNode=this._featureElementInfo=null;this._relatedFeatureIntersectionObserver=new IntersectionObserver(([m])=>{m?.isIntersecting&&this._increaseFeaturePage()},{root:window.document});this.headingLevel=2;this.viewModel=new n;this.messagesCommon=this.messages=null;this.visibleElements={...e};this._increaseFeaturePage=()=>{const {state:m,
showAllEnabled:A,relatedFeatures:I,featuresPerPage:O,featurePage:S}=this.viewModel;"ready"===m&&A&&I.length>=O*S&&this.viewModel.featurePage++}}initialize(){this._featureElementInfo=new g;this.addHandles([C.watch(()=>[this.viewModel.description,this.viewModel.title,this.headingLevel],()=>this._setupFeatureElementInfo(),C.initial),C.watch(()=>[this.viewModel.state,this.viewModel.showAllEnabled,this._relatedFeatureIntersectionObserverNode],()=>this._handleRelatedFeatureObserverChange()),C.on(()=>this.viewModel.relatedFeatureViewModels,
"change",()=>this._setupRelatedFeatureViewModels())])}loadDependencies(){return l.loadCalciteComponents({icon:()=>new Promise((d,a)=>b(["../../chunks/calcite-icon"],d,a)),list:()=>new Promise((d,a)=>b(["../../chunks/calcite-list"],d,a)),"list-item":()=>new Promise((d,a)=>b(["../../chunks/calcite-list-item"],d,a)),notice:()=>new Promise((d,a)=>b(["../../chunks/calcite-notice"],d,a))})}destroy(){this._unobserveRelatedFeatureObserver();this._featureElementInfo=y.destroyMaybe(this._featureElementInfo)}get displayShowAllButton(){const {showAllEnabled:d,
featureCount:a,displayCount:m,state:A}=this.viewModel;return!d&&!!a&&"ready"===A&&(a>m||0===m)}get displayListItems(){return this.displayShowAllButton||0<this.viewModel.relatedFeatureViewModels.length}get description(){return this.viewModel.description}set description(d){this.viewModel.description=d}get featureCountDescription(){const {messages:d}=this,{featureCount:a}=this.viewModel;return v.substitute(d?.numberRecords,{number:a})}get title(){return this.viewModel.title}set title(d){this.viewModel.title=
d}castVisibleElements(d){return{...e,...d}}render(){const {state:d}=this.viewModel;return D.tsx("div",{class:this.classes("esri-feature-relationship",x.globalCss.widget)},this._featureElementInfo?.render(),"loading"===d?this._renderLoading():"disabled"===d?this._renderRelationshipNotFound():this._renderRelatedFeatures())}_renderStickyLoading(){return"querying"===this.viewModel.state?D.tsx("div",{class:"esri-feature__sticky-loading-container",key:"sticky-loader"},this._renderLoadingIcon()):null}_renderLoadingIcon(){return D.tsx("span",
{class:this.classes(q.legacyIcon.loadingIndicator,x.globalCss.rotating,"esri-feature__loading-spinner")})}_renderLoading(){return D.tsx("div",{class:"esri-feature__loading-container",key:"loading-container"},this._renderLoadingIcon())}_renderShowAllIconNode(){return D.tsx("calcite-icon",{icon:"list",scale:"s",slot:"content-end"})}_renderChevronIconNode(){const d=z.isRTL(this.container)?"chevron-left":"chevron-right";return D.tsx("calcite-icon",{icon:d,scale:"s",slot:"content-end"})}_renderRelatedFeature(d){const {itemDescriptionFieldName:a}=
this.viewModel,m=d.title;d.description=a&&d.formattedAttributes?.global[a];return D.tsx("calcite-list-item",{class:this.classes("esri-feature-relationship__list-item",{["esri-feature-relationship__list-item--hidden"]:"loading"===d.state}),description:d.description??"",key:d.uid,label:m,onCalciteListItemSelect:()=>this.emit("select-record",{featureViewModel:d})},this._renderChevronIconNode())}_renderShowAllListItem(){return this.displayShowAllButton?D.tsx("calcite-list-item",{description:this.featureCountDescription,
key:"show-all-item",label:this.messages?.showAll,onCalciteListItemSelect:()=>this.emit("show-all-records")},this._renderShowAllIconNode()):null}_renderNoRelatedFeaturesMessage(){return D.tsx("calcite-notice",{icon:"information",key:"no-related-features-message",kind:"brand",open:!0,scale:"s",width:"full"},D.tsx("div",{slot:"message"},this.messages?.noRelatedFeatures))}_renderFeatureObserver(){return D.tsx("div",{afterCreate:this._relatedFeatureIntersectionObserverCreated,bind:this,class:"esri-feature__feature-observer",
key:"feature-observer"})}_renderList(){const {relatedFeatureViewModels:d}=this.viewModel;return D.tsx("calcite-list",null,d.toArray().map(a=>this._renderRelatedFeature(a)),this._renderShowAllListItem())}_renderRelatedFeatures(){const {displayListItems:d}=this,{state:a}=this.viewModel;return D.tsx("div",{class:this.classes("esri-feature-relationship__list",{["esri-feature-relationship__list--querying"]:"querying"===a}),key:"list-container"},d?this._renderList():"ready"===a?this._renderNoRelatedFeaturesMessage():
null,this._renderStickyLoading(),this._renderFeatureObserver())}_renderRelationshipNotFound(){return D.tsx("calcite-notice",{icon:"exclamation-mark-triangle",key:"relationship-not-found",kind:"danger",open:!0,scale:"s",width:"full"},D.tsx("div",{slot:"message"},this.messages?.relationshipNotFound))}_setupRelatedFeatureViewModels(){const {relatedFeatureViewModels:d}=this.viewModel;this.removeHandles("related-feature-viewmodels");d?.forEach(a=>{this.addHandles(C.watch(()=>[a.title,a.state],()=>this.scheduleRender(),
C.initial),"related-feature-viewmodels")});this.scheduleRender()}_setupFeatureElementInfo(){const {headingLevel:d,visibleElements:a}=this,m=a.description&&this.description,A=a.title&&this.title;this._featureElementInfo?.set({description:m,title:A,headingLevel:d})}async _handleRelatedFeatureObserverChange(){this._unobserveRelatedFeatureObserver();const {state:d,showAllEnabled:a}=this.viewModel;await w.after(0);this._relatedFeatureIntersectionObserverNode&&"ready"===d&&a&&this._relatedFeatureIntersectionObserver.observe(this._relatedFeatureIntersectionObserverNode)}_relatedFeatureIntersectionObserverCreated(d){this._relatedFeatureIntersectionObserverNode=
d}_unobserveRelatedFeatureObserver(){this._relatedFeatureIntersectionObserverNode&&this._relatedFeatureIntersectionObserver.unobserve(this._relatedFeatureIntersectionObserverNode)}};k.__decorate([J.property()],h.prototype,"_relatedFeatureIntersectionObserverNode",void 0);k.__decorate([J.property({readOnly:!0})],h.prototype,"displayShowAllButton",null);k.__decorate([J.property({readOnly:!0})],h.prototype,"displayListItems",null);k.__decorate([J.property()],h.prototype,"description",null);k.__decorate([J.property({readOnly:!0})],
h.prototype,"featureCountDescription",null);k.__decorate([J.property()],h.prototype,"headingLevel",void 0);k.__decorate([J.property()],h.prototype,"title",null);k.__decorate([J.property({type:n})],h.prototype,"viewModel",void 0);k.__decorate([J.property(),p.messageBundle("esri/widgets/Feature/t9n/Feature")],h.prototype,"messages",void 0);k.__decorate([J.property(),p.messageBundle("esri/t9n/common")],h.prototype,"messagesCommon",void 0);k.__decorate([J.property()],h.prototype,"visibleElements",void 0);
k.__decorate([K.cast("visibleElements")],h.prototype,"castVisibleElements",null);return h=k.__decorate([F.subclass("esri.widgets.Feature.FeatureRelationship")],h)})},"esri/widgets/Feature/FeatureRelationship/FeatureRelationshipViewModel":function(){define("../../../chunks/tslib.es6 ../../../Graphic ../../../core/Accessor ../../../core/arrayUtils ../../../core/Clonable ../../../core/Collection ../../../core/Identifiable ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ../../../rest/support/RelationshipQuery ../support/featureUtils ../../FeatureForm/featureFormUtils".split(" "),
function(b,k,h,y,w,C,J,K,Q,H,F,c,n,g,l,x){h=class extends w.ClonableMixin(J.IdentifiableMixin(h)){constructor(q){super(q);this._loaded=!1;this._queryFeatureCountAbortController=this._queryPageAbortController=this._queryAbortController=null;this.featuresPerPage=10;this.orderByFields=this.map=this.layer=this.graphic=this.description=null;this.featureCount=0;this.relationshipId=null;this.showAllEnabled=!1;this.title=null;this._cancelQuery=()=>{const {_queryAbortController:z}=this;z&&z.abort();this._queryAbortController=
null};this._cancelQueryFeatureCount=()=>{const {_queryFeatureCountAbortController:z}=this;z&&z.abort();this._queryFeatureCountAbortController=null};this._cancelQueryPage=()=>{const {_queryPageAbortController:z}=this;z&&z.abort();this._queryPageAbortController=null};this._queryController=async()=>{this._cancelQuery();const z=new AbortController;this._queryAbortController=z;await K.ignoreAbortErrors(this._query());this._queryAbortController===z&&(this._queryAbortController=null)};this._queryFeatureCountController=
async()=>{this._loaded=!1;this._cancelQueryFeatureCount();const z=new AbortController;this._queryFeatureCountAbortController=z;await K.ignoreAbortErrors(this._queryFeatureCount());this._queryFeatureCountAbortController===z&&(this._queryFeatureCountAbortController=null);this._loaded=!0};this._queryPageController=async()=>{const z=new AbortController;this._queryPageAbortController=z;await K.ignoreAbortErrors(this._queryPage());this._queryPageAbortController===z&&(this._queryPageAbortController=null)};
this._queryDebounced=K.debounce(this._queryController,100);this._queryFeatureCountDebounced=K.debounce(this._queryFeatureCountController,100);this._queryPageDebounced=K.debounce(this._queryPageController,100);this._query=async()=>{const {_queryAbortController:z,relatedFeatures:p}=this;this.featureCount&&(this._destroyRelatedFeatureViewModels(),this.featurePage=1,p.removeAll(),this.destroyed||p.addMany(this._sliceFeatures(await this._queryRelatedFeatures({signal:z?.signal}))))};this.addHandles([Q.watch(()=>
[this.displayCount,this.graphic,this.layer,this.layer?.loaded,this.map,this.orderByFields,this.relationshipId,this.featuresPerPage,this.showAllEnabled,this.canQuery,this.featureCount],()=>this._queryDebounced(),Q.initial),Q.watch(()=>[this.featurePage,this.showAllEnabled],()=>this._queryPageDebounced()),Q.watch(()=>[this.layer,this.relationshipId,this.objectId,this.canQuery],()=>this._queryFeatureCountDebounced())])}destroy(){this._destroyRelatedFeatureViewModels();this.relatedFeatures.removeAll();
this._cancelQuery();this._cancelQueryFeatureCount();this._cancelQueryPage()}set featurePage(q){const {featuresPerPage:z,featureCount:p}=this;this._set("featurePage",Math.min(Math.max(q,1),Math.ceil(p/z)||1))}get featurePage(){return this._get("featurePage")}get orderByFieldsFixedCasing(){const {orderByFields:q,relatedLayer:z}=this;return q&&z?.loaded?q.map(p=>{const D=p.clone();D.field=l.getFixedFieldName(p.field,z);return D}):q??[]}get supportsCacheHint(){return!!this.layer?.capabilities?.queryRelated?.supportsCacheHint}get canLoad(){return!!this.map&&
"number"===typeof this.relationshipId&&"number"===typeof this.objectId}get canQuery(){const q=this.layer?.capabilities?.queryRelated;return!!this.relatedLayer&&!!this.relationship&&"number"===typeof this.relationshipId&&"number"===typeof this.objectId&&!!q?.supportsCount&&!!q?.supportsPagination}get itemDescriptionFieldName(){return this.orderByFieldsFixedCasing[0]?.field||null}set displayCount(q){this._set("displayCount",Math.min(Math.max(q,0),10))}get displayCount(){return this._get("displayCount")}get objectId(){return(this.objectIdField&&
this.graphic?.attributes?.[this.objectIdField])??null}get objectIdField(){return this.layer?.objectIdField||null}get relatedFeatures(){return this._get("relatedFeatures")||new C}get relatedLayer(){const {layer:q,map:z,relationship:p}=this;return q?.loaded&&z&&p?l.findRelatedLayer(z,q,p)??null:null}get relationship(){const {relationshipId:q,layer:z}=this;return"number"===typeof q?z?.relationships?.find(({id:p})=>p===q)??null:null}get relatedFeatureViewModels(){return this._get("relatedFeatureViewModels")||
new C}get state(){const {_queryAbortController:q,_queryFeatureCountAbortController:z,_queryPageAbortController:p,canQuery:D,_loaded:v,canLoad:e}=this;return z||e&&!v?"loading":q||p?"querying":D?"ready":"disabled"}getRelatedFeatureByObjectId(q){return this.relatedFeatures.find(z=>z.getObjectId()===q)}refresh(){this._queryFeatureCountDebounced()}_destroyRelatedFeatureViewModels(){this.relatedFeatureViewModels?.forEach(q=>!q.destroyed&&q.destroy());this.relatedFeatureViewModels.removeAll()}async _queryFeatureCount(){const {layer:q,
relatedLayer:z,relationshipId:p,objectId:D,_queryFeatureCountAbortController:v,canQuery:e,supportsCacheHint:d}=this;await q?.load();await z?.load();if(e&&q&&z){var a=z.createQuery();a=new g({cacheHint:d,relationshipId:p,returnGeometry:!1,objectIds:[D],where:a.where??void 0});a=await q.queryRelatedFeaturesCount(a,{signal:v?.signal});this._set("featureCount",a[D]||0)}else this._set("featureCount",0)}_sliceFeatures(q){const {showAllEnabled:z,displayCount:p}=this;return z?q:p?q.slice(0,p):[]}async _queryPage(){const {relatedFeatures:q,
featurePage:z,showAllEnabled:p,_queryPageAbortController:D,featureCount:v}=this;!p||2>z||!v||q.addMany(await this._queryRelatedFeatures({signal:D?.signal}))}async _queryRelatedFeatures(q){const {orderByFieldsFixedCasing:z,showAllEnabled:p,featuresPerPage:D,displayCount:v,layer:e,relationshipId:d,featurePage:a,featureCount:m,relatedLayer:A,supportsCacheHint:I}=this,{canQuery:O,objectId:S}=this;if(!O||!e||!A)return[];var f=p?((a-1)*D+m)%m:0;const B=p?D:v;var G=A.objectIdField;G=[...z.map(t=>t.field),
...x.getFieldsInTitleAndDesc(A),G].filter(y.isSome);const u=z.map(t=>`${t.field} ${t.order}`),N=A.createQuery();f=new g({orderByFields:u,start:f,num:B,outFields:G,cacheHint:I,relationshipId:d,returnGeometry:!1,objectIds:[S],where:N.where??void 0});q=(await e.queryRelatedFeatures(f,{signal:q?.signal}))[S]?.features||[];q.forEach(t=>{t.sourceLayer=A;t.layer=A});return q}};b.__decorate([H.property()],h.prototype,"_loaded",void 0);b.__decorate([H.property()],h.prototype,"_queryAbortController",void 0);
b.__decorate([H.property()],h.prototype,"_queryPageAbortController",void 0);b.__decorate([H.property()],h.prototype,"_queryFeatureCountAbortController",void 0);b.__decorate([H.property({value:1})],h.prototype,"featurePage",null);b.__decorate([H.property()],h.prototype,"featuresPerPage",void 0);b.__decorate([H.property({readOnly:!0})],h.prototype,"orderByFieldsFixedCasing",null);b.__decorate([H.property({readOnly:!0})],h.prototype,"supportsCacheHint",null);b.__decorate([H.property({readOnly:!0})],
h.prototype,"canLoad",null);b.__decorate([H.property({readOnly:!0})],h.prototype,"canQuery",null);b.__decorate([H.property()],h.prototype,"description",void 0);b.__decorate([H.property({readOnly:!0})],h.prototype,"itemDescriptionFieldName",null);b.__decorate([H.property({value:3})],h.prototype,"displayCount",null);b.__decorate([H.property({type:k})],h.prototype,"graphic",void 0);b.__decorate([H.property()],h.prototype,"layer",void 0);b.__decorate([H.property()],h.prototype,"map",void 0);b.__decorate([H.property({readOnly:!0})],
h.prototype,"objectId",null);b.__decorate([H.property({readOnly:!0})],h.prototype,"objectIdField",null);b.__decorate([H.property()],h.prototype,"orderByFields",void 0);b.__decorate([H.property({readOnly:!0})],h.prototype,"relatedFeatures",null);b.__decorate([H.property({readOnly:!0})],h.prototype,"relatedLayer",null);b.__decorate([H.property({readOnly:!0})],h.prototype,"relationship",null);b.__decorate([H.property()],h.prototype,"featureCount",void 0);b.__decorate([H.property({readOnly:!0})],h.prototype,
"relatedFeatureViewModels",null);b.__decorate([H.property()],h.prototype,"relationshipId",void 0);b.__decorate([H.property()],h.prototype,"showAllEnabled",void 0);b.__decorate([H.property()],h.prototype,"state",null);b.__decorate([H.property()],h.prototype,"title",void 0);return h=b.__decorate([n.subclass("esri.widgets.Feature.FeatureRelationship.FeatureRelationshipViewModel")],h)})},"esri/widgets/FeatureForm/featureFormUtils":function(){define("exports ../../intl ../../core/arrayUtils ../../core/compilerUtils ../../core/string ../../layers/support/domainUtils ../../layers/support/fieldUtils ../../smartMapping/support/utils ../support/dateUtils ../../intl/substitute".split(" "),
function(b,k,h,y,w,C,J,K,Q,H){function F(d){const {fields:a,values:m}=d,A=d.timeZone??void 0;d=a.map((I,O)=>{let S=m[O];I.domain&&"coded-value"===I.domain.type&&(O=I.domain.codedValues.find(f=>f.code===S),O?.name&&(S=O.name));if(K.isAnyDateField(I)||J.isTimeOnlyField(I))S=Q.getLabelForDateFieldValue(I,S,{timeZone:A,...Q.getIntlOptionsForField(I)});return[I.name,S]});return Object.fromEntries(d)}function c(d,a){return w.replace(w.replace(d,m=>`{${m.toLowerCase()}}`),Object.fromEntries(Object.entries(a).map(([m,
A])=>[m.toLowerCase(),A])))}function n(d){return 1E7<=d||-1E7>=d}function g(d,{validationErrors:a}){return null!=d.max&&null!=d.min?a.outsideRange:null!=d.max?a.outsideRangeMax:a.outsideRangeMin}const l=d=>"field"===d?.type,x=d=>"relationship"===d?.type,q=d=>"field"===d.type,z=d=>d.reduce((a,m)=>"group"===m?.type?[...a,...m.inputs]:[...a,m],[]),p=(d,a)=>null!=d&&d.input?.type===a,D={typeFieldName:null,types:[]};b.LengthValidationError=void 0;(b.LengthValidationError||(b.LengthValidationError={})).TOO_SHORT=
"length-validation-error::too-short";const v={type:"number"},e={type:"number",intlOptions:{notation:"scientific"}};b.capabilitiesAllowEditType=(d,a)=>{if(!d)return!0;({operations:d}=d);switch(a){case "INSERT":return d.supportsAdd;case "UPDATE":case "DELETE":return d.supportsUpdate;default:return!0}};b.flattenFieldInputs=d=>z(d).filter(l);b.flattenInputs=z;b.flattenRelationshipInputs=d=>z(d).filter(x);b.formTemplateHasInvalidFields=function(d,a){return(a=a??("formTemplate"in d&&d.formTemplate))?(a.elements?.filter(q)??
[]).some(({fieldName:m})=>!d.fieldsIndex.get(m)):!1};b.getComputedAttributes=F;b.getErrorMessageForFieldInput=(d,a,m)=>{const {dataType:A,error:I,minLength:O,value:S,required:f}=d,B=a?.validationErrors;if(!B||!I)return null;if(f&&null===S)return B.cannotBeNull;if(I===C.DomainValidationError.VALUE_OUT_OF_RANGE||I===J.NumericRangeValidationError.OUT_OF_RANGE){const {field:G,range:u}=d;d={type:"date",intlOptions:{timeZone:"date"===G.type&&m?m:void 0,...Q.getIntlOptionsForField(G)}};a=g(u,a);return H.substitute(a,
u,{format:{max:"date"===A?d:null!=u.max&&n(u.max)?e:v,min:"date"===A?d:null!=u.min&&n(u.min)?e:v}})}return I===C.DomainValidationError.INVALID_CODED_VALUE?B.invalidCodedValue:I===J.TypeValidationError.INVALID_TYPE?B.invalidType:I===b.LengthValidationError.TOO_SHORT?H.substitute(B.tooShort,{min:O}):null};b.getFieldsInTitleAndDesc=d=>{const a=[];if(d.formTemplate){const {description:m,title:A}=d.formTemplate;d.fields?.forEach(I=>{const O=A&&w.templateHasKey(A,I.name),S=m&&w.templateHasKey(m,I.name);
(O||S)&&a.push(I.name)})}return a};b.getIconForFeature=d=>{if(d){var a=d.layer;a=a&&"geometryType"in a?a.geometryType:void 0;d=d.geometry?.type;return"polyline"===d||"polyline"===a?"line":d||a||"table"}};b.getNormalizedFeatureTypeInfo=d=>d?"subtype-sublayer"===d.type?{typeFieldName:d.parent?.subtypeField,types:d.parent?.subtypes??[]}:"types"in d&&d.types?{typeFieldName:d.typeIdField,types:d.types.map(({id:a,name:m,domains:A})=>({code:a,name:m,domains:A}))}:D:D;b.isFieldElement=q;b.isFieldElementWithInputType=
p;b.isFieldElementWithShowNoValueOptionInput=d=>null!=d&&(p(d,"combo-box")||p(d,"radio-buttons"));b.isFieldElementWithTextInput=d=>null!=d&&(p(d,"text-box")||p(d,"text-area"));b.isFieldInput=l;b.isGroupElement=d=>"group"===d.type;b.isGroupInput=d=>"group"===d?.type;b.isInputInGroupInput=d=>"group"!==d?.type&&null!=d.group;b.isNumberFieldInput=({domain:d,inputType:a="text-box",dataType:m})=>"number"===m&&"text-box"===a&&(!d||"coded-value"!==d.type);b.isRelationshipElement=d=>"relationship"===d.type;
b.isRelationshipInput=x;b.isTemplateItemGroup=d=>"items"in d;b.parseFormTemplateString=function(d){const {attributes:a,fieldsIndex:m,label:A,timeZone:I}=d;if(!a||"object"!==typeof a)return A;var O=Object.keys(a).filter(S=>w.templateHasKey(A,S));d=O.map(S=>a[S]);O=O.map(S=>m.get(S)).filter(h.isSome);return c(A,F({values:d,fields:O,timeZone:I}))};b.substituteFieldTemplatesInString=c;b.valueIsInvalidSwitchValue=function(d,a){return null==d||a.onValue!==d&&a.offValue!==d};b.valueIsValidContingentValue=
function(d,a){switch(a.objectType){case "any":return!0;case "null":return null==d;case "code":return d===a.codedValue?.code;case "range":return null!=d&&null!=a.minValue&&null!=a.maxValue&&+d>=a.minValue&&+d<=a.maxValue;default:return y.neverReached(a.objectType),!1}};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/FeatureViewModel":function(){define("../../chunks/tslib.es6 ../../geometry ../../Graphic ../../arcade/featureset/support/FeatureSetQueryInterceptor ../../core/Accessor ../../core/arrayUtils ../../core/Identifiable ../../core/Logger ../../core/promiseUtils ../../core/reactiveUtils ../../core/throttle ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/has ../../core/accessorSupport/decorators/subclass ../../popup/content/TextContent ../../time/timeZoneUtils ./FeatureAttachments/FeatureAttachmentsViewModel ./FeatureContent/FeatureContentViewModel ./FeatureExpression/FeatureExpressionViewModel ./FeatureFields/FeatureFieldsViewModel ./FeatureMedia/FeatureMediaViewModel ./FeatureRelationship/FeatureRelationshipViewModel ./support/arcadeFeatureUtils ./support/featureUtils ./support/relatedFeatureUtils ../../geometry/Point".split(" "),
function(b,k,h,y,w,C,J,K,Q,H,F,c,n,g,l,x,q,z,p,D,v,e,d,a,m,A,I){var O;const S={attachmentsContent:!0,chartAnimation:!0,customContent:!0,expressionContent:!0,fieldsContent:!0,mediaContent:!0,textContent:!0,relationshipContent:!0};k=O=class extends J.IdentifiableMixin(w){constructor(f){super(f);this._featureAbortController=this._error=null;this._graphicChangedThrottled=F.throttle(this._graphicChanged,1,this);this._graphicExpressionAttributes=this._expressionAttributes=null;this.abilities={...S};this.content=
null;this.contentViewModels=[];this.description=null;this.defaultPopupTemplateEnabled=!1;this.location=this.lastEditInfo=this.formattedAttributes=null;this.relatedInfos=new Map;this.title="";this.view=null;this._isAllowedContentType=B=>{const {abilities:G}=this;return"attachments"===B.type&&!!G.attachmentsContent||"custom"===B.type&&!!G.customContent||"fields"===B.type&&!!G.fieldsContent||"media"===B.type&&!!G.mediaContent||"text"===B.type&&!!G.textContent||"expression"===B.type&&!!G.expressionContent||
"relationship"===B.type&&!!G.relationshipContent};this.addHandles(H.watch(()=>[this.graphic,this._effectivePopupTemplate,this.abilities,this.timeZone],()=>this._graphicChangedThrottled(),H.initial))}initialize(){this.addHandles(this._graphicChangedThrottled)}destroy(){this._clear();this._cancelFeatureQuery();this.graphic=this._error=null;this._destroyContentViewModels();this.relatedInfos.clear()}get _effectivePopupTemplate(){return null!=this.graphic?this.graphic.getEffectivePopupTemplate(this.defaultPopupTemplateEnabled):
null}get _fieldInfoMap(){return m.createFieldInfoMap(m.getAllFieldInfos(this._effectivePopupTemplate),this._sourceLayer)}get _sourceLayer(){return m.getSourceLayer(this.graphic)}castAbilities(f){return{...S,...f}}get isTable(){return this._sourceLayer?.isTable||!1}get state(){return this.graphic?this._error?"error":this.waitingForContent?"loading":"ready":"disabled"}set graphic(f){this._set("graphic",f?.clone()??null)}get spatialReference(){return this.view?.spatialReference??null}set spatialReference(f){this._override("spatialReference",
f)}get timeZone(){return this.view?.timeZone??q.system}set timeZone(f){this._overrideIfSome("timeZone",f)}get map(){return this.view?.map||null}set map(f){this._override("map",f)}get waitingForContent(){return!!this._featureAbortController}setActiveMedia(f,B){f=this.contentViewModels[f];f instanceof e&&f.setActiveMedia(B)}nextMedia(f){f=this.contentViewModels[f];f instanceof e&&f.next()}previousMedia(f){f=this.contentViewModels[f];f instanceof e&&f.previous()}async updateGeometry(){const {graphic:f,
spatialReference:B,_sourceLayer:G}=this;await G?.load();var u=G?.objectIdField;u&&f&&G&&(u=f?.attributes?.[u],null!=u&&(u=[u],!f.geometry&&(u=(await m.querySourceLayer({layer:G,graphic:f,outFields:[],objectIds:u,returnGeometry:!0,spatialReference:B}))?.geometry)))&&(f.geometry=u)}_clear(){this._set("title","");this._set("content",null);this._set("formattedAttributes",null)}async _graphicChanged(){this._cancelFeatureQuery();this._error=null;this._clear();const {graphic:f}=this;if(f){var B=new AbortController;
this._featureAbortController=B;try{await this._queryFeature({signal:B.signal})}catch(G){Q.isAbortError(G)||(this._error=G,K.getLogger(this).error("error","The popupTemplate could not be displayed for this feature.",{error:G,graphic:f,popupTemplate:this._effectivePopupTemplate}))}this._featureAbortController===B&&(this._featureAbortController=null)}}_cancelFeatureQuery(){const {_featureAbortController:f}=this;f&&f.abort();this._featureAbortController=null}_compileContentElement(f,B){if("attachments"===
f.type)return this._compileAttachments(f,B);if("custom"===f.type)return this._compileCustom(f,B);if("fields"===f.type)return this._compileFields(f,B);if("media"===f.type)return this._compileMedia(f,B);if("text"===f.type)return this._compileText(f,B);if("expression"===f.type)return this._compileExpression(f,B);if("relationship"===f.type)return this._compileRelationship(f,B)}_compileContent(f){this._destroyContentViewModels();if(this.graphic)return Array.isArray(f)?f.filter(this._isAllowedContentType).map((B,
G)=>this._compileContentElement(B,G)).filter(C.isSome):"string"===typeof f?this._compileText(new x({text:f}),0).text:f}_destroyContentViewModels(){this.removeHandles("relationship-view-models");this.removeHandles("content-view-models");this.contentViewModels.forEach(f=>f&&!f.destroyed&&f.destroy());this._set("contentViewModels",[])}_matchesFeature(f,B){f=f?.graphic?.getObjectId();B=B?.getObjectId();return null!=f&&null!=B&&f===B}_setRelatedFeaturesViewModels({relatedFeatureViewModels:f,relatedFeatures:B,
map:G}){const {view:u,spatialReference:N}=this;B?.filter(Boolean).forEach(t=>{f.some(r=>this._matchesFeature(r,t))||f.add(new O({abilities:{relationshipContent:!1},map:G,view:u,spatialReference:N,graphic:t}))});f.forEach(t=>{B?.find(r=>this._matchesFeature(t,r))||f.remove(t)})}_setExpressionContentVM(f,B){const G=this.formattedAttributes,{contentElement:u,contentElementViewModel:N}=f;f=u?.type;N&&f&&("fields"===f&&(this._createFieldsFormattedAttributes({contentElement:u,contentElementIndex:B,formattedAttributes:G}),
N.set(this._createFieldsVMParams(u,B))),"media"===f&&(this._createMediaFormattedAttributes({contentElement:u,contentElementIndex:B,formattedAttributes:G}),N.set(this._createMediaVMParams(u,B))),"text"===f&&N.set(this._createTextVMParams(u)))}_compileRelationship(f,B){const {displayCount:G,orderByFields:u,relationshipId:N,title:t,description:r}=f,{_sourceLayer:E,graphic:P,map:U}=this;if(m.isRelatableFeatureSupportedLayer(E)){var W=new d({displayCount:G,graphic:P,orderByFields:u,relationshipId:N,layer:E,
map:U,...this._compileTitleAndDesc({title:t,description:r})});this.contentViewModels[B]=W;this.addHandles(H.on(()=>W.relatedFeatures,"change",()=>this._setRelatedFeaturesViewModels(W)),"relationship-view-models");return f}}_compileExpression(f,B){const {expressionInfo:G}=f,{graphic:u,map:N,spatialReference:t,view:r,location:E}=this,P=new D({expressionInfo:G,graphic:u,interceptor:O.interceptor,map:N,spatialReference:t,view:r,location:E});this.contentViewModels[B]=P;this.addHandles(H.watch(()=>P.contentElementViewModel,
()=>this._setExpressionContentVM(P,B),H.initial),"content-view-models");return f}_compileAttachments(f,B){const {graphic:G}=this,{description:u,title:N}=f;this.contentViewModels[B]=new z({graphic:G,...this._compileTitleAndDesc({title:N,description:u})});return f}_compileCustom(f,B){const {graphic:G}=this,{creator:u,destroyer:N}=f;this.contentViewModels[B]=new p({graphic:G,creator:u,destroyer:N});return f}_compileTitleAndDesc({title:f,description:B}){const {_fieldInfoMap:G,_sourceLayer:u,graphic:N,
formattedAttributes:t}=this,r=N?.attributes,E=this._expressionAttributes,P=t.global;return{title:m.substituteFieldsInLinksAndAttributes({attributes:r,fieldInfoMap:G,globalAttributes:P,expressionAttributes:E,layer:u,text:f}),description:m.substituteFieldsInLinksAndAttributes({attributes:r,fieldInfoMap:G,globalAttributes:P,expressionAttributes:E,layer:u,text:B})}}_createFieldsVMParams(f,B){const G=this._effectivePopupTemplate,u=this.formattedAttributes,N={...u?.global,...u?.content[B]};B=(f?.fieldInfos||
G?.fieldInfos)?.filter(({fieldName:E})=>m.isExpressionField(E)||m.isRelatedField(E)||N.hasOwnProperty(E));const {description:t,title:r}=f;return{attributes:N,expressionInfos:G?.expressionInfos,fieldInfos:B,...this._compileTitleAndDesc({title:r,description:t})}}_compileFields(f,B){const G=f.clone();f=new v(this._createFieldsVMParams(f,B));this.contentViewModels[B]=f;G.fieldInfos=f.formattedFieldInfos.slice(0);return G}_createMediaVMParams(f,B){const {abilities:G,graphic:u,_fieldInfoMap:N,_effectivePopupTemplate:t,
relatedInfos:r,_sourceLayer:E,_expressionAttributes:P}=this,U=this.formattedAttributes,W=u?.attributes??{},{description:aa,mediaInfos:da,title:Z}=f;return{abilities:{chartAnimation:G.chartAnimation},activeMediaInfoIndex:f.activeMediaInfoIndex||0,attributes:W,isAggregate:u?.isAggregate,layer:E,fieldInfoMap:N,formattedAttributes:{...U?.global,...U?.content[B]},expressionAttributes:P,mediaInfos:da,popupTemplate:t,relatedInfos:r,...this._compileTitleAndDesc({title:Z,description:aa})}}_compileMedia(f,
B){const G=f.clone();f=new e(this._createMediaVMParams(f,B));G.mediaInfos=f.formattedMediaInfos.slice(0);this.contentViewModels[B]=f;return G}_createTextVMParams(f){const {graphic:B,_fieldInfoMap:G,_sourceLayer:u,_expressionAttributes:N}=this;f&&f.text&&(f.text=m.substituteFieldsInLinksAndAttributes({attributes:B?.attributes??{},fieldInfoMap:G,globalAttributes:this.formattedAttributes?.global??{},expressionAttributes:N,layer:u,text:f.text}));return{graphic:B,creator:f.text}}_compileText(f,B){f=f.clone();
this.contentViewModels[B]=new p(this._createTextVMParams(f));return f}_compileLastEditInfo(){const {_effectivePopupTemplate:f,_sourceLayer:B,graphic:G,timeZone:u}=this;if(f){var {lastEditInfoEnabled:N}=f,t=B?.editFieldsInfo;if(N&&t)return m.formatEditInfo(t,G?.attributes,u,B)}}_compileTitle(f){const {_fieldInfoMap:B,_sourceLayer:G,graphic:u,_expressionAttributes:N}=this;return m.substituteFieldsInLinksAndAttributes({attributes:u?.attributes??{},fieldInfoMap:B,globalAttributes:this.formattedAttributes?.global??
{},expressionAttributes:N,layer:G,text:f})}async _getTitle(){const {_effectivePopupTemplate:f,graphic:B}=this;return B?m.graphicCallback(f?.title,{graphic:B}):null}async _getContent(){const {_effectivePopupTemplate:f,graphic:B}=this;return B?m.graphicCallback(f?.content,{graphic:B}):null}async _queryFeature(f){const {_featureAbortController:B,_sourceLayer:G,graphic:u,_effectivePopupTemplate:N}=this,t=this.map,r=this.view,E=this.spatialReference,P=this.location;if(B===this._featureAbortController&&
u){await m.queryUpdatedFeature({graphic:u,popupTemplate:N,layer:G,spatialReference:E},f);var {content:{value:U},title:{value:W}}=await Q.eachAlways({content:this._getContent(),title:this._getTitle()});({expressionAttributes:{value:f}}=await Q.eachAlways({checkForRelatedFeatures:this._checkForRelatedFeatures(f),expressionAttributes:a.createCompiledExpressions({expressionInfos:N?.expressionInfos,spatialReference:E,graphic:u,map:t,interceptor:O.interceptor,view:r,options:f,location:P})}));B===this._featureAbortController&&
u&&(this._expressionAttributes=f,this._graphicExpressionAttributes={...u.attributes,...f},this._set("formattedAttributes",this._createFormattedAttributes(U)),this._set("title",this._compileTitle(W)),this._set("lastEditInfo",this._compileLastEditInfo()||null),this._set("content",this._compileContent(U)||null))}}_createMediaFormattedAttributes({contentElement:f,contentElementIndex:B,formattedAttributes:G}){const {_effectivePopupTemplate:u,graphic:N,relatedInfos:t,_sourceLayer:r,_fieldInfoMap:E,_graphicExpressionAttributes:P,
timeZone:U}=this;G.content[B]=m.formatAttributes({fieldInfos:u?.fieldInfos,graphic:N,attributes:{...P,...f.attributes},layer:r,fieldInfoMap:E,relatedInfos:t,timeZone:U})}_createFieldsFormattedAttributes({contentElement:f,contentElementIndex:B,formattedAttributes:G}){if(f.fieldInfos){const {graphic:u,relatedInfos:N,_sourceLayer:t,_fieldInfoMap:r,_graphicExpressionAttributes:E,timeZone:P}=this;G.content[B]=m.formatAttributes({fieldInfos:f.fieldInfos,graphic:u,attributes:{...E,...f.attributes},layer:t,
fieldInfoMap:r,relatedInfos:N,timeZone:P})}}_createFormattedAttributes(f){const {_effectivePopupTemplate:B,graphic:G,relatedInfos:u,_sourceLayer:N,_fieldInfoMap:t,_graphicExpressionAttributes:r,timeZone:E}=this,P={global:m.formatAttributes({fieldInfos:B?.fieldInfos,graphic:G,attributes:r,layer:N,fieldInfoMap:t,relatedInfos:u,timeZone:E}),content:[]};Array.isArray(f)&&f.forEach((U,W)=>{"fields"===U.type&&this._createFieldsFormattedAttributes({contentElement:U,contentElementIndex:W,formattedAttributes:P});
"media"===U.type&&this._createMediaFormattedAttributes({contentElement:U,contentElementIndex:W,formattedAttributes:P})});return P}_checkForRelatedFeatures(f){const {graphic:B,_effectivePopupTemplate:G}=this;return this._queryRelatedInfos(B,m.getAllFieldInfos(G),f)}async _queryRelatedInfos(f,B,G){const {relatedInfos:u,_sourceLayer:N}=this;u.clear();const t=null!=N?.associatedLayer?await N?.associatedLayer.load(G):N;if(t&&f&&B.filter(P=>P&&m.isRelatedField(P.fieldName))?.length){B.forEach(P=>this._configureRelatedInfo(P,
t));var r=await A.queryLayerInfos({relatedInfos:u,layer:t},G);Object.keys(r).forEach(P=>{const U=u.get(P.toString());P=r[P]?.value;U&&P&&(U.layerInfo=P.data)});var E=await A.queryRelatedFeatures({graphic:f,relatedInfos:u,layer:t},G);Object.keys(E).forEach(P=>{A.setRelatedFeatures(E[P]?.value,u.get(P.toString()))})}}_configureRelatedInfo(f,B){const {relatedInfos:G}=this,u=A.getRelatedFieldInfo(f.fieldName);if(u){var {layerId:N,fieldName:t}=u;N&&(B=G.get(N.toString())||A.createRelatedInfo(N,B))&&(A.updateRelatedInfo({relatedInfo:B,
fieldName:t,fieldInfo:f}),this.relatedInfos.set(N,B))}}};k.interceptor=new y.FeatureSetQueryInterceptor(m.preLayerQueryCallback,m.preRequestCallback);b.__decorate([c.property()],k.prototype,"_error",void 0);b.__decorate([c.property()],k.prototype,"_featureAbortController",void 0);b.__decorate([c.property({readOnly:!0})],k.prototype,"_effectivePopupTemplate",null);b.__decorate([c.property({readOnly:!0})],k.prototype,"_fieldInfoMap",null);b.__decorate([c.property({readOnly:!0})],k.prototype,"_sourceLayer",
null);b.__decorate([c.property()],k.prototype,"abilities",void 0);b.__decorate([n.cast("abilities")],k.prototype,"castAbilities",null);b.__decorate([c.property({readOnly:!0})],k.prototype,"content",void 0);b.__decorate([c.property({readOnly:!0})],k.prototype,"contentViewModels",void 0);b.__decorate([c.property()],k.prototype,"description",void 0);b.__decorate([c.property({type:Boolean})],k.prototype,"defaultPopupTemplateEnabled",void 0);b.__decorate([c.property({readOnly:!0})],k.prototype,"isTable",
null);b.__decorate([c.property({readOnly:!0})],k.prototype,"state",null);b.__decorate([c.property({readOnly:!0})],k.prototype,"formattedAttributes",void 0);b.__decorate([c.property({type:h,value:null})],k.prototype,"graphic",null);b.__decorate([c.property({readOnly:!0})],k.prototype,"lastEditInfo",void 0);b.__decorate([c.property({type:I})],k.prototype,"location",void 0);b.__decorate([c.property({readOnly:!0})],k.prototype,"relatedInfos",void 0);b.__decorate([c.property()],k.prototype,"spatialReference",
null);b.__decorate([c.property()],k.prototype,"timeZone",null);b.__decorate([c.property({readOnly:!0})],k.prototype,"title",void 0);b.__decorate([c.property()],k.prototype,"map",null);b.__decorate([c.property({readOnly:!0})],k.prototype,"waitingForContent",null);b.__decorate([c.property()],k.prototype,"view",void 0);return k=O=b.__decorate([l.subclass("esri.widgets.Feature.FeatureViewModel")],k)})},"esri/arcade/featureset/support/FeatureSetQueryInterceptor":function(){define(["exports"],function(b){class k{constructor(h,
y){this.preLayerQueryCallback=h;this.preRequestCallback=y;this.preLayerQueryCallback||(this.preLayerQueryCallback=w=>{});this.preRequestCallback||(this.preLayerQueryCallback=w=>{})}}b.FeatureSetQueryInterceptor=k;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/resources":function(){define(["exports"],function(b){b.css={base:"esri-feature",container:"esri-feature__size-container",title:"esri-feature__title",main:"esri-feature__main-container",btn:"esri-feature__button",
icon:"esri-feature__icon",content:"esri-feature__content",contentNode:"esri-feature__content-node",contentNodeText:"esri-feature__content-node--text",contentElement:"esri-feature__content-element",text:"esri-feature__text",lastEditedInfo:"esri-feature__last-edited-info",fields:"esri-feature__fields",fieldHeader:"esri-feature__field-header",fieldData:"esri-feature__field-data",fieldDataDate:"esri-feature__field-data--date",loadingSpinnerContainer:"esri-feature__loading-container",spinner:"esri-feature__loading-spinner"};
Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/support/FeatureContentMixin":function(){define("exports ../../../chunks/tslib.es6 ../../../core/Logger ../../../core/has ../../../core/RandomLCG ../../../core/Error ../../../core/accessorSupport/decorators/subclass ../resources ../../support/widget ../../support/jsxFactory".split(" "),function(b,k,h,y,w,C,J,K,Q,H){b.FeatureContentMixin=F=>{F=class extends F{constructor(){super(...arguments);this.renderNodeContent=
c=>Q.isWidget(c)&&!c.destroyed?H.tsx("div",{class:K.css.contentNode,key:c},c.render()):c instanceof HTMLElement?H.tsx("div",{afterCreate:this._attachToNode,bind:c,class:K.css.contentNode,key:c}):Q.hasDomNode(c)?H.tsx("div",{afterCreate:this._attachToNode,bind:c.domNode,class:K.css.contentNode,key:c}):null}_attachToNode(c){c.appendChild(this)}};return F=k.__decorate([J.subclass("esri.widgets.Feature.ContentMixin")],F)};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Spinner":function(){define("../chunks/tslib.es6 ../core/promiseUtils ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass ./Widget ./Spinner/SpinnerViewModel ./support/widgetUtils ./support/jsxFactory".split(" "),
function(b,k,h,y,w,C,J,K,Q,H,F,c){w=class extends Q{constructor(n,g){super(n,g);this._animationDelay=500;this._animationPromise=null;this.viewModel=new H}initialize(){this.addHandles(h.watch(()=>this.visible,n=>this._visibleChange(n)))}destroy(){this._animationPromise=null}get location(){return this.viewModel.location}set location(n){this.viewModel.location=n}get view(){return this.viewModel.view}set view(n){this.viewModel.view=n}get visible(){return this.viewModel.visible}set visible(n){this.viewModel.visible=
n}show(n){const {location:g,promise:l}=n??{};g&&(this.viewModel.location=g);this.visible=!0;n=()=>this.hide();l&&l.catch(()=>{}).then(n)}hide(){this.visible=!1}render(){var {visible:n}=this,{screenLocation:g}=this.viewModel;g=!!g;n={["esri-spinner--start"]:n&&g,["esri-spinner--finish"]:!n&&g};g=this._getPositionStyles();return c.tsx("div",{class:this.classes("esri-spinner",n),styles:g})}_visibleChange(n){if(n)this.viewModel.screenLocationEnabled=!0;else{var g=k.after(this._animationDelay);this._animationPromise=
g;g.catch(()=>{}).then(()=>{this._animationPromise===g&&(this.viewModel.screenLocationEnabled=!1,this._animationPromise=null)})}}_getPositionStyles(){const {screenLocation:n,view:g}=this.viewModel;if(null==g||null==n)return{};const {padding:l}=g;return{left:`${n.x-l.left}px`,top:`${n.y-l.top}px`}}};b.__decorate([y.property()],w.prototype,"location",null);b.__decorate([y.property()],w.prototype,"view",null);b.__decorate([y.property({type:H})],w.prototype,"viewModel",void 0);b.__decorate([y.property()],
w.prototype,"visible",null);return w=b.__decorate([K.subclass("esri.widgets.Spinner")],w)})},"esri/widgets/Spinner/SpinnerViewModel":function(){define("../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../support/AnchorElementViewModel".split(" "),function(b,k,h,y,w,C,J){h=class extends J{constructor(K){super(K);this.visible=!1}};b.__decorate([k.property()],h.prototype,"visible",
void 0);return h=b.__decorate([C.subclass("esri.widgets.CompassViewModel")],h)})},"esri/widgets/support/AnchorElementViewModel":function(){define("../../chunks/tslib.es6 ../../core/Evented ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../geometry/projection".split(" "),function(b,k,h,y,w,C,J,K,Q){k=class extends k.EventedAccessor{constructor(H){super(H);this.location=null;
this.screenLocationEnabled=!1;this.view=null;this.addHandles([h.when(()=>{const F=this.screenLocationEnabled?this.view:null;return F?[F.size,"3d"===F.type?F.camera:F.viewpoint]:null},()=>this.notifyChange("screenLocation")),h.watch(()=>this.screenLocation,(F,c)=>{null!=F&&null!=c&&this.emit("view-change")})])}destroy(){this.view=null}get screenLocation(){const {location:H,view:F,screenLocationEnabled:c}=this;var n=F?.spatialReference;n=n?Q.projectOrLoad(H,n).geometry:null;return c&&n&&F?.ready?F.toScreen(n):
null}};b.__decorate([y.property()],k.prototype,"location",void 0);b.__decorate([y.property()],k.prototype,"screenLocation",null);b.__decorate([y.property()],k.prototype,"screenLocationEnabled",void 0);b.__decorate([y.property()],k.prototype,"view",void 0);return k=b.__decorate([K.subclass("esri.widgets.support.AnchorElementViewModel")],k)})},"esri/widgets/Features/css":function(){define(["exports"],function(b){b.css={icon:"esri-features__icon",actionImage:"esri-features__action-image",base:"esri-features",
container:"esri-features__container",contentContainer:"esri-features__content-container",contentFeature:"esri-features__content-feature",flowItemCollapsed:"esri-features__flow-item--collapsed",header:"esri-features__header",footer:"esri-features__footer",featureMenuObserver:"esri-features__feature-menu-observer",actionExit:"esri-features__action--exit",loader:"esri-features__loader",featuresHeading:"esri-features__heading",paginationActionBar:"esri-features__pagination-action-bar",paginationPrevious:"esri-features__pagination-previous",
paginationNext:"esri-features__pagination-next"};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Features/FeaturesRelatedRecords":function(){define("require ../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../Widget ./css ../../chunks/componentsUtils ../support/widgetUtils ../support/decorators/messageBundle ../support/jsxFactory".split(" "),function(b,
k,h,y,w,C,J,K,Q,H,F,c,n){y=class extends K{constructor(g,l){super(g,l);this.messages=null;this.closed=!1;this.closable=!0;this._handleOpenRelatedFeature=x=>{this.emit("open-related-feature",{feature:x})}}loadDependencies(){return H.loadCalciteComponents({action:()=>new Promise((g,l)=>b(["../../chunks/calcite-action"],g,l)),"flow-item":()=>new Promise((g,l)=>b(["../../chunks/calcite-flow-item"],g,l))})}render(){var {flowItems:g}=this;g=g?.toArray();return n.tsx(n.tsxFragment,null,g?.map(l=>this._renderRelatedRecordsFlowItem(l)))}_handleCloseClick(){this.emit("close")}_handleExitClick(){this.emit("exit")}_handleRelatedRecordsBackClick(){const g=
this.flowItems?.pop();g&&("showAllEnabled"in g.viewModel&&(g.viewModel.showAllEnabled=!1),g&&(g.viewModel=null,g.destroy()))}_renderRelatedRecordsFlowItem(g){const {messages:l,closable:x,closed:q}=this,z="graphic"in g&&!g.isTable;return n.tsx("calcite-flow-item",{bind:this,closable:x,closed:q,description:this._getRelatedRecordsFlowItemDescription(g),heading:g.title??"",key:`flow-item-${g.viewModel.uid}`,onCalciteFlowItemBack:p=>{p.preventDefault();this._handleRelatedRecordsBackClick()},onCalciteFlowItemClose:this._handleCloseClick},
n.tsx("calcite-action",{appearance:"transparent",bind:this,class:Q.css.actionExit,icon:"move-up",key:"exit-related-records-action",label:l.exitRelatedRecords,onclick:this._handleExitClick,scale:"m",slot:"header-actions-start",text:l.exitRelatedRecords,title:l.exitRelatedRecords}),z?n.tsx("calcite-action",{appearance:"transparent",bind:this,icon:"zoom-to-object",key:"open-related-feature-action",label:l.selectFeature,onclick:()=>this._handleOpenRelatedFeature(g),scale:"m",slot:"header-actions-end",
text:l.selectFeature,title:l.selectFeature}):null,n.tsx("div",{class:Q.css.container},g.render()))}_getRelatedRecordsFlowItemDescription(g){return"featureCountDescription"in g?g.featureCountDescription:g.viewModel.description??""}};k.__decorate([h.property()],y.prototype,"flowItems",void 0);k.__decorate([h.property(),c.messageBundle("esri/widgets/Features/t9n/Features")],y.prototype,"messages",void 0);k.__decorate([h.property()],y.prototype,"closed",void 0);k.__decorate([h.property()],y.prototype,
"closable",void 0);return y=k.__decorate([J.subclass("esri.widgets.Features.FeaturesRelatedRecords")],y)})},"esri/widgets/Features/FeaturesViewModel":function(){define("require ../../chunks/tslib.es6 ../../geometry ../../Graphic ../../symbols ../../core/arrayUtils ../../core/Error ../../core/Logger ../../core/promiseUtils ../../core/ReactiveSet ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/decorators/subclass ../../geometry/projection ../../geometry/support/geometryUtils ../../geometry/support/webMercatorUtils ../../layers/Layer ../../layers/LayerConstants ../../symbols/support/symbolUtils ../../views/support/layerViewUtils ../Feature/FeatureViewModel ../Popup/actions ../Popup/actionUtils ../support/AnchorElementViewModel ../support/GoTo ../../symbols/SimpleFillSymbol ../../geometry/Point".split(" "),
function(b,k,h,y,w,C,J,K,Q,H,F,c,n,g,l,x,q,z,p,D,v,e,d,a,m,A,I,O){let S=null;h=class extends A.GoToMixin(m){constructor(f){super(f);this._pendingPromises=new H;this._locationScaleHandle=this._selectedClusterFeature=this._highlightActiveFeaturePromise=this._highlightSelectedFeaturePromise=this._fetchFeaturesController=null;this.actions=new d.ActionsCollection;this.activeFeature=null;this.autoCloseEnabled=!1;this.autoOpenEnabled=!0;this.browseClusterEnabled=!1;this.content=null;this.defaultPopupTemplateEnabled=
!1;this.featurePage=null;this.featuresPerPage=20;this.featureMenuOpen=!1;this.featureViewModelAbilities=null;this.featureViewModels=[];this.includeDefaultActions=this.highlightEnabled=!0;this.selectedClusterBoundaryFeature=new y({symbol:new I({outline:{width:1.5,color:"cyan"},style:"none"})});this.title=null;this.updateLocationEnabled=!1;this.view=null;this.visible=!1;this.zoomFactor=4;this.zoomToLocation=null;this._debouncedLocationUpdate=Q.debounce(async B=>{const {view:G}=this,u=this.selectedFeature?.geometry?.type;
B=this.location??B;if("mesh"!==u&&G&&B&&this.selectedFeature)if("point"===u)this.location=x.getPointFromGeometry(this.selectedFeature.geometry)??B;else try{const {pendingFeatures:E}=await this._fetchFeaturesWithController({mapPoint:B}),P=(await Promise.all(E)).flat().filter(Boolean);if(P.length){if(P.length!==this.features.length){const U=this._getHighlightLayer(this.selectedFeature),W="imagery"===U?.type?void 0:U&&"objectIdField"in U?U.objectIdField||p.fallbackObjectIDAttribute:null;if(W){const aa=
this.selectedFeature.getObjectId(),da=P.findIndex(Z=>this._getHighlightLayer(Z)?.uid===U?.uid&&Z.attributes[W]===aa);this.features=P;this.selectedFeatureIndex=da}}var N=P[this.selectedFeatureIndex]?.geometry,t=("mesh"!==N?.type?N:null)??this.selectedFeature.geometry,r=t?l.project(t,G.spatialReference):null;r&&(S||=await new Promise((U,W)=>b(["../../geometry/geometryEngineAsync"],U,W)),await S.intersects(r,B)||(this.location=(await S.nearestCoordinate(r,B)).coordinate??B))}}catch(E){Q.isAbortError(E)||
K.getLogger(this).error(E)}})}initialize(){this.addHandles([this.on("view-change",()=>this._autoClose()),F.watch(()=>[this.highlightEnabled,this.selectedFeature,this.visible,this.view],()=>this._highlightSelectedFeature()),F.watch(()=>[this.highlightEnabled,this.activeFeature,this.visible,this.view],()=>this._highlightActiveFeature()),F.watch(()=>this.view?.animation?.state,f=>this._animationStateChange(f)),F.watch(()=>this.location,f=>this._locationChange(f)),F.watch(()=>this.selectedFeature,f=>
this._selectedFeatureChange(f)),F.watch(()=>[this.selectedFeatureIndex,this.featureCount,this.featuresPerPage],()=>this._selectedFeatureIndexChange()),F.watch(()=>[this.featurePage,this.selectedFeatureIndex,this.featureCount,this.featuresPerPage,this.featureViewModels],()=>this._setGraphicOnFeatureViewModels()),F.watch(()=>this.featureViewModels,()=>this._featureViewModelsChange()),this.on("trigger-action",f=>a.triggerAction({event:f,viewModel:this,view:this.view})),F.when(()=>!this.waitingForResult,
()=>this._waitingForResultChange(),F.sync),F.watch(()=>[this.features,this.view?.map,this.view?.spatialReference,this.view?.timeZone],()=>this._updateFeatureVMs()),F.watch(()=>this.view?.scale,()=>this._viewScaleChange()),F.when(()=>!this.visible,()=>this.browseClusterEnabled=!1),F.watch(()=>this.browseClusterEnabled,f=>f?this.enableClusterBrowsing():this.disableClusterBrowsing())])}destroy(){this._cancelFetchingFeatures();this._pendingPromises.clear();this.browseClusterEnabled=!1;this.view=null;
this._locationScaleHandle?.remove();this._locationScaleHandle=null}get active(){return!(!this.visible||this.waitingForResult)}get allActions(){const f=this._get("allActions")||new d.ActionsCollection;f.removeAll();const {actions:B,defaultActions:G,defaultPopupTemplateEnabled:u,includeDefaultActions:N,selectedFeature:t}=this,r=N?G.concat(B):B,E=t&&("function"===typeof t.getEffectivePopupTemplate&&t.getEffectivePopupTemplate(u)||t.popupTemplate),P=E?.actions;(E?.overwriteActions?P:P?.concat(r)??r)?.filter(Boolean).forEach(U=>
f.add(U));return f}get defaultActions(){const f=this._get("defaultActions")||new d.ActionsCollection;f.removeAll();f.addMany(a.isClusterFeature(this.selectedFeature)?[d.zoomToClusteredFeatures.clone(),d.browseClusteredFeatures.clone()]:[d.zoomToFeature.clone()]);return f}get featureCount(){return this.features.length}set features(f){f=f||[];this._set("features",f);const {pendingPromisesCount:B,promiseCount:G,selectedFeatureIndex:u}=this,N=G&&f.length;N&&B&&-1===u?this.selectedFeatureIndex=0:N&&-1!==
u||(this.selectedFeatureIndex=f.length?0:-1)}set location(f){let B=f;const G=this.view?.spatialReference?.isWebMercator;f?.spatialReference?.isWGS84&&G&&(B=q.geographicToWebMercator(f));this._set("location",B)}get pendingPromisesCount(){return this._pendingPromises.size}get promiseCount(){return this.promises.length}get promises(){return this._get("promises")||[]}set promises(f){this._pendingPromises.clear();this.features=[];Array.isArray(f)&&f.length?(this._set("promises",f),f=f.slice(0),f.forEach(B=>
this._pendingPromises.add(B)),f.reduce((B,G)=>B.finally(()=>G.then(u=>{this._pendingPromises.has(G)&&this._updateFeatures(u)}).finally(()=>this._pendingPromises.delete(G)).catch(()=>{})),Promise.resolve())):this._set("promises",[])}get selectedFeature(){const {features:f,selectedFeatureIndex:B}=this;return-1===B?null:f[B]||null}get selectedFeatureIndex(){const f=this._get("selectedFeatureIndex");return"number"===typeof f?f:-1}set selectedFeatureIndex(f){const {featureCount:B}=this;f=isNaN(f)||-1>
f||!B?-1:(f+B)%B;this.activeFeature=null;this._set("selectedFeatureIndex",f)}get selectedFeatureViewModel(){return this.featureViewModels[this.selectedFeatureIndex]||null}get state(){return this.view?.ready?"ready":"disabled"}get waitingForContents(){return this.featureViewModels.some(f=>f.waitingForContent)}get waitingForResult(){return!(!(this._fetchFeaturesController||0<this.pendingPromisesCount)||0!==this.featureCount)}centerAtLocation(){const {view:f}=this,B=a.getSelectedTarget(this);return B&&
f?this.callGoTo({target:{target:B,scale:f.scale}}):Promise.reject(new J("center-at-location:invalid-target-or-view","Cannot center at a location without a target and view.",{target:B,view:f}))}zoomTo(f){return this.callGoTo(f)}clear(){this.set({promises:[],features:[],content:null,title:null,location:null,activeFeature:null})}fetchFeatures(f,B){const {view:G}=this;if(!G||!f)throw new J("fetch-features:invalid-screenpoint-or-view","Cannot fetch features without a screenPoint and view.",{screenPoint:f,
view:G});return G.fetchPopupFeatures(f,{pointerType:B?.event?.pointerType,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,signal:B?.signal})}open(f){f={updateLocationEnabled:!1,promises:[],fetchFeatures:!1,...f,visible:!0};var {fetchFeatures:B}=f;delete f.fetchFeatures;B&&this._setFetchFeaturesPromises(f.location);B=["actionsMenuOpen","collapsed"];for(const G of B)delete f[G];this.set(f)}triggerAction(f){(f=this.allActions.at(f))&&!f.disabled&&this.emit("trigger-action",{action:f})}next(){this.selectedFeatureIndex++;
return this}previous(){this.selectedFeatureIndex--;return this}disableClusterBrowsing(){a.removeClusteredFeaturesForBrowsing(this);this._clearBrowsedClusterGraphics()}async enableClusterBrowsing(){const {view:f,selectedFeature:B}=this;"2d"!==f?.type?K.getLogger(this).warn("enableClusterBrowsing:invalid-view: View must be 2d MapView.",B):a.isClusterFeature(B)?(await a.displayClusterExtent(this),await a.browseAggregateFeatures(this)):K.getLogger(this).warn("enableClusterBrowsing:invalid-selectedFeature: Selected feature must represent an aggregate/cluster graphic.",
B)}handleViewClick(f){this.autoOpenEnabled&&this._fetchFeaturesAndOpen(f)}_animationStateChange(f){this.zoomToLocation||(d.zoomToFeature.disabled="waiting-for-target"===f)}_clearBrowsedClusterGraphics(){const f=[this.selectedClusterBoundaryFeature,this._selectedClusterFeature].filter(C.isSome);this.view?.graphics?.removeMany(f);this._selectedClusterFeature=null;this.selectedClusterBoundaryFeature.geometry=null}_viewScaleChange(){a.isClusterFeature(this.selectedFeature)?(this.visible=this.browseClusterEnabled=
!1,this.clear()):this.browseClusterEnabled&&(this.features=this.selectedFeature?[this.selectedFeature]:[])}_locationChange(f){const {selectedFeature:B,updateLocationEnabled:G}=this;G&&f&&(!B||B.geometry)&&this.centerAtLocation()}_selectedFeatureIndexChange(){this.featurePage=1<this.featureCount?Math.floor(this.selectedFeatureIndex/this.featuresPerPage)+1:null}_featureViewModelsChange(){this.featurePage=1<this.featureCount?1:null}_setGraphicOnFeatureViewModels(){const {features:f,featureCount:B,featurePage:G,
featuresPerPage:u,featureViewModels:N}=this;if(null!==G){var t=((G-1)*u+B)%B;N.slice(t,t+u).forEach((r,E)=>{r&&(r.graphic??(r.graphic=f[t+E]))})}}async _selectedFeatureChange(f){const {location:B,updateLocationEnabled:G,view:u}=this;f&&u&&(this.browseClusterEnabled?(this._selectedClusterFeature&&(u.graphics.remove(this._selectedClusterFeature),this._selectedClusterFeature=null),a.isClusterFeature(f)||(f.symbol=await D.getDisplayedSymbol(f),this._selectedClusterFeature=f,u.graphics.add(this._selectedClusterFeature))):
(f.symbol=await D.getDisplayedSymbol(f),!G&&B||!f.geometry)?G&&!f.geometry&&(await this.centerAtLocation(),f=u.center?.clone())&&(this.location=f):this.location=x.getPointFromGeometry(f.geometry))}_waitingForResultChange(){!this.featureCount&&this.promises&&(this.visible=!1)}async _setFetchFeaturesPromises(f){({pendingFeatures:f}=await this._fetchFeaturesWithController({mapPoint:f}));this.promises=f}_destroyFeatureVMs(){this.featureViewModels.forEach(f=>f&&!f.destroyed&&f.destroy());this._set("featureViewModels",
[])}_updateFeatureVMs(){const {selectedFeature:f,features:B,featureViewModels:G,view:u}=this;a.isClusterFeature(f)||(this.browseClusterEnabled=!1);this._destroyFeatureVMs();if(B?.length){var N=G.slice(0),t=[];B.forEach((r,E)=>{if(r){var P=null;N.some((U,W)=>{U&&U.graphic===r&&(P=U,N.splice(W,1));return!!P});if(P)t[E]=P;else{const U=new e({abilities:this.featureViewModelAbilities,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,spatialReference:u?.spatialReference,graphic:r===f?r:null,
location:this.location,map:u?.map,view:u});t[E]=U}}});N.forEach(r=>r&&!r.destroyed&&r.destroy());this._set("featureViewModels",t)}}async _getScreenPoint(f,B){const {view:G}=this;await G?.when();const u=f?.spatialReference,N=G?.spatialReference;if(!u||!N)return null;await l.initializeProjection(u,N,null,B);return G.toScreen(f)}_cancelFetchingFeatures(){const f=this._fetchFeaturesController;f&&f.abort();this._fetchFeaturesController=null}async _projectScreenPointAndFetchFeatures({mapPoint:f,screenPoint:B,
event:G,signal:u}){return this.fetchFeatures(B??await this._getScreenPoint(f??this.location,{signal:u}),{signal:u,event:G})}_fetchFeaturesWithController({mapPoint:f,screenPoint:B,event:G}){this._cancelFetchingFeatures();const u=new AbortController,{signal:N}=u;this._fetchFeaturesController=u;f=this._projectScreenPointAndFetchFeatures({mapPoint:f,screenPoint:B,signal:N,event:G});f.catch(()=>{}).then(()=>{this._fetchFeaturesController=null});return f}async _fetchFeaturesAndOpen(f){const {mapPoint:B,
screenPoint:G}=f,{view:u}=this;this._locationScaleHandle?.remove();this._locationScaleHandle=F.watch(()=>this.view?.scale,()=>this._debouncedLocationUpdate(B).catch(N=>{Q.isAbortError(N)||K.getLogger(this).error(N)}));({pendingFeatures:f}=await this._fetchFeaturesWithController({mapPoint:B,screenPoint:G,event:f}));u?.popup&&"open"in u.popup&&u.popup.open({location:B??void 0,promises:f})}_autoClose(){this.autoCloseEnabled&&(this.visible=!1)}async _getLayerView(f,B){await f.when();return f.whenLayerView(B)}_getHighlightLayer(f){const {layer:B,
sourceLayer:G}=f;return G&&"layer"in G&&G.layer?G.layer:"map-notes"===G?.type||"subtype-group"===G?.type?G:B}_getHighlightTarget(f,B,G){var u=B.type;if("building-scene"===u||"2d"===G&&("map-image"===u||"tile"===u||"imagery"===u||"imagery-tile"===u))return f;G=f.getObjectId();if(null!=G)return G;B="imagery"===B.type?void 0:"objectIdField"in B?B.objectIdField||p.fallbackObjectIDAttribute:null;return(G=f.attributes)&&B&&G[B]||f}_mapIncludesLayer(f){return!!this.view?.map?.allLayers?.includes(f)}async _highlightActiveFeature(){this.removeHandles("highlight-active-feature");
const {highlightEnabled:f,view:B,activeFeature:G,visible:u}=this;if(G&&B&&f&&u){var N=this._getHighlightLayer(G);if(N&&N instanceof z&&this._mapIncludesLayer(N)){var t=this._getLayerView(B,N);this._highlightActiveFeaturePromise=t;var r=await t;r&&v.highlightsSupported(r)&&this._highlightActiveFeaturePromise===t&&this.activeFeature&&this.highlightEnabled&&(N=r.highlight(this._getHighlightTarget(G,N,B.type)),this.addHandles(N,"highlight-active-feature"))}}}async _highlightSelectedFeature(){this.removeHandles("highlight-selected-feature");
const {selectedFeature:f,highlightEnabled:B,view:G,visible:u}=this;if(f&&G&&B&&u){var N=this._getHighlightLayer(f);if(N&&N instanceof z&&this._mapIncludesLayer(N)){var t=this._getLayerView(G,N);this._highlightSelectedFeaturePromise=t;var r=await t;r&&v.highlightsSupported(r)&&this._highlightSelectedFeaturePromise===t&&this.selectedFeature&&this.highlightEnabled&&this.visible&&(N=r.highlight(this._getHighlightTarget(f,N,G.type)),this.addHandles(N,"highlight-selected-feature"))}}}_updateFeatures(f){const {features:B}=
this;f=f.filter(G=>!B.includes(G));f?.length&&(this.features=B.concat(f))}};k.__decorate([c.property()],h.prototype,"_fetchFeaturesController",void 0);k.__decorate([c.property({type:d.ActionsCollection})],h.prototype,"actions",void 0);k.__decorate([c.property({readOnly:!0})],h.prototype,"active",null);k.__decorate([c.property()],h.prototype,"activeFeature",void 0);k.__decorate([c.property({readOnly:!0})],h.prototype,"allActions",null);k.__decorate([c.property()],h.prototype,"autoCloseEnabled",void 0);
k.__decorate([c.property()],h.prototype,"autoOpenEnabled",void 0);k.__decorate([c.property()],h.prototype,"browseClusterEnabled",void 0);k.__decorate([c.property()],h.prototype,"content",void 0);k.__decorate([c.property({type:d.ActionsCollection,readOnly:!0})],h.prototype,"defaultActions",null);k.__decorate([c.property({type:Boolean})],h.prototype,"defaultPopupTemplateEnabled",void 0);k.__decorate([c.property({readOnly:!0})],h.prototype,"featureCount",null);k.__decorate([c.property()],h.prototype,
"featurePage",void 0);k.__decorate([c.property({value:[]})],h.prototype,"features",null);k.__decorate([c.property()],h.prototype,"featuresPerPage",void 0);k.__decorate([c.property()],h.prototype,"featureMenuOpen",void 0);k.__decorate([c.property()],h.prototype,"featureViewModelAbilities",void 0);k.__decorate([c.property({readOnly:!0})],h.prototype,"featureViewModels",void 0);k.__decorate([c.property()],h.prototype,"highlightEnabled",void 0);k.__decorate([c.property()],h.prototype,"includeDefaultActions",
void 0);k.__decorate([c.property({type:O})],h.prototype,"location",null);k.__decorate([c.property({readOnly:!0})],h.prototype,"pendingPromisesCount",null);k.__decorate([c.property({readOnly:!0})],h.prototype,"promiseCount",null);k.__decorate([c.property()],h.prototype,"promises",null);k.__decorate([c.property({readOnly:!0})],h.prototype,"selectedClusterBoundaryFeature",void 0);k.__decorate([c.property({value:null,readOnly:!0})],h.prototype,"selectedFeature",null);k.__decorate([c.property({value:-1})],
h.prototype,"selectedFeatureIndex",null);k.__decorate([c.property({readOnly:!0})],h.prototype,"selectedFeatureViewModel",null);k.__decorate([c.property({readOnly:!0})],h.prototype,"state",null);k.__decorate([c.property()],h.prototype,"title",void 0);k.__decorate([c.property()],h.prototype,"updateLocationEnabled",void 0);k.__decorate([c.property()],h.prototype,"view",void 0);k.__decorate([c.property()],h.prototype,"visible",void 0);k.__decorate([c.property({readOnly:!0})],h.prototype,"waitingForContents",
null);k.__decorate([c.property({readOnly:!0})],h.prototype,"waitingForResult",null);k.__decorate([c.property()],h.prototype,"zoomFactor",void 0);k.__decorate([c.property()],h.prototype,"zoomToLocation",void 0);k.__decorate([c.property()],h.prototype,"centerAtLocation",null);return h=k.__decorate([g.subclass("esri.widgets.Features.FeaturesViewModel")],h)})},"esri/core/ReactiveSet":function(){define(["./accessorSupport/tracking","./accessorSupport/tracking/SimpleObservable"],function(b,k){class h{constructor(y){this._observable=
new k.SimpleObservable;this._set=new Set(y)}get size(){b.trackAccess(this._observable);return this._set.size}add(y){const w=this._set.size;this._set.add(y);this._set.size!==w&&this._observable.notify();return this}clear(){0<this._set.size&&(this._set.clear(),this._observable.notify())}delete(y){(y=this._set.delete(y))&&this._observable.notify();return y}entries(){b.trackAccess(this._observable);return this._set.entries()}forEach(y,w){b.trackAccess(this._observable);this._set.forEach((C,J)=>y.call(w,
C,J,this),w)}has(y){b.trackAccess(this._observable);return this._set.has(y)}keys(){b.trackAccess(this._observable);return this._set.keys()}values(){b.trackAccess(this._observable);return this._set.values()}[Symbol.iterator](){b.trackAccess(this._observable);return this._set[Symbol.iterator]()}get [Symbol.toStringTag](){return this._set[Symbol.toStringTag]}}return h})},"esri/layers/LayerConstants":function(){define(["exports"],function(b){b.fallbackObjectIDAttribute="OBJECTID";Object.defineProperty(b,
Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/symbolUtils":function(){define("require exports ../../core/has ../../support/arcadeOnDemand ./gfxUtils ./previewUtils ./renderUtils ./utils ../../widgets/Legend/styles/support/relationshipUtils ../../widgets/Legend/support/relationshipRampUtils".split(" "),function(b,k,h,y,w,C,J,K,Q,H){function F(q,z){if(z&&(q.style.filter=K.getCSSFilterFromEffectList(z),z=z.effects))for(const p of z)if("drop-shadow"===p?.type){0>p.offsetX?q.style.marginLeft=
`${Math.abs(p.offsetX)}px`:q.style.marginRight=`${p.offsetX}px`;break}}async function c(q,z){switch(q.type){case "web-style":var {previewWebStyleSymbol:p}=await new Promise((D,v)=>b(["./previewWebStyleSymbol"],D,v));return p(q,c,z);case "label-3d":case "line-3d":case "mesh-3d":case "point-3d":case "polygon-3d":return{previewSymbol3D:p}=await new Promise((D,v)=>b(["./previewSymbol3D"],D,v)),p(q,z);case "simple-marker":case "simple-line":case "simple-fill":case "picture-marker":case "picture-fill":case "text":return{previewSymbol2D:p}=
await new Promise((D,v)=>b(["./previewSymbol2D"],D,v)),p(q,z);case "cim":return{previewCIMSymbol:p}=await new Promise((D,v)=>b(["./previewCIMSymbol"],D,v)),p(q,z)}}function n(q){return q&&"opacity"in q?q.opacity*n(q.parent):1}function g(q){if(q)return"renderer"in q?q.renderer:void 0}let l=null;const x=[255,255,255];k.getDisplayedColor=async function(q,z){if(q){var {layer:p,sourceLayer:D}=q,v=n(p??D);if(null!=q.symbol&&(null==z||!0!==z.ignoreGraphicSymbol))return q="web-style"===q.symbol.type?await K.fetchWebStyleSymbol(q.symbol,
z):q.symbol.clone(),K.getColorFromSymbol(q,v);var e=z?.renderer??g(p)??g(D),d=e&&"getSymbolAsync"in e?await e.getSymbolAsync(q,z):void 0;if(d){d="web-style"===d.type?await K.fetchWebStyleSymbol(d,z):d.clone();d=K.getColorFromSymbol(d,v);if(!(e&&"visualVariables"in e)||"visualVariables"in e&&!e.visualVariables||"visualVariables"in e&&!e.visualVariables?.length)return d;"arcadeRequiredForVisualVariables"in e&&e.arcadeRequiredForVisualVariables&&null==z?.arcade&&(z={...z},z.arcade=await y.loadArcade());
var {getColor:a,getOpacity:m}=await new Promise((O,S)=>b(["../../renderers/visualVariables/support/visualVariableUtils"],O,S)),A=[],I=[];for(const O of e.visualVariables)switch(O.type){case "color":A.push(O);break;case "opacity":I.push(O)}e=(e=0<A.length?A[A.length-1]:null)?a(e,q,z):d;q=(d=0<I.length?I[I.length-1]:null)?m(d,q,z):null;null!=v&&(q=null!=q?q*v:v);return e?K.applyOpacityToColor(e,q):null}}};k.getDisplayedSymbol=async function(q,z){if(q){var p=q.sourceLayer,D=(null!=z&&(z.useSourceLayer??
!1)?p:q.layer)??p;p=n(D);if(null!=q.symbol&&(null==z||!0!==z.ignoreGraphicSymbol))return q="web-style"===q.symbol.type?await K.fetchWebStyleSymbol(q.symbol,{...z,cache:null!=z?z.webStyleCache:null}):q.symbol.clone(),K.applyColorToSymbol(q,null,p),q;var v=z?.renderer??g(D);if(D=v&&"getSymbolAsync"in v?await v.getSymbolAsync(q,z):null){D="web-style"===D.type?await D.fetchSymbol({...z,cache:null!=z?z.webStyleCache:null}):D.clone();if(!(v&&"visualVariables"in v&&v.visualVariables?.length))return K.applyColorToSymbol(D,
null,p),D;"arcadeRequiredForVisualVariables"in v&&v.arcadeRequiredForVisualVariables&&null==z?.arcade&&(z={...z},z.arcade=await y.loadArcade());var {getColor:e,getOpacity:d,getAllSizes:a,getRotationAngle:m}=await new Promise((B,G)=>b(["../../renderers/visualVariables/support/visualVariableUtils"],B,G)),A=[],I=[],O=[],S=[];for(var f of v.visualVariables)switch(f.type){case "color":A.push(f);break;case "opacity":I.push(f);break;case "rotation":S.push(f);break;case "size":f.target||O.push(f)}f=(f=!!A.length&&
A[A.length-1])?e(f,q,z):null;I=(I=!!I.length&&I[I.length-1])?d(I,q,z):null;null!=p&&(I=null!=I?I*p:p);K.applyColorToSymbol(D,f,I);O.length&&(p=a(O,q,z),await K.applySizesToSymbol(D,p));for(const B of S)K.applyRotationToSymbol(D,m(B,q,z),B.axis);return D}}};k.getLegendLabel=async function(q,z,p){if(q){var {layer:D,sourceLayer:v}=q,e=p?.renderer??g(D)??g(v);if(!e)return null;if("visualVariables"in e&&e.visualVariables?.length){const {getRampStops:a}=await new Promise((O,S)=>b(["../../widgets/Legend/support/colorRampUtils"],
O,S)),{getRampStops:m}=await new Promise((O,S)=>b(["../../widgets/Legend/support/sizeRampUtils"],O,S)),{getDateFormatOptions:A}=await new Promise((O,S)=>b(["../../widgets/Legend/support/utils"],O,S));let I=null;for(const O of e.visualVariables){var d=z?A(D,O,z.timeZone):null;let S=null;switch(O.type){case "color":S=await a(O,null,d);break;case "opacity":S=await a(O);break;case "size":O.target||(S=await m(e,O,null,p?.scale||z?.scale,z,d))}if(S?.length&&(d=S.find((f,B)=>{const G=q.attributes[O.field];
return 0===B?G>=f.value:B===S?.length-1?G<=f.value:f.value===G}))){I=d.label;break}}if(I)return I}switch(e.type){case "class-breaks":return z="getClassBreakInfo"in e?await e.getClassBreakInfo(q,p):null,z?.label??(z&&1<e.classBreakInfos?.length)?`${z.minValue} - ${z.maxValue}`:null;case "unique-value":return("getUniqueValueInfo"in e?await e.getUniqueValueInfo(q,p):null)?.label}return null}};k.renderColorRampPreviewHTML=function(q,z={}){var p="horizontal"===z.align;const D=z.width??(p?75:24),v=z.height??
(p?24:75);var e=z.gradient??!0,d=window.devicePixelRatio,a=D*d,m=v*d;d=document.createElement("canvas");d.width=a;d.height=m;d.ariaLabel=z.ariaLabel??null;d.style.width=`${D}px`;d.style.height=`${v}px`;const A=d.getContext("2d");var I=p?a:0;const O=p?0:m;if(e){const S=A.createLinearGradient(0,0,I,O);p=q.length;const f=1===p?0:1/(p-1);q.forEach((B,G)=>S.addColorStop(G*f,B.toString()));A.fillStyle=S;A.fillRect(0,0,a,m)}else{a=p?a/q.length:a;m=p?m:m/q.length;I=e=0;for(const S of q)A.fillStyle=S.toString(),
A.fillRect(e,I,a,m),e=p?e+a:0,I=p?0:I+m}q=document.createElement("div");q.style.width=`${D}px`;q.style.height=`${v}px`;F(q,z?.effectList);q.appendChild(d);return q};k.renderDotDensityPreviewHTML=function(q,z,p){const {backgroundColor:D,outline:v,dotSize:e}=q;var d=p?.swatchSize||C.SymbolSizeDefaults.size;const a=Math.round(d*d/Math.max(e,.5)**2*.8),m=window.devicePixelRatio;q=document.createElement("canvas");const A=d*m;q.width=A;q.height=A;q.style.width=`${q.width/m}px`;q.style.height=`${q.height/
m}px`;const I=q.getContext("2d");D&&(I.fillStyle=D.toCss(!0),I.fillRect(0,0,A,A),I.fill());I.fillStyle=z?.toCss(!0)??"";if(l&&l.length/2===a)for(z=0;z<2*a;z+=2)I.fillRect(l[z],l[z+1],e*m,e*m),I.fill();else for(l=[],z=0;z<2*a;z+=2){const O=Math.floor(Math.random()*(A-0+1)),S=Math.floor(Math.random()*(A-0+1));l.push(O,S);I.fillRect(O,S,e*m,e*m);I.fill()}v&&(v.color&&(I.strokeStyle=v.color.toCss(!0)),I.lineWidth=v.width,I.strokeRect(0,0,A,A));d=new Image(d,d);d.src=q.toDataURL();d.ariaLabel=p?.ariaLabel??
null;d.alt=p?.ariaLabel??"";return d};k.renderPieChartPreviewHTML=function(q,z={}){const p=z.radius||40;var D=2*Math.PI*p,v=q.length;const e=D/v,d=[],a=w.getStroke(z.outline);null!=a?.width&&(a.width*=2);(a||z.backgroundColor)&&d.push({shape:{type:"circle",cx:p,cy:p,r:p},fill:z.backgroundColor,stroke:a,offset:[0,0]});const m=z.values,A=m&&m.length===v&&100===m.reduce((O,S)=>O+S,0),I=[0];for(let O=0;O<v;O++){let S=null;A&&(S=m[O]*D/100,I.push(S+I[O]));d.push({shape:{type:"circle",cx:p,cy:p,r:p/2},
fill:[0,0,0,0],stroke:{width:p,dashArray:`${(S??e)/2} ${D}`,dashoffset:`-${A?I[O]/2:e/2*O}`,color:q[O]},offset:[0,0]})}v=null;q=2*p+(a?.width||0);if(D=z.holePercentage)a&&d.push({shape:{type:"circle",cx:p,cy:p,r:p*D},fill:null,stroke:a,offset:[0,0]}),v=q/2,v=[[{shape:{type:"circle",cx:v,cy:v,r:v},fill:x,stroke:a?{...a,color:x}:null,offset:[0,0]},{shape:{type:"circle",cx:v,cy:v,r:p*D},fill:[0,0,0],stroke:null,offset:[0,0]}]];return J.renderSymbol([d],[q,q],{effectView:z.effectList,ignoreStrokeWidth:!0,
masking:v,rotation:-90,ariaLabel:z.ariaLabel})};k.renderPreviewHTML=c;k.renderRelationshipRampPreviewHTML=function(q,z={}){const p=q?.authoringInfo;if("relationship"!==p?.type||!p?.numClasses||!q.uniqueValueInfos)return null;const {focus:D,numClasses:v}=p,e=H.getRelationshipRampElement({focus:D,numClasses:v,infos:q.uniqueValueInfos});q=z?.node||document.createElement("div");J.renderOnce(q,()=>Q.renderRelationshipRamp(e,z.id||"relationship",{opacity:z.opacity||1,effectList:z.effectList,ariaLabel:z.ariaLabel}));
return q};Object.defineProperty(k,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/previewUtils":function(){define(["exports","../../Color"],function(b,k){function h(y,w){return Math.round(Math.min(Math.max(y+191.25*w,0),255))}b.SymbolSizeDefaults=void 0;(function(y){y[y.size=22]="size";y[y.lineWidth=50]="lineWidth";y[y.maxSize=120]="maxSize";y[y.maxOutlineSize=80]="maxOutlineSize";y[y.tallSymbolWidth=20]="tallSymbolWidth"})(b.SymbolSizeDefaults||(b.SymbolSizeDefaults={}));b.adjustColorBrightness=
function(y,w){if(null==y)return new k;if("type"in y&&("linear"===y.type||"pattern"===y.type))return y;y=new k(y);return new k([h(y.r,w),h(y.g,w),h(y.b,w),y.a])};b.adjustColorComponentBrightness=h;b.getConeShapes=function(y,w){let C=w?b.SymbolSizeDefaults.tallSymbolWidth:y;w=w?4:6;C=C<=b.SymbolSizeDefaults.size?C-.5*w:C-w;w=.15*C;const J=C;y-=w;return[{type:"ellipse",cx:.5*C,cy:y,rx:.5*C,ry:w},{type:"path",path:[{command:"M",values:[.5*J,0]},{command:"L",values:[J,y]},{command:"L",values:[0,y]},{command:"Z",
values:[]}]}]};b.getCubeShapes=function(y,w){let C=w?b.SymbolSizeDefaults.tallSymbolWidth:y;var J=w?4:6;J=C=C<=b.SymbolSizeDefaults.size?C-.5*J:C-J;w=w?.35*C:.5*C;return[{type:"path",path:[{command:"M",values:[.5*J,0]},{command:"L",values:[J,.5*w]},{command:"L",values:[.5*J,w]},{command:"L",values:[0,.5*w]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*w]},{command:"L",values:[.5*J,w]},{command:"L",values:[.5*J,y]},{command:"L",values:[0,y-.5*w]},{command:"Z",values:[]}]},
{type:"path",path:[{command:"M",values:[.5*J,w]},{command:"L",values:[.5*J,y]},{command:"L",values:[J,y-.5*w]},{command:"L",values:[J,.5*w]},{command:"Z",values:[]}]}]};b.getCylinderShapes=function(y,w){var C=w?b.SymbolSizeDefaults.tallSymbolWidth:y;w=w?4:6;C=C<=b.SymbolSizeDefaults.size?C-.5*w:C-w;w=.5*C;const J=.15*C;y-=J;return[{type:"ellipse",cx:.5*C,cy:y,rx:w,ry:J},{type:"path",path:[{command:"M",values:[0,J]},{command:"L",values:[0,y]},{command:"L",values:[C,y]},{command:"L",values:[C,J]},{command:"Z",
values:[]}]},{type:"ellipse",cx:.5*C,cy:J,rx:w,ry:J}]};b.getDiamondShapes=function(y){var w=y;w=w<b.SymbolSizeDefaults.size?w-2:w-4;const C=Math.floor(y/10)-1||1;return[{type:"path",path:[{command:"M",values:[.45*w,0]},{command:"L",values:[w,.5*y-C]},{command:"L",values:[.45*w-C,.5*y+C]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*w,0]},{command:"L",values:[.45*w-C,.5*y+C]},{command:"L",values:[0,.5*y-C]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,
.5*y-C]},{command:"L",values:[.45*w-C,.5*y+C]},{command:"L",values:[.45*w,y]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*w,y]},{command:"L",values:[w,.5*y-C]},{command:"L",values:[.45*w-C,.5*y+C]},{command:"Z",values:[]}]}]};b.getExtrudeSymbolShapes=function(y){const w=b.SymbolSizeDefaults.size;y*=.5;return[{type:"path",path:[{command:"M",values:[0,.35*w]},{command:"L",values:[.3*w,.7*w]},{command:"L",values:[.3*w,.7*w+y]},{command:"L",values:[0,.7*w+y-.35*w]},{command:"Z",
values:[]}]},{type:"path",path:[{command:"M",values:[.3*w,.7*w]},{command:"L",values:[.3*w,.7*w+y]},{command:"L",values:[w,y]},{command:"L",values:[w,0]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*w,0]},{command:"L",values:[w,0]},{command:"L",values:[.3*w,.7*w]},{command:"L",values:[0,.35*w]},{command:"Z",values:[]}]}]};b.getInvertedConeShapes=function(y){let w=y;w=w<b.SymbolSizeDefaults.size?w-3:w-6;const C=.15*w,J=w;return[{type:"path",path:[{command:"M",values:[0,0]},
{command:"L",values:[J,0]},{command:"L",values:[.5*J,y-C]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*w,cy:0,rx:.5*w,ry:C}]};b.getPathSymbolShapes=function(y,w,C){var J=b.SymbolSizeDefaults.size;let K=J,Q=J;1>y?K*=.75:1<y&&(Q*=1.25);y=J;w&&C&&(K=Q=y=J=0);return[{type:"path",path:[{command:"M",values:[y,0]},{command:"L",values:[C?y:.875*y,0]},{command:"L",values:[C?K-.5*y:0,Q-.5*J]},{command:"L",values:[K-.5*y,Q-.5*J]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[y,0]},{command:"L",
values:[y,w?0:.125*J]},{command:"L",values:[K-.5*y,w?Q-.5*J:J]},{command:"L",values:[K-.5*y,Q-.5*J]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[K-.5*y,Q-.5*J]},{command:"L",values:[C?K-.5*y:0,Q-.5*J]},{command:"L",values:[C?K-.5*y:0,w?Q-.5*J:J]},{command:"L",values:[K-.5*y,w?Q-.5*J:J]},{command:"Z",values:[]}]}]};b.getTetrahedronShapes=function(y){var w=y;w=w<b.SymbolSizeDefaults.size?w-1:w-2;return[{type:"path",path:[{command:"M",values:[.45*y,0]},{command:"L",values:[y,w]},
{command:"L",values:[.45*y,.6*w]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*y,0]},{command:"L",values:[.45*y,.6*w]},{command:"L",values:[0,w]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,w]},{command:"L",values:[.45*y,.6*w]},{command:"L",values:[y,w]},{command:"Z",values:[]}]}]};b.getWaterSymbolShapes=function(){return[{type:"path",path:"M80,80.2v-27c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4C8.3,59.3,5.7,58,3.9,56c-1.1-1.2-2.4-2.1-3.9-2.8v27"},
{type:"path",path:"M11,59.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8v-24c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-1.1-1.2-2.4-2.1-3.9-2.8v24c1.5,0.7,2.8,1.6,3.9,2.8C5.7,58,8.3,59.3,11,59.4z"},
{type:"path",path:"M11,35.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8V3.6c-1.5,0.7-2.8,1.6-3.9,2.8c-2.2,2.1-4.6,3.4-7.1,3.4s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6S42.5,9.9,40,9.9s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.5,0-5-1.3-7.1-3.4C2.8,5.3,1.4,4.3,0,3.6v25.6c1.5,0.7,2.8,1.6,3.9,2.8C5.7,34.1,8.3,35.3,11,35.4z"}]};
b.shapes={fill:[{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"}],squareFill:[{type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 Z"}],meshSymbol3DFill:[{type:"path",path:"M -10,-8 L 6,0 L 6,6 L -10,6 L -10,-8 Z"},{type:"path",path:"M -10,-8 L -7,-10 L 9,-2 L 6,0 L -10,-8 Z"},{type:"path",path:"M 6,0 L 9,-2 L 9,4 L 6,6 L 6,0 Z"}],pathSymbol3DLayer:[{type:"path",path:"M 3,12 L 12,0 L 11,-2 L -4,5 L -1,5 L 1,7 L 3,10 L 3,12 Z"},{type:"circle",cx:-2,cy:10,r:5}],extrudeSymbol3DLayer:[{type:"path",
path:"M -7,-5 L -2,0 L -2,7 L -7,3 L -7,-5 Z"},{type:"path",path:"M -2,0 L -2,7 L 10,-3 L 10,-10 L -2,0 Z"},{type:"path",path:"M -7,-5 L -2,0 L 10,-10 L -2,-10 L -7,-5 Z"}],cone:[{type:"path",path:"M 0,-10 L -8,5 L -4,6.5 L 0,7 L 4,6.5 L 8,5 Z"}],tallCone:[{type:"path",path:"M 0,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 0,-9 Z"}],invertedCone:[{type:"path",path:"M 0,7 L -8,-8 L 8,-8 Z"},{type:"path",path:"M -8,-8 L -4,-9.5 L 0,-10 L 4,-9.5 L 8,-8 L 4,-6.5 L 0,-6 L -4,-6.5 Z"}],cube:[{type:"path",
path:"M -10,-7 L 0,-12 L 10,-7 L 0,-2 L -10,-7 Z"},{type:"path",path:"M -10,-7 L 0,-2 L 0,12 L -10,7 L -10,-7 Z"},{type:"path",path:"M 0,-2 L 10,-7 L 10,7 L 0,12 L 0,-2 Z"}],tallCube:[{type:"path",path:"M -3.5,-8.5 L 0,-9.5 L 3.5,-8.5 L 0,-7.5 L -3.5,-8.5 Z"},{type:"path",path:"M -3.5,-8.5 L 0,-7.5 L 0,9 L -3.5,8 L -3.5,-8.5 Z"},{type:"path",path:"M 0,-7.5 L 3.5,-8.5 L 3.5,8 L 0,9 L 0,-7.5 Z"}],cylinder:[{type:"path",path:"M -8,-9 L -8,7 L -4,8.5 L 0,9 L 4,8.5 L 8,7 L 8,-9 Z"},{type:"ellipse",cx:0,
cy:-9,rx:8,ry:2}],tallCylinder:[{type:"path",path:"M -3.5,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 3.5,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:3.5,ry:1}],diamond:[{type:"path",path:"M 0,-10 L 10,-1 L -1,1 L 0,-10 Z"},{type:"path",path:"M 0,-10 L -1,1 L -8,-1 L 0,-10 Z"},{type:"path",path:"M -1,1 L 0,10 L -8,-1 L -1,1 Z"},{type:"path",path:"M -1,0 L 0,10 L 10,-1 L -1,1 Z"}],tetrahedron:[{type:"path",path:"M 0,-10 L 10,7 L 0,0 L 0,-10 Z"},{type:"path",path:"M 0,-10 L 0,0 L -8,7 L 0,-10 Z"},{type:"path",
path:"M 10,7 L 0,0 L -8,7 L 10,7 Z"}]};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/renderUtils":function(){define("exports ../../kernel ../../request ../../core/colorUtils ../../core/Error ../../core/has ../../libs/maquette/projection ../../libs/maquette/projector ./svgUtils ./utils".split(" "),function(b,k,h,y,w,C,J,K,Q,H){function F(g,l){n.append(g,l);n.detach(l)}function c(g,l,x){return g?h(g,{responseType:"image"}).then(q=>{q=q.data;const z=q.width,p=
q.height,D=z/p;let v=l;x&&(v=Math.min(v,Math.max(z,p)));return{image:q,width:1>=D?Math.ceil(v*D):v,height:1>=D?v:Math.ceil(v/D)}}):Promise.reject(new w("renderUtils: imageDataSize","href not provided."))}const n=K.createProjector();b.renderOnce=F;b.renderSymbol=function(g,l,x){const q=Math.ceil(l[0]),z=Math.ceil(l[1]);if(!g.some(p=>!!p.length))return null;l=x?.node||document.createElement("div");null!=x.opacity&&(l.style.opacity=x.opacity.toString());null!=x.effectView&&(l.style.filter=H.getCSSFilterFromEffectList(x.effectView));
F(l,()=>Q.renderSVG(g,q,z,x));return l};b.tintImageWithColor=function(g,l,x,q,z){return c(g,l,z).then(p=>{const D=p.width??l,v=p.height??l;var e;if(e=p.image)e=x&&"ignore"!==q?"multiply"===q&&255===x.r&&255===x.g&&255===x.b&&1===x.a?!1:!0:!1;if(e){var d=p.image.width,a=p.image.height;C("edge")&&/\.svg$/i.test(g)&&(--d,--a);e=Math.ceil(D);var m=Math.ceil(v);var A=document.createElement("canvas");A.width=e;A.height=m;A.style.width=e+"px";A.style.height=m+"px";A=A.getContext("2d");A.clearRect(0,0,e,
m);e=A;e.drawImage(p.image,0,0,d,a,0,0,D,v);m=e.getImageData(0,0,D,v);A=[x.r/255,x.g/255,x.b/255,x.a];const O=y.toHSV(x);for(let S=0;S<m.data.length;S+=4){p=m.data;d=S;a=A;var I=O;switch(q){case "multiply":p[d]*=a[0];p[d+1]*=a[1];p[d+2]*=a[2];p[d+3]*=a[3];break;default:const f=y.toHSV({r:p[d],g:p[d+1],b:p[d+2]});f.h=I.h;f.s=I.s;f.v=f.v/100*I.v;I=y.toRGB(f);p[d]=I.r;p[d+1]=I.g;p[d+2]=I.b;p[d+3]*=a[3]}}e.putImageData(m,0,0);g=e.canvas.toDataURL("image/png")}else e=k.id?.findCredential(g),e?.token&&
(p=g.includes("?")?"\x26":"?",g=`${g}${p}token=${e.token}`);return{url:g,width:D,height:v}}).catch(()=>({url:g,width:l,height:l}))};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/svgUtils":function(){define("exports ../../Color ../../core/has ../../core/maybe ../../core/libs/gl-matrix-2/factories/mat2df32 ../../core/libs/gl-matrix-2/math/mat2d ./gfxUtils ../../widgets/support/widgetUtils ../../widgets/support/jsxFactory".split(" "),function(b,k,h,y,w,C,J,K,Q){function H(t,
r){t*=u/180;return Math.abs(r*Math.sin(t))+Math.abs(r*Math.cos(t))}function F(t){return t.map(r=>`${r.command} ${r.values.join(" ")}`).join(" ").trim()}function c(t,r,E,P,U){if(t){if("circle"===t.type)return Q.tsx("circle",{cx:t.cx,cy:t.cy,fill:r,"fill-rule":"evenodd",r:t.r,stroke:E.color,"stroke-dasharray":E.dashArray,"stroke-dashoffset":E.dashOffset,"stroke-linecap":E.cap,"stroke-linejoin":E.join,"stroke-miterlimit":"4","stroke-width":E.width});if("ellipse"===t.type)return Q.tsx("ellipse",{cx:t.cx,
cy:t.cy,fill:r,"fill-rule":"evenodd",rx:t.rx,ry:t.ry,stroke:E.color,"stroke-dasharray":E.dashArray,"stroke-linecap":E.cap,"stroke-linejoin":E.join,"stroke-miterlimit":"4","stroke-width":E.width});if("rect"===t.type)return Q.tsx("rect",{fill:r,"fill-rule":"evenodd",height:t.height,stroke:E.color,"stroke-dasharray":E.dashArray,"stroke-linecap":E.cap,"stroke-linejoin":E.join,"stroke-miterlimit":"4","stroke-width":E.width,width:t.width,x:t.x,y:t.y});if("image"===t.type)return Q.tsx("image",{alt:U||"image",
height:t.height,href:t.src,preserveAspectRatio:"none",width:t.width,x:t.x,y:t.y});if("path"===t.type)return t="string"!==typeof t.path?F(t.path):t.path,Q.tsx("path",{d:t,fill:r,"fill-rule":"evenodd",stroke:E.color,"stroke-dasharray":E.dashArray,"stroke-linecap":E.cap,"stroke-linejoin":E.join,"stroke-miterlimit":"4","stroke-width":E.width});if("text"===t.type)return y.assertIsSome(P),Q.tsx("text",{"dominant-baseline":P.dominantBaseline,fill:r,"fill-rule":"evenodd","font-family":P.font.family,"font-size":P.font.size,
"font-style":P.font.style,"font-variant":P.font.variant,"font-weight":P.font.weight,kerning:P.kerning,rotate:P.rotate,stroke:E.color,"stroke-dasharray":E.dashArray,"stroke-linecap":E.cap,"stroke-linejoin":E.join,"stroke-miterlimit":"4","stroke-width":E.width,"text-anchor":P.align,"text-decoration":P.decoration,"text-rendering":O,x:t.x,y:t.y},t.text)}return null}function n(t){const r={fill:"none",pattern:null,linearGradient:null};if(t)if("type"in t&&"pattern"===t.type){var E=`patternId-${++A}`;r.fill=
`url(#${E})`;r.pattern={id:E,x:t.x,y:t.y,width:t.width,height:t.height,image:{x:0,y:0,width:t.width,height:t.height,href:t.src}}}else"type"in t&&"linear"===t.type?(E=`linearGradientId-${++I}`,r.fill=`url(#${E})`,r.linearGradient={id:E,x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,stops:t.colors.map(P=>({offset:P.offset,color:P.color&&(new k(P.color)).toString()}))}):t&&(t=new k(t),r.fill=t.toString());return r}function g(t){const r={color:"none",width:1,cap:"butt",join:"4",dashArray:"none",dashOffset:"0"};t&&(null!=
t.width&&(r.width=t.width),t.cap&&(r.cap=t.cap),t.join&&(r.join=t.join.toString()),t.color&&(r.color=(new k(t.color)).toString()),t.dashArray&&(r.dashArray=t.dashArray),t.dashoffset&&(r.dashOffset=t.dashoffset),t.style&&!t.dashArray&&(r.dashArray=J.getDashArray(t).join(",")||"none"));return r}function l(t,r){const E={align:null,decoration:null,kerning:null,rotate:null,font:{style:null,variant:null,weight:null,size:null,family:null}};if(t){const P=t.alignBaseline;E.align=t.align;E.dominantBaseline=
"baseline"===P?"auto":"top"===P?"text-top":"bottom"===P?"hanging":P;E.decoration=t.decoration;E.kerning=t.kerning?"auto":"0";E.rotate=t.rotated?"90":"0";y.assertIsSome(r);E.font.style=r.style||"normal";E.font.variant=r.variant||"normal";E.font.weight=r.weight||"normal";E.font.size=r.size&&r.size.toString()||"10pt";E.font.family=r.family||"serif"}return E}function x(t){const {pattern:r,linearGradient:E}=t;return r?Q.tsx("pattern",{height:r.height,id:r.id,patternUnits:"userSpaceOnUse",width:r.width,
x:r.x,y:r.y},Q.tsx("image",{height:r.image.height,href:r.image.href,width:r.image.width,x:r.image.x,y:r.image.y})):E?(t=E.stops.map((P,U)=>Q.tsx("stop",{key:`${U}-stop`,offset:P.offset,"stop-color":P.color})),Q.tsx("linearGradient",{gradientUnits:"userSpaceOnUse",id:E.id,x1:E.x1,x2:E.x2,y1:E.y1,y2:E.y2},t)):null}function q(t,r){if(!t||0===t.length)return null;const E=[];for(const P of t){const {shape:U,fill:W,stroke:aa,font:da}=P;t=n(W);const Z=g(aa),fa="text"===U.type?l(U,da):null;(t=c(U,t.fill,
Z,fa))&&E.push(t)}return Q.tsx("mask",{id:r,maskUnits:"userSpaceOnUse"},Q.tsx("g",null,E))}function z(t,r,E,P,U){C.scale(t,C.identity(t),[r,E]);t[4]=t[4]*r-P*r+P;t[5]=t[5]*E-U*E+U;return t}function p(t,r){if(B&&"left"in B){null!=B.left&&B.left>t&&(B.left=t);if(null==B.right||B.right<t)B.right=t;if(null==B.top||B.top>r)B.top=r;if(null==B.bottom||B.bottom<r)B.bottom=r}else B={left:t,bottom:r,right:t,top:r}}function D(t){const r=t.args,E=r.length;switch(t.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(t=
0;t<E;t+=2)p(r[t],r[t+1]);G.x=r[E-2];G.y=r[E-1];break;case "H":for(t=0;t<E;++t)p(r[t],G.y);G.x=r[E-1];break;case "V":for(t=0;t<E;++t)p(G.x,r[t]);G.y=r[E-1];break;case "m":t=0;"x"in G||(p(G.x=r[0],G.y=r[1]),t=2);for(;t<E;t+=2)p(G.x+=r[t],G.y+=r[t+1]);break;case "l":case "t":for(t=0;t<E;t+=2)p(G.x+=r[t],G.y+=r[t+1]);break;case "h":for(t=0;t<E;++t)p(G.x+=r[t],G.y);break;case "v":for(t=0;t<E;++t)p(G.x,G.y+=r[t]);break;case "c":for(t=0;t<E;t+=6)p(G.x+r[t],G.y+r[t+1]),p(G.x+r[t+2],G.y+r[t+3]),p(G.x+=r[t+
4],G.y+=r[t+5]);break;case "s":case "q":for(t=0;t<E;t+=4)p(G.x+r[t],G.y+r[t+1]),p(G.x+=r[t+2],G.y+=r[t+3]);break;case "A":for(t=0;t<E;t+=7)p(r[t+5],r[t+6]);G.x=r[E-2];G.y=r[E-1];break;case "a":for(t=0;t<E;t+=7)p(G.x+=r[t+5],G.y+=r[t+6])}}function v(t,r,E){const P=S[t.toLowerCase()];"number"===typeof P&&(P?r.length>=P&&(t={action:t,args:r.slice(0,r.length-r.length%P)},E.push(t),D(t)):(t={action:t,args:[]},E.push(t),D(t)))}function e(t){const r={x:0,y:0,width:0,height:0};if("circle"===t.type)r.x=t.cx-
t.r,r.y=t.cy-t.r,r.width=2*t.r,r.height=2*t.r;else if("ellipse"===t.type)r.x=t.cx-t.rx,r.y=t.cy-t.ry,r.width=2*t.rx,r.height=2*t.ry;else if("image"===t.type||"rect"===t.type)r.x=t.x,r.y=t.y,r.width=t.width,r.height=t.height;else if("path"===t.type){{const U=("string"!==typeof t.path?F(t.path):t.path).match(f),W=[];B={};G={};if(U){t="";var E=[],P=U.length;for(let aa=0;aa<P;++aa){const da=U[aa],Z=parseFloat(da);isNaN(Z)?(t&&v(t,E,W),E=[],t=da):E.push(Z)}v(t,E,W);t={x:0,y:0,width:0,height:0};B&&"left"in
B&&(t.x=B.left,t.y=B.top,t.width=B.right-B.left,t.height=B.bottom-B.top)}else t=null}r.x=t.x;r.y=t.y;r.width=t.width;r.height=t.height}return r}function d(t){const r={x:0,y:0,width:0,height:0};let E=null,P=Number.NEGATIVE_INFINITY,U=Number.NEGATIVE_INFINITY;for(const W of t)E?(E.x=Math.min(E.x,W.x),E.y=Math.min(E.y,W.y),P=Math.max(P,W.x+W.width),U=Math.max(U,W.y+W.height)):(E=r,E.x=W.x,E.y=W.y,P=W.x+W.width,U=W.y+W.height);E&&(E.width=P-E.x,E.height=U-E.y);return E}function a(t,r,E,P,U,W,aa,da,Z){var fa=
(aa&&W?H(W,r):r)/2,Y=(aa&&W?H(W,E):E)/2;if(Z){var ba=Z[0];Z=Z[1];fa=(aa&&W?H(W,ba):ba)/2;Y=(aa&&W?H(W,Z):Z)/2}ba=t.width+P;var L=t.height+P;Z=w.create();aa=w.create();var M=!1;if(U&&0!==ba&&0!==L){U=r!==E?r/E:ba/L;M=r>E?r:E;let R=1,T=1;isNaN(M)||(1<U?(R=M/ba,T=M/U/L):(T=M/L,R=M*U/ba));C.multiply(aa,aa,z(Z,R,T,fa,Y));M=!0}U=t.x+(ba-P)/2;t=t.y+(L-P)/2;P=C.multiply;fa-=U;Y-=t;fa=C.translate(Z,C.identity(Z),[fa,Y]);P.call(C,aa,aa,fa);!M&&(ba>r||L>E)&&(fa=ba/r>L/E,r=(fa?r:E)/(fa?ba:L),C.multiply(aa,aa,
z(Z,r,r,U,t)));W&&(r=C.multiply,E=W%360*Math.PI/180,C.rotate(Z,C.identity(Z),E),W=Math.cos(E),E=Math.sin(E),ba=Z[4],L=Z[5],Z[4]=ba*W-L*E+t*E-U*W+U,Z[5]=L*W+ba*E-U*E-t*W+t,r.call(C,aa,aa,Z));da&&(W=C.multiply,r=da[0],da=da[1],da=C.translate(Z,C.identity(Z),[r,da]),W.call(C,aa,aa,da));return`matrix(${aa[0]},${aa[1]},${aa[2]},${aa[3]},${aa[4]},${aa[5]})`}function m(t,r,E){t=t?.effects.find(da=>"bloom"===da.type);if(!t)return null;const {strength:P,radius:U}=t;t=0<P?U:0;const W=(P+t)*r,aa=4*P+1;return Q.tsx("filter",
{filterUnits:"userSpaceOnUse",height:"300%",id:`bloom${E}`,width:"300%",x:"-100%",y:"-100%"},Q.tsx("feMorphology",{in:"SourceGraphic",operator:"dilate",radius:(P+.5*t)*5**(r/100)*(.4+r/100),result:"dilate"}),Q.tsx("feGaussianBlur",{in:"dilate",result:"blur",stdDeviation:W/25}),Q.tsx("feGaussianBlur",{in:"blur",result:"intensityBlur",stdDeviation:W/50}),Q.tsx("feComponentTransfer",{in:"SourceGraphic",result:"intensityBrightness"},Q.tsx("feFuncR",{slope:aa,type:"linear"}),Q.tsx("feFuncG",{slope:aa,
type:"linear"}),Q.tsx("feFuncB",{slope:aa,type:"linear"})),Q.tsx("feMerge",null,Q.tsx("feMergeNode",{in:"intensityBlur"}),Q.tsx("feMergeNode",{in:"intensityBrightness"}),Q.tsx("feGaussianBlur",{stdDeviation:P/10})))}let A=0,I=0;K=h("android");const O=h("chrome")||K&&4<=K?"auto":"optimizeLegibility",S={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},f=/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g;let B={},G={};const u=Math.PI;let N=1;b.computeBBox=d;b.generateFillAttributes=n;b.generateStrokeAttributes=
g;b.generateTextAttributes=l;b.getBoundingBox=e;b.getTransformMatrix=a;b.renderDef=x;b.renderSVG=function(t,r,E,P={}){const U=[],W=[],aa=++N,da=m(P.effectView,r,aa);var Z=null;da&&(Z=P.effectView?.effects.find(M=>"bloom"===M.type),Z=(Z.strength?Z.strength+Z.radius/2:0)/3,Z=[Math.max(r+r*Z,10),Math.max(E+E*Z,10)]);for(let M=0;M<t.length;M++){var fa=t[M];const R=[];var Y=[],ba=0,L=0;let T=0;for(const V of fa){const {shape:X,fill:ca,stroke:ea,font:ha,offset:ia}=V;P.ignoreStrokeWidth||"text"===X.type||
(ba+=ea?.width||0);fa=n(ca);const ja=g(ea),ka="text"===X.type?l(X,ha):null;U.push(x(fa));R.push(c(X,fa.fill,ja,ka,P.ariaLabel));Y.push(e(X));ia&&(L+=ia[0],T+=ia[1])}Y=d(Y);ba=a(Y,r,E,ba,P.scale??!1,P.rotation,P.useRotationSize??!1,[L,T],Z);L=null;P.masking&&(L=`mask-${M}`,U.push(q(P.masking[M],L)),L=`url(#${L})`);W.push(L?Q.tsx("g",{mask:L},Q.tsx("g",{transform:ba},R)):Q.tsx("g",{transform:ba},R))}P.useRotationSize&&P.rotation&&(r=H(P.rotation,r),E=H(P.rotation,E));da&&(y.assertIsSome(Z),r=Z[0],E=
Z[1]);return Q.tsx("svg",{"aria-labelledby":P.ariaLabel,focusable:!1,height:E,role:"img",style:"display: block;",width:r,xmlns:"http://www.w3.org/2000/svg"},da,Q.tsx("defs",null,U),da?Q.tsx("g",{filter:`url(#bloom${aa})`},W):W)};b.renderShape=c;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/gl-matrix-2/factories/mat2df32":function(){define(["exports"],function(b){function k(){const Q=new Float32Array(6);Q[0]=1;Q[3]=1;return Q}function h(Q){const H=new Float32Array(6);
H[0]=Q[0];H[1]=Q[1];H[2]=Q[2];H[3]=Q[3];H[4]=Q[4];H[5]=Q[5];return H}function y(Q,H,F,c,n,g){const l=new Float32Array(6);l[0]=Q;l[1]=H;l[2]=F;l[3]=c;l[4]=n;l[5]=g;return l}function w(Q,H){return new Float32Array(Q,H,6)}function C(Q,H,F,c){const n=H[c];H=H[c+1];Q[c]=F[0]*n+F[2]*H+F[4];Q[c+1]=F[1]*n+F[3]*H+F[5]}function J(Q,H,F,c=0,n=0,g=2){for(n=n||H.length/g;c<n;c++)C(Q,H,F,c*g)}const K=Object.freeze(Object.defineProperty({__proto__:null,clone:h,create:k,createView:w,fromValues:y,transform:C,transformMany:J},
Symbol.toStringTag,{value:"Module"}));b.clone=h;b.create=k;b.createView=w;b.fromValues=y;b.mat2df32=K;b.transform=C;b.transformMany=J;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/gl-matrix-2/math/mat2d":function(){define(["exports","./common"],function(b,k){function h(a,m){a[0]=m[0];a[1]=m[1];a[2]=m[2];a[3]=m[3];a[4]=m[4];a[5]=m[5];return a}function y(a){a[0]=1;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;return a}function w(a,m,A,I,O,S,f){a[0]=m;a[1]=A;a[2]=I;a[3]=O;a[4]=
S;a[5]=f;return a}function C(a,m){const A=m[0],I=m[1],O=m[2],S=m[3],f=m[4];m=m[5];let B=A*S-I*O;if(!B)return null;B=1/B;a[0]=S*B;a[1]=-I*B;a[2]=-O*B;a[3]=A*B;a[4]=(O*m-S*f)*B;a[5]=(I*f-A*m)*B;return a}function J(a){return a[0]*a[3]-a[1]*a[2]}function K(a,m,A){const I=m[0],O=m[1],S=m[2],f=m[3],B=m[4];m=m[5];const G=A[0],u=A[1],N=A[2],t=A[3],r=A[4];A=A[5];a[0]=I*G+S*u;a[1]=O*G+f*u;a[2]=I*N+S*t;a[3]=O*N+f*t;a[4]=I*r+S*A+B;a[5]=O*r+f*A+m;return a}function Q(a,m,A){const I=m[0],O=m[1],S=m[2],f=m[3],B=
m[4];m=m[5];const G=Math.sin(A);A=Math.cos(A);a[0]=I*A+S*G;a[1]=O*A+f*G;a[2]=I*-G+S*A;a[3]=O*-G+f*A;a[4]=B;a[5]=m;return a}function H(a,m,A){const I=m[1],O=m[2],S=m[3],f=m[4],B=m[5],G=A[0];A=A[1];a[0]=m[0]*G;a[1]=I*G;a[2]=O*A;a[3]=S*A;a[4]=f;a[5]=B;return a}function F(a,m,A){const I=m[0],O=m[1],S=m[2],f=m[3],B=m[4];m=m[5];const G=A[0];A=A[1];a[0]=I;a[1]=O;a[2]=S;a[3]=f;a[4]=I*G+S*A+B;a[5]=O*G+f*A+m;return a}function c(a,m){const A=Math.sin(m);m=Math.cos(m);a[0]=m;a[1]=A;a[2]=-A;a[3]=m;a[4]=0;a[5]=
0;return a}function n(a,m){a[0]=m[0];a[1]=0;a[2]=0;a[3]=m[1];a[4]=0;a[5]=0;return a}function g(a,m){a[0]=1;a[1]=0;a[2]=0;a[3]=1;a[4]=m[0];a[5]=m[1];return a}function l(a){return"mat2d("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+")"}function x(a){return Math.sqrt(a[0]**2+a[1]**2+a[2]**2+a[3]**2+a[4]**2+a[5]**2+1)}function q(a,m,A){a[0]=m[0]+A[0];a[1]=m[1]+A[1];a[2]=m[2]+A[2];a[3]=m[3]+A[3];a[4]=m[4]+A[4];a[5]=m[5]+A[5];return a}function z(a,m,A){a[0]=m[0]-A[0];a[1]=m[1]-A[1];a[2]=m[2]-
A[2];a[3]=m[3]-A[3];a[4]=m[4]-A[4];a[5]=m[5]-A[5];return a}function p(a,m,A){a[0]=m[0]*A;a[1]=m[1]*A;a[2]=m[2]*A;a[3]=m[3]*A;a[4]=m[4]*A;a[5]=m[5]*A;return a}function D(a,m,A,I){a[0]=m[0]+A[0]*I;a[1]=m[1]+A[1]*I;a[2]=m[2]+A[2]*I;a[3]=m[3]+A[3]*I;a[4]=m[4]+A[4]*I;a[5]=m[5]+A[5]*I;return a}function v(a,m){return a[0]===m[0]&&a[1]===m[1]&&a[2]===m[2]&&a[3]===m[3]&&a[4]===m[4]&&a[5]===m[5]}function e(a,m){const A=a[0],I=a[1],O=a[2],S=a[3],f=a[4];a=a[5];const B=m[0],G=m[1],u=m[2],N=m[3],t=m[4];m=m[5];
const r=k.getEpsilon();return Math.abs(A-B)<=r*Math.max(1,Math.abs(A),Math.abs(B))&&Math.abs(I-G)<=r*Math.max(1,Math.abs(I),Math.abs(G))&&Math.abs(O-u)<=r*Math.max(1,Math.abs(O),Math.abs(u))&&Math.abs(S-N)<=r*Math.max(1,Math.abs(S),Math.abs(N))&&Math.abs(f-t)<=r*Math.max(1,Math.abs(f),Math.abs(t))&&Math.abs(a-m)<=r*Math.max(1,Math.abs(a),Math.abs(m))}const d=Object.freeze(Object.defineProperty({__proto__:null,add:q,copy:h,determinant:J,equals:e,exactEquals:v,frob:x,fromRotation:c,fromScaling:n,fromTranslation:g,
identity:y,invert:C,mul:K,multiply:K,multiplyScalar:p,multiplyScalarAndAdd:D,rotate:Q,scale:H,set:w,str:l,sub:z,subtract:z,translate:F},Symbol.toStringTag,{value:"Module"}));b.add=q;b.copy=h;b.determinant=J;b.equals=e;b.exactEquals=v;b.frob=x;b.fromRotation=c;b.fromScaling=n;b.fromTranslation=g;b.identity=y;b.invert=C;b.mat2d=d;b.mul=K;b.multiply=K;b.multiplyScalar=p;b.multiplyScalarAndAdd=D;b.rotate=Q;b.scale=H;b.set=w;b.str=l;b.sub=z;b.subtract=z;b.translate=F;Object.defineProperty(b,Symbol.toStringTag,
{value:"Module"})})},"esri/widgets/Legend/styles/support/relationshipUtils":function(){define(["exports","../../../../symbols/support/svgUtils","../../../../symbols/support/utils","../../../support/widgetUtils","../../../support/jsxFactory"],function(b,k,h,y,w){function C(Q,H,F){const c=`${F}_arrowStart`;F=`${F}_arrowEnd`;Q="left"===Q;const n={markerStart:null,markerEnd:null};switch(H){case "HL":Q?n.markerStart=`url(#${F})`:n.markerEnd=`url(#${c})`;break;case "LL":n.markerStart=`url(#${F})`;break;
case "LH":Q?n.markerEnd=`url(#${c})`:n.markerStart=`url(#${F})`;break;default:n.markerEnd=`url(#${c})`}return n}function J(Q,H,F={}){const {focus:c,numClasses:n,colors:g,rotation:l}=Q,{opacity:x,effectList:q,ariaLabel:z}=F;Q=F.size??60;F=!!c;const p=Math.sqrt(Q**2+Q**2)+(F?0:5),D=[],v=[];var e=[],d=(Q||75)/n;for(var a=0;a<n;a++){var m=a*d;for(var A=0;A<n;A++){var I=A*d,O=k.generateFillAttributes(g[a][A]);const S=k.generateStrokeAttributes(null);I={type:"rect",x:I,y:m,width:d,height:d};const f=k.renderDef(O);
f&&D.push(f);(O=k.renderShape(I,O.fill,S,null))&&v.push(O);e.push(k.getBoundingBox(I))}}d=null;F||(d="margin: -15px -15px -18px -15px");a=C("left",c,H);m=C("right",c,H);A=k.computeBBox(e);e=k.getTransformMatrix(A,p,p,0,!1,l,!1);A=k.getTransformMatrix(A,p,p,0,!1,F?-45:null,!1);O={filter:h.getCSSFilterFromEffectList(q)??void 0,opacity:null==x?"":`${x}`};return w.tsx("div",{class:F?K.diamondMidColRamp:K.squareTableCell,styles:O},w.tsx("svg",{"aria-labelledBy":z,focusable:!1,height:p,role:"image",style:d,
width:p,xmlns:"http://www.w3.org/2000/svg"},w.tsx("defs",null,w.tsx("marker",{id:`${H}_arrowStart`,markerHeight:"10",markerUnits:"strokeWidth",markerWidth:"10",orient:"auto",refX:"5",refY:"5"},w.tsx("polyline",{fill:"none",points:"0,0 5,5 0,10",stroke:"#555555","stroke-width":"1"})),w.tsx("marker",{id:`${H}_arrowEnd`,markerHeight:"10",markerUnits:"strokeWidth",markerWidth:"10",orient:"auto",refX:"0",refY:"5"},w.tsx("polyline",{fill:"none",points:"5,0 0,5 5,10",stroke:"#555555","stroke-width":"1"})),
D),w.tsx("g",{transform:e},v),w.tsx("g",{transform:A},w.tsx("line",{fill:"none","marker-end":a.markerEnd,"marker-start":a.markerStart,stroke:"#555555","stroke-width":"1",x1:-10,x2:-10,y1:Q-15,y2:15}),w.tsx("line",{fill:"none","marker-end":m.markerEnd,"marker-start":m.markerStart,stroke:"#555555","stroke-width":"1",x1:15,x2:Q-15,y1:Q+10,y2:Q+10}))))}const K={diamondContainer:"esri-relationship-ramp--diamond__container",diamondLeftCol:"esri-relationship-ramp--diamond__left-column",diamondRightCol:"esri-relationship-ramp--diamond__right-column",
diamondMidCol:"esri-relationship-ramp--diamond__middle-column",diamondMidColLabel:"esri-relationship-ramp--diamond__middle-column--label",diamondMidColRamp:"esri-relationship-ramp--diamond__middle-column--ramp",squareTable:"esri-relationship-ramp--square__table",squareTableRow:"esri-relationship-ramp--square__table-row",squareTableCell:"esri-relationship-ramp--square__table-cell",squareTableLabel:"esri-relationship-ramp--square__table-label",squareTableLabelLeftBottom:"esri-relationship-ramp--square__table-label--left-bottom",
squareTableLabelRightBottom:"esri-relationship-ramp--square__table-label--right-bottom",squareTableLabelLeftTop:"esri-relationship-ramp--square__table-label--left-top",squareTableLabelRightTop:"esri-relationship-ramp--square__table-label--right-top"};b.renderRelationshipRamp=function(Q,H,F={}){const {focus:c,labels:n}=Q,g=!!c;Q=J(Q,H,F);H={justifyContent:"center"};F=y.isRTL();return g?w.tsx("div",{class:K.diamondContainer,styles:H},w.tsx("div",{class:K.diamondLeftCol},F?n.right:n.left),w.tsx("div",
{class:K.diamondMidCol},w.tsx("div",{class:K.diamondMidColLabel},n.top),Q,w.tsx("div",{class:K.diamondMidColLabel},n.bottom)),w.tsx("div",{class:K.diamondRightCol},F?n.left:n.right)):w.tsx("div",{class:K.squareTable},w.tsx("div",{class:K.squareTableRow},w.tsx("div",{class:y.classes(K.squareTableCell,K.squareTableLabel,K.squareTableLabelRightBottom)},F?n.top:n.left),w.tsx("div",{class:K.squareTableCell}),w.tsx("div",{class:y.classes(K.squareTableCell,K.squareTableLabel,K.squareTableLabelLeftBottom)},
F?n.left:n.top)),w.tsx("div",{class:K.squareTableRow},w.tsx("div",{class:K.squareTableCell}),Q,w.tsx("div",{class:K.squareTableCell})),w.tsx("div",{class:K.squareTableRow},w.tsx("div",{class:y.classes(K.squareTableCell,K.squareTableLabel,K.squareTableLabelRightTop)},F?n.right:n.bottom),w.tsx("div",{class:K.squareTableCell}),w.tsx("div",{class:y.classes(K.squareTableCell,K.squareTableLabel,K.squareTableLabelLeftTop)},F?n.bottom:n.right)))};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},
"esri/widgets/Legend/support/relationshipRampUtils":function(){define(["exports","../../../core/lang","../../../symbols/support/gfxUtils","../../../symbols/support/previewSymbol3D"],function(b,k,h,y){function w(H){if(H){var {type:F}=H;return F.includes("3d")?y.getSymbolLayerFill(H.symbolLayers.at(0)):"simple-line"===F||"simple-marker"===H.type&&("x"===H.style||"cross"===H.style)?(H=h.getStroke(H))&&H.color:h.getFill(H)}}function C(H,F){const c=F.HH.label,n=F.LL.label,g=F.HL.label;F=F.LH.label;switch(H){case "HH":return{top:c,
bottom:n,left:g,right:F};case "HL":return{top:g,bottom:F,left:n,right:c};case "LL":return{top:n,bottom:c,left:F,right:g};case "LH":return{top:F,bottom:g,left:c,right:n};default:return{top:c,bottom:n,left:g,right:F}}}function J(H){let F=K[H];H&&null==F&&(F=K.HH);return F||0}const K={HH:315,HL:45,LL:135,LH:225},Q={2:[["HL","HH"],["LL","LH"]],3:[["HL","HM","HH"],["ML","MM","MH"],["LL","LM","LH"]],4:[["HL","HM1","HM2","HH"],["M2L","M2M1","M2M2","M2H"],["M1L","M1M1","M1M2","M1H"],["LL","LM1","LM2","LH"]]};
b.getRelationshipRampColors2D=function(H,F){const c=[],n=H.length**.5;H=k.clone(H);var g=(F||"HH").split("");F=g[0];for(g="H"===g[1];H.length;){const l=[];for(;l.length<n;)l.push(H.shift());g&&l.reverse();c.push(l)}"L"===F&&c.reverse();return c};b.getRelationshipRampElement=function(H){const {focus:F,infos:c,numClasses:n}=H;var g=Q[n];const l={};c.forEach(x=>{l[x.value]={label:x.label,fill:w(x.symbol)}});H=[];for(let x=0;x<n;x++){const q=[];for(let z=0;z<n;z++)q.push(l[g[x][z]].fill);H.push(q)}g=
C(F,l);return{type:"relationship-ramp",numClasses:n,focus:F,colors:H,labels:g,rotation:J(F)}};b.getRotationAngleForFocus=J;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/previewSymbol3D":function(){define("exports ../../assets ../../core/colorUtils ../../core/has ../../core/Error ../../core/Logger ../../core/screenUtils ./gfxUtils ./IconSymbol3DLayerResource ./ObjectSymbol3DLayerResource ./previewUtils ./renderUtils ./utils ./webStyleSymbolUtils".split(" "),
function(b,k,h,y,w,C,J,K,Q,H,F,c,n,g){function l(r){const E=r.outline;var P=null!=r.material?r.material.color:null;P=null!=P?P.toHex():null;if(null==E||"pattern"in E&&null!=E.pattern&&"style"===E.pattern.type&&"none"===E.pattern.style)return"fill"===r.type&&"#ffffff"===P?{color:"#bdc3c7",width:.75}:null;r=J.pt2px(E.size)||0;return{color:"rgba("+(null!=E.color?E.color.toRgba():"255,255,255,1")+")",width:Math.min(r,u),style:"pattern"in E&&null!=E.pattern&&"style"===E.pattern.type?K.dekebabifyLineStyle(E.pattern.style):
null,join:"butt",cap:"patternCap"in E?E.patternCap:"butt"}}async function x(r,E){if(r.thumbnail?.url)return r.thumbnail.url;if("icon"===E.type&&E?.resource?.href)return n.getIconHref(E);E=k.getAssetUrl("esri/images/Legend/legend3dsymboldefault.png");return r.styleOrigin&&(r.styleOrigin.styleName||r.styleOrigin.styleUrl)&&(r=await g.resolveWebStyleSymbol(r.styleOrigin,{portal:r.styleOrigin.portal},"webRef").catch(()=>null))&&"thumbnail"in r&&r.thumbnail?.url?r.thumbnail.url:E}function q(r,E=1){const P=
r.a;r=h.toHSV(r);const {r:U,g:W,b:aa}=h.toRGB({h:r.h,s:r.s/E,v:100-(100-r.v)/E});return[U,W,aa,P]}function z(r){return"water"===r.type?null==r.color?null:r.color:null==r.material?.color?null:r.material.color}function p(r,E=0){var P=z(r);if(!P){if("fill"===r.type)return null;E=F.adjustColorComponentBrightness(K.defaultThematicColor.r,E);return[E,E,E,100]}r=P.toRgba();for(P=0;3>P;P++)r[P]=F.adjustColorComponentBrightness(r[P],E);return r}async function D(r,E){r=r.style;return"none"===r?null:{type:"pattern",
x:0,y:0,src:await K.getPatternUrlWithColor(k.getAssetUrl(`esri/symbols/patterns/${r}.png`),E.toCss(!0)),width:5,height:5}}function v(r){return r.outline?l(r):{color:"rgba(0, 0, 0, 1)",width:1.5}}function e(r,E){r=z(r);if(!r)return null;let P;P="rgba("+(F.adjustColorComponentBrightness(r.r,E)+",");P+=F.adjustColorComponentBrightness(r.g,E)+",";P+=F.adjustColorComponentBrightness(r.b,E)+",";return P+r.a+");"}function d(r,E){E=e(r,E);if(!E)return{};if("pattern"in r&&null!=r.pattern&&"style"===r.pattern.type&&
"none"===r.pattern.style)return null;const P=Math.min(r.size?J.pt2px(r.size):.75,u);return{color:E,width:P,style:"pattern"in r&&null!=r.pattern&&"style"===r.pattern.type?K.dekebabifyLineStyle(r.pattern.style):null,cap:"cap"in r?r.cap:null,join:"join"in r?"miter"===r.join?J.pt2px(2):r.join:null}}function a(r,E,P){P=null!=P?.75*P:0;return{type:"linear",x1:P?.25*P:0,y1:P?.5*P:0,x2:P||4,y2:P?.5*P:4,colors:[{color:r,offset:0},{color:E,offset:1}]}}function m(r){const E=r.depth,P=r.height;r=r.width;return 0!==
r&&0!==E&&0!==P&&r===E&&null!=r&&null!=P&&r<P}function A(r,E,P){const U=[];if(!r)return U;switch(r.type){case "icon":switch(r.resource&&r.resource.primitive||Q.defaultPrimitive){case "circle":U.push({shape:{type:"circle",cx:0,cy:0,r:.5*E},fill:p(r,0),stroke:l(r)});break;case "square":U.push({shape:{type:"path",path:[{command:"M",values:[0,E]},{command:"L",values:[0,0]},{command:"L",values:[E,0]},{command:"L",values:[E,E]},{command:"Z",values:[]}]},fill:p(r,0),stroke:l(r)});break;case "triangle":U.push({shape:{type:"path",
path:[{command:"M",values:[0,E]},{command:"L",values:[.5*E,0]},{command:"L",values:[E,E]},{command:"Z",values:[]}]},fill:p(r,0),stroke:l(r)});break;case "cross":U.push({shape:{type:"path",path:[{command:"M",values:[.5*E,0]},{command:"L",values:[.5*E,E]},{command:"M",values:[0,.5*E]},{command:"L",values:[E,.5*E]}]},stroke:v(r)});break;case "x":U.push({shape:{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[E,E]},{command:"M",values:[E,0]},{command:"L",values:[0,E]}]},stroke:v(r)});
break;case "kite":U.push({shape:{type:"path",path:[{command:"M",values:[0,.5*E]},{command:"L",values:[.5*E,0]},{command:"L",values:[E,.5*E]},{command:"L",values:[.5*E,E]},{command:"Z",values:[]}]},fill:p(r,0),stroke:l(r)})}break;case "object":switch(r.resource&&r.resource.primitive||H.defaultPrimitive){case "cone":var W=p(r,0);r=p(r,-.6);r=a(W,r,P?t:E);E=F.getConeShapes(E,P);U.push({shape:E[0],fill:r},{shape:E[1],fill:r});break;case "inverted-cone":P=p(r,0);r=p(r,-.6);r=a(P,r,E);E=F.getInvertedConeShapes(E);
U.push({shape:E[0],fill:r},{shape:E[1],fill:P});break;case "cube":E=F.getCubeShapes(E,P);U.push({shape:E[0],fill:p(r,0)},{shape:E[1],fill:p(r,-.3)},{shape:E[2],fill:p(r,-.5)});break;case "cylinder":W=p(r,0);const aa=p(r,-.6);W=a(W,aa,P?t:E);E=F.getCylinderShapes(E,P);U.push({shape:E[0],fill:W},{shape:E[1],fill:W},{shape:E[2],fill:p(r,0)});break;case "diamond":E=F.getDiamondShapes(E);U.push({shape:E[0],fill:p(r,-.3)},{shape:E[1],fill:p(r,0)},{shape:E[2],fill:p(r,-.3)},{shape:E[3],fill:p(r,-.7)});break;
case "sphere":P=p(r,0);r=p(r,-.6);r=a(P,r);r.x1=0;r.y1=0;r.x2=.25*E;r.y2=.25*E;U.push({shape:{type:"circle",cx:0,cy:0,r:.5*E},fill:r});break;case "tetrahedron":E=F.getTetrahedronShapes(E),U.push({shape:E[0],fill:p(r,-.3)},{shape:E[1],fill:p(r,0)},{shape:E[2],fill:p(r,-.6)})}}return U}function I(r){return(r="number"===typeof r?.size?r?.size:null)?J.pt2px(r):null}async function O(r,E){const P=I(E),U=E?.maxSize?J.pt2px(E.maxSize):null,W=E?.disableUpsampling??!1,aa=r.symbolLayers,da=[];let Z=0,fa=0;const Y=
aa.at(-1);let ba;Y&&"icon"===Y.type&&(ba=Y.size&&J.pt2px(Y.size));aa.forEach(M=>{if("icon"===M.type||"object"===M.type){var R="icon"===M.type?M.size&&J.pt2px(M.size):0,T=P||R?Math.ceil(Math.min(P||R,U||G)):B;if(M?.resource?.href){var V=x(r,M).then(X=>{const ca=M?.material?.color;var ea="icon"===M.type?"multiply":"tint";return c.tintImageWithColor(X,T,ca,ea,W)}).then(X=>{const ca=X.width,ea=X.height;Z=Math.max(Z,ca);fa=Math.max(fa,ea);return[{shape:{type:"image",x:0,y:0,width:ca,height:ea,src:X.url},
fill:null,stroke:null}]});da.push(V)}else V=T,"icon"===M.type&&ba&&P&&(V=R/ba*T),R="tall"===E?.symbolConfig||E?.symbolConfig?.isTall||("object"===M.type?m(M):!1),Z=Math.max(Z,R?t:V),fa=Math.max(fa,V),da.push(Promise.resolve(A(M,V,R)))}});const L=[];(await Promise.allSettled(da)).forEach(M=>{"fulfilled"===M.status?L.push(M.value):M.reason&&C.getLogger("esri.symbols.support.previewSymbol3D").warn("error while building swatchInfo!",M.reason)});return c.renderSymbol(L,[Z,fa],{node:E?.node,scale:!1,opacity:E?.opacity,
ariaLabel:E?.ariaLabel})}function S(r,E){const P=r.symbolLayers,U=[];r=n.isVolumetricSymbol(r);const W=I(E),aa=(E?.maxSize?J.pt2px(E.maxSize):null)||u;let da=0,Z=0,fa;P.forEach((Y,ba)=>{if(Y&&("line"===Y.type||"path"===Y.type)){var L=[];switch(Y.type){case "line":var M=d(Y,0);if(null==M)break;var R=M?.width||0;0===ba&&(fa=R);Y=Math.min(W||R,aa);ba=0===ba?Y:W?R/fa*Y:Y;R=ba>N/2?2*ba:N;Z=Math.max(Z,ba);da=Math.max(da,R);M.width=ba;L.push({shape:{type:"path",path:[{command:"M",values:[0,.5*Z]},{command:"L",
values:[da,.5*Z]}]},stroke:M});break;case "path":M=Math.min(W||B,aa);ba=p(Y,0);R=p(Y,-.2);var T=e(Y,-.4);T=T?{color:T,width:1}:{};if("quad"===Y.profile){const V=Y.width;Y=Y.height;Y=F.getPathSymbolShapes(V&&Y?V/Y:1,0===Y,0===V);T={...T,join:"bevel"};L.push({shape:Y[0],fill:R,stroke:T},{shape:Y[1],fill:R,stroke:T},{shape:Y[2],fill:ba,stroke:T})}else L.push({shape:F.shapes.pathSymbol3DLayer[0],fill:R,stroke:T},{shape:F.shapes.pathSymbol3DLayer[1],fill:ba,stroke:T});da=Z=Math.max(Z,M)}U.push(L)}});return Promise.resolve(c.renderSymbol(U,
[da,Z],{node:E?.node,scale:r,opacity:E?.opacity,ariaLabel:E?.ariaLabel}))}async function f(r,E){const P="mesh-3d"===r.type;r=r.symbolLayers;var U=I(E);const W=E?.maxSize?J.pt2px(E.maxSize):null;U=U||B;const aa=[];let da=0,Z=0;var fa=!1;for(let R=0;R<r.length;R++){var Y=r.at(R);const T=[];if(!P||"fill"===Y.type){switch(Y.type){case "fill":fa=Math.min(U,W||G);da=Math.max(da,fa);Z=Math.max(Z,fa);fa=!0;if(P){var ba=F.shapes.meshSymbol3DFill,L=e(Y,-.4);L=L?{color:L,width:1,join:"round"}:{};T.push({shape:ba[0],
fill:p(Y,0),stroke:L},{shape:ba[1],fill:p(Y,-.2),stroke:L},{shape:ba[2],fill:p(Y,-.6),stroke:L})}else{ba=p(Y,0);L="pattern"in Y?Y.pattern:null;var M=l(Y);Y=z(Y);null!=L&&"style"===L.type&&"solid"!==L.style&&Y&&(ba=await D(L,Y));T.push({shape:F.shapes.fill[0],fill:ba,stroke:M})}break;case "line":Y=d(Y,0);if(null==Y)break;Y={stroke:Y,shape:F.shapes.fill[0]};da=Math.max(da,B);Z=Math.max(Z,B);T.push(Y);break;case "extrude":ba={join:"round",width:1,...d(Y,-.4)};L=p(Y,0);Y=p(Y,-.2);M=Math.min(U,W||G);const V=
F.getExtrudeSymbolShapes(M);ba.width=1;T.push({shape:V[0],fill:Y,stroke:ba},{shape:V[1],fill:Y,stroke:ba},{shape:V[2],fill:L,stroke:ba});Y=.7*B+.5*M;da=Math.max(da,B);Z=Math.max(Z,Y);break;case "water":fa=z(Y),Y=q(fa),ba=q(fa,2),L=q(fa,3),M=F.getWaterSymbolShapes(),fa=!0,T.push({shape:M[0],fill:Y},{shape:M[1],fill:ba},{shape:M[2],fill:L}),Y=Math.min(U,W||G),da=Math.max(da,Y),Z=Math.max(Z,Y)}aa.push(T)}}return c.renderSymbol(aa,[da,Z],{node:E?.node,scale:fa,opacity:E?.opacity,ariaLabel:E?.ariaLabel})}
const B=F.SymbolSizeDefaults.size,G=F.SymbolSizeDefaults.maxSize,u=F.SymbolSizeDefaults.maxOutlineSize,N=F.SymbolSizeDefaults.lineWidth,t=F.SymbolSizeDefaults.tallSymbolWidth;b.getPatternDescriptor=D;b.getSizeFromOptions=I;b.getSymbolLayerFill=p;b.previewSymbol3D=function(r,E){if(0===r.symbolLayers.length)return Promise.reject(new w("symbolPreview: renderPreviewHTML3D","No symbolLayers in the symbol."));switch(r.type){case "point-3d":return O(r,E);case "line-3d":return S(r,E);case "polygon-3d":case "mesh-3d":return f(r,
E)}return Promise.reject(new w("symbolPreview: swatchInfo3D","symbol not supported."))};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/webStyleSymbolUtils":function(){define("exports ../../symbols ../../core/devEnvironmentUtils ../../core/Error ../../core/urlUtils ../../portal/Portal ../../chunks/persistableUrlUtils ./jsonUtils ./StyleOrigin ./styleUtils ./Thumbnail".split(" "),function(b,k,h,y,w,C,J,K,Q,H,F){function c(l,x){return x.items.find(q=>q.name===l)}
function n(l,x,q,z,p,D){const v=null!=q?.portal?q.portal:C.getDefault(),e={portal:v,url:w.urlToObject(l.baseUrl),origin:"portal-item"},d=c(x,l.data);if(!d)return Promise.reject(new y("symbolstyleutils:symbol-name-not-found",`The symbol name '${x}' could not be found`,{symbolName:x}));p=J.fromJSON(p(d,z),e);let a=d.thumbnail?.href??null;const m=d.thumbnail?.imageData;h.isDevEnvironment()&&(p=h.adjustStaticAGOUrl(p)??"",a=h.adjustStaticAGOUrl(a));const A={portal:v,url:w.urlToObject(w.removeFile(p)),
origin:"portal-item"};return H.requestJSON(p,D).then(I=>{I="cimRef"===z?H.makeCIMSymbolRef(I.data):I.data;if((I=K.fromJSON(I,A))&&k.isSymbol3D(I)){if(a){const O=J.fromJSON(a,e);I.thumbnail=new F.Thumbnail({url:O})}else m&&(I.thumbnail=new F.Thumbnail({url:`data:image/png;base64,${m}`}));l.styleUrl?I.styleOrigin=new Q({portal:q.portal,styleUrl:l.styleUrl,name:x}):l.styleName&&(I.styleOrigin=new Q({portal:q.portal,styleName:l.styleName,name:x}))}return I})}function g(l,x,q){const z=H.Style2DUrlTemplate.replaceAll(/\{SymbolName\}/gi,
l),p=null!=x.portal?x.portal:C.getDefault();return H.requestJSON(z,q).then(D=>{D=H.makeCIMSymbolRef(D.data);return K.fromJSON(D,{portal:p,url:w.urlToObject(w.removeFile(z)),origin:"portal-item"})})}b.fetchSymbolFromStyle=n;b.getStyleItemFromStyle=c;b.resolveWebStyleSymbol=function(l,x,q,z){const p=l.name;return null==p?Promise.reject(new y("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference")):l.styleName&&"Esri2DPointSymbolsStyle"===l.styleName?g(p,x,z):
H.fetchStyle(l,x,z).then(D=>n(D,p,x,q,H.symbolUrlFromStyleItem,z))};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/core/devEnvironmentUtils":function(){define(["exports"],function(b){const k=/^devext.arcgis.com$/,h=/^qaext.arcgis.com$/,y=/^[\w-]*\.mapsdevext.arcgis.com$/,w=/^[\w-]*\.mapsqa.arcgis.com$/,C=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local.esri.com$/,k,h,/^jsapps.esri.com$/,y,w];b.adjustStaticAGOUrl=function(J,K){return J?(K=K||globalThis.location.hostname)?null!=K.match(k)||
null!=K.match(y)?J.replace("static.arcgis.com","staticdev.arcgis.com"):null!=K.match(h)||null!=K.match(w)?J.replace("static.arcgis.com","staticqa.arcgis.com"):J:J:J};b.devHostnames=C;b.isDevEnvironment=function(J){J=J||globalThis.location.hostname;return C.some(K=>null!=J?.match(K))};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/views/support/layerViewUtils":function(){define(["exports"],function(b){b.extractSafeScaleBounds=function(k){k=k.effectiveScaleRange;return{minScale:k?.minScale??
0,maxScale:k?.maxScale??0}};b.highlightsSupported=function(k){return k&&"function"===typeof k.highlight};b.isScaleRangeActive=function(k,h){return null!=k&&0<k||null!=h&&0<h};b.isSelectableLayerView2D=function(k){return null!=k&&"object"===typeof k&&"createQuery"in k&&"queryFeatures"in k&&"layer"in k&&"view"in k};b.occludeesSupported=function(k){return k&&"function"===typeof k.maskOccludee};b.scaleBoundsPredicate=function(k,h,y){return null==k||k>y&&(0===h||k<h)};Object.defineProperty(b,Symbol.toStringTag,
{value:"Module"})})},"esri/widgets/Popup/actions":function(){define("exports ../../core/Collection ../../support/actions/ActionBase ../../support/actions/ActionButton ../../support/actions/ActionToggle ../support/legacyIcon".split(" "),function(b,k,h,y,w,C){k=k.ofType({key:"type",defaultKeyValue:"button",base:h,typeMap:{button:y,toggle:w}});h=new y({icon:"magnifying-glass-plus",id:"zoom-to-feature",title:"{messages.zoom}",className:C.legacyIcon.zoomInMagnifyingGlass});const J=new y({icon:"trash",
id:"remove-selected-feature",title:"{messages.remove}",className:C.legacyIcon.trash});y=new y({icon:"magnifying-glass-plus",id:"zoom-to-clustered-features",title:"{messages.zoom}",className:C.legacyIcon.zoomInMagnifyingGlass});w=new w({icon:"table",id:"browse-clustered-features",title:"{messages.browseClusteredFeatures}",className:C.legacyIcon.table,value:!1});C=[h,J,w,y];b.ActionsCollection=k;b.all=C;b.browseClusteredFeatures=w;b.removeSelectedFeature=J;b.zoomToClusteredFeatures=y;b.zoomToFeature=
h;Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Popup/actionUtils":function(){define(["exports","../../core/Error","../../core/Logger","../../core/promiseUtils","./actions"],function(b,k,h,y,w){function C(c){const {selectedFeature:n,location:g,view:l}=c;return l?n??g??null:null}function J(c){return!!c&&c.isAggregate&&"cluster"===c.sourceLayer?.featureReduction?.type}async function K(c,n){if("3d"!==n?.type||!c||"esri.Graphic"!==c.declaredClass)return!0;if((n=n.getViewForGraphic(c))&&
"whenGraphicBounds"in n){let g=null;try{g=await n.whenGraphicBounds(c,{useViewElevation:!0})}catch(l){}return!g||!g.boundingBox||g.boundingBox[0]===g.boundingBox[3]&&g.boundingBox[1]===g.boundingBox[4]&&g.boundingBox[2]===g.boundingBox[5]}return!0}async function Q(c){const {location:n,selectedFeature:g,view:l,zoomFactor:x}=c,q=C(c);if(!l||!q)throw c=new k("zoom-to:invalid-target-or-view","Cannot zoom to location without a target and view.",{target:q,view:l}),h.getLogger("esri.widgets.Popup.PopupViewModel").error(c),
c;const z=l.scale/x,p=c.selectedFeature?.geometry??n,D=null!=p&&"point"===p.type&&await K(g,l);w.zoomToFeature.active=!0;w.zoomToFeature.disabled=!0;try{await c.zoomTo({target:{target:q,scale:D?z:void 0}})}catch(v){const e=new k("zoom-to:invalid-graphic","Could not zoom to the location of the graphic.",{graphic:g});h.getLogger("esri.widgets.Popup.PopupViewModel").error(e)}finally{w.zoomToFeature.active=!1,w.zoomToFeature.disabled=!1,c.zoomToLocation=null,D&&(c.location=p)}}async function H(c){const {selectedFeature:n,
view:g}=c;if("2d"!==g?.type)throw c=new k("zoomToCluster:invalid-view","View must be 2d MapView.",{view:g}),h.getLogger("esri.widgets.Popup.PopupViewModel").error(c),c;if(!n||!J(n))throw c=new k("zoomToCluster:invalid-selectedFeature","Selected feature must represent an aggregate/cluster graphic.",{selectedFeature:n}),h.getLogger("esri.widgets.Popup.PopupViewModel").error(c),c;const [l,x]=await F(g,n);w.zoomToClusteredFeatures.active=!0;w.zoomToClusteredFeatures.disabled=!0;const {extent:q}=await l.queryExtent(x);
q&&await c.zoomTo({target:q});w.zoomToClusteredFeatures.active=!1;w.zoomToClusteredFeatures.disabled=!1}async function F(c,n){c=await c.whenLayerView(n.sourceLayer);const g=c.createQuery();n=n.getObjectId();g.aggregateIds=null!=n?[n]:[];return[c,g]}b.browseAggregateFeatures=async function(c){const {selectedFeature:n,view:g}=c;if(g&&n){var [l,x]=await F(g,n);w.browseClusteredFeatures.active=!0;w.browseClusteredFeatures.disabled=!0;var {features:q}=await l.queryFeatures(x);w.browseClusteredFeatures.active=
!1;w.browseClusteredFeatures.disabled=!1;w.browseClusteredFeatures.value=!0;c?.open({features:[n].concat(q),featureMenuOpen:!0})}};b.displayClusterExtent=async function(c){const {view:n,selectedFeature:g}=c;if(n&&g){var [l,x]=await F(n,g),{extent:q}=await l.queryExtent(x);c.selectedClusterBoundaryFeature.geometry=q;n.graphics.add(c.selectedClusterBoundaryFeature)}};b.getSelectedTarget=C;b.isClusterFeature=J;b.removeClusteredFeaturesForBrowsing=function(c){w.browseClusteredFeatures.value=!1;const n=
c.features.filter(g=>J(g));n.length&&(c.features=n)};b.triggerAction=c=>{const {event:n,view:g,viewModel:l}=c;({action:c}=n);if(!c)return Promise.reject(new k("trigger-action:missing-arguments","Event has no action"));const {disabled:x,id:q}=c;if(!q)return Promise.reject(new k("trigger-action:invalid-action","action.id is missing"));if(x)return Promise.reject(new k("trigger-action:invalid-action","Action is disabled"));if(q===w.zoomToFeature.id)return Q(l).catch(y.throwIfNotAbortError);if(q===w.zoomToClusteredFeatures.id)return H(l);
if(q===w.browseClusteredFeatures.id)return l.browseClusterEnabled=!l.browseClusterEnabled,l.featureMenuOpen=l.browseClusterEnabled,Promise.resolve();if(q===w.removeSelectedFeature.id){l.visible=!1;({selectedFeature:c}=l);if(!c)return Promise.reject(new k(`trigger-action:${w.removeSelectedFeature.id}`,"selectedFeature is required",{selectedFeature:c}));const {sourceLayer:z}=c;z?z.remove(c):g?.graphics.remove(c)}return Promise.resolve()};b.zoomToClusterExtent=H;b.zoomToLocation=Q;Object.defineProperty(b,
Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/GoTo":function(){define("exports ../../chunks/tslib.es6 ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),function(b,k,h,y,w,C,J,K){b.GoToMixin=Q=>{Q=class extends Q{constructor(...H){super(...H);this.view=this.goToOverride=null}callGoTo(H){const {view:F}=this;h.assertIsSome(F);return this.goToOverride?this.goToOverride(F,
H):F.goTo(H.target,H.options)}};k.__decorate([y.property()],Q.prototype,"goToOverride",void 0);k.__decorate([y.property()],Q.prototype,"view",void 0);return Q=k.__decorate([K.subclass("esri.widgets.support.GoTo")],Q)};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Features/FeaturesVisibleElements":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),
function(b,k,h,y,w,C,J){k=class extends k{constructor(){super(...arguments);this.closeButton=this.actionBar=!0;this.collapseButton=!1;this.spinner=this.heading=this.flow=this.featureNavigation=!0}};b.__decorate([h.property({type:Boolean,nonNullable:!0})],k.prototype,"actionBar",void 0);b.__decorate([h.property({type:Boolean,nonNullable:!0})],k.prototype,"closeButton",void 0);b.__decorate([h.property({type:Boolean,nonNullable:!0})],k.prototype,"collapseButton",void 0);b.__decorate([h.property({type:Boolean,
nonNullable:!0})],k.prototype,"featureNavigation",void 0);b.__decorate([h.property({type:Boolean,nonNullable:!0})],k.prototype,"flow",void 0);b.__decorate([h.property({type:Boolean,nonNullable:!0})],k.prototype,"heading",void 0);b.__decorate([h.property({type:Boolean,nonNullable:!0})],k.prototype,"spinner",void 0);return k=b.__decorate([J.subclass("esri.widgets.Features.FeaturesVisibleElements")],k)})},"esri/widgets/Popup/css":function(){define(["exports"],function(b){b.css={base:"esri-popup",main:"esri-popup__main-container",
shadow:"esri-popup--shadow",isDocked:"esri-popup--is-docked",isDockedTopLeft:"esri-popup--is-docked-top-left",isDockedTopCenter:"esri-popup--is-docked-top-center",isDockedTopRight:"esri-popup--is-docked-top-right",isDockedBottomLeft:"esri-popup--is-docked-bottom-left",isDockedBottomCenter:"esri-popup--is-docked-bottom-center",isDockedBottomRight:"esri-popup--is-docked-bottom-right",alignTopCenter:"esri-popup--aligned-top-center",alignBottomCenter:"esri-popup--aligned-bottom-center",alignTopLeft:"esri-popup--aligned-top-left",
alignBottomLeft:"esri-popup--aligned-bottom-left",alignTopRight:"esri-popup--aligned-top-right",alignBottomRight:"esri-popup--aligned-bottom-right",pointer:"esri-popup__pointer",pointerDirection:"esri-popup__pointer-direction"};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Popup/PopupViewModel":function(){define("../../chunks/tslib.es6 ../../core/Logger ../../core/has ../../core/RandomLCG ../../core/Error ../../core/accessorSupport/decorators/subclass ../Features/FeaturesViewModel".split(" "),
function(b,k,h,y,w,C,J){k=class extends J{constructor(K){super(K)}};return k=b.__decorate([C.subclass("esri.widgets.Popup.PopupViewModel")],k)})},"esri/widgets/Popup/PopupVisibleElements":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),function(b,k,h,y,w,C,J){k=class extends k{constructor(){super(...arguments);this.spinner=this.heading=
this.featureNavigation=this.collapseButton=this.closeButton=this.actionBar=!0}};b.__decorate([h.property({type:Boolean,nonNullable:!0})],k.prototype,"actionBar",void 0);b.__decorate([h.property({type:Boolean,nonNullable:!0})],k.prototype,"closeButton",void 0);b.__decorate([h.property({type:Boolean,nonNullable:!0})],k.prototype,"collapseButton",void 0);b.__decorate([h.property({type:Boolean,nonNullable:!0})],k.prototype,"featureNavigation",void 0);b.__decorate([h.property({type:Boolean,nonNullable:!0})],
k.prototype,"heading",void 0);b.__decorate([h.property({type:Boolean,nonNullable:!0})],k.prototype,"spinner",void 0);return k=b.__decorate([J.subclass("esri.widgets.Features.PopupVisibleElements")],k)})},"*noref":1}});
define("../chunks/tslib.es6 ../core/deprecate ../core/Logger ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/has ../core/RandomLCG ../core/accessorSupport/decorators/subclass ../support/actions/ActionButton ./Features ./Widget ./Popup/css ./Popup/PopupViewModel ./Popup/PopupVisibleElements ./support/globalCss ./support/widgetUtils ./support/decorators/messageBundle ./support/decorators/vmEvent ./support/jsxFactory".split(" "),function(b,k,h,y,w,C,J,K,Q,H,F,c,n,g,l,x,q,z,
p){const D={buttonEnabled:!0,position:"auto",breakpoint:{width:544}};C=class extends F{constructor(v,e){super(v,e);this._dockAction=new Q({id:"popup-dock-action"});this._featuresWidget=new H({responsiveActionsEnabled:!0});this._mainContainerNode=this._containerNode=null;this._pointerOffsetInPx=16;this.alignment="auto";this.dockEnabled=this.collapsed=!1;this.headingLevel=2;this.messages=null;this.viewModel=new n;this.visibleElements=new g}initialize(){this.addHandles([y.watch(()=>[this.viewModel?.view?.widthBreakpoint,
this.dockEnabled],()=>this._handleDockIcon(),y.initial),y.watch(()=>[this.dockEnabled,this.messages?.undock,this.messages?.dock],()=>this._handleDockEnabled(),y.initial),y.watch(()=>this.dockOptions,v=>{const {_dockAction:e}=this,d=this._featuresWidget.headerActions;d.remove(e);v.buttonEnabled&&d.add(e)},y.initial),y.watch(()=>this.viewModel?.screenLocation,()=>this._positionContainer()),y.watch(()=>[this.viewModel?.active,this.dockEnabled],()=>this._toggleScreenLocationEnabled()),y.watch(()=>[this.viewModel?.screenLocation,
this.viewModel?.view?.padding,this.viewModel?.view?.size,this.viewModel?.active,this.viewModel?.location,this.alignment],()=>this.reposition()),y.watch(()=>this.viewModel?.view?.size,(v,e)=>this._updateDockEnabledForViewSize(v,e)),y.watch(()=>this.viewModel?.view,(v,e)=>this._viewChange(v,e)),y.watch(()=>this.viewModel?.view?.ready,(v,e)=>this._viewReadyChange(v??!1,e??!1)),y.watch(()=>this.viewModel,()=>this._featuresWidget.viewModel=this.viewModel,y.initial),y.watch(()=>this._featureNavigationTop,
v=>this._featuresWidget.featureNavigationTop=v,y.initial),y.watch(()=>this.headingLevel,v=>this._featuresWidget.headingLevel=v,y.initial),y.watch(()=>this.collapsed,v=>this._featuresWidget.collapsed=v,y.initial),y.watch(()=>this.visibleElements.actionBar,v=>this._featuresWidget.visibleElements.actionBar=!!v,y.initial),y.watch(()=>this.visibleElements.closeButton,v=>this._featuresWidget.visibleElements.closeButton=!!v,y.initial),y.watch(()=>this.visibleElements.collapseButton,v=>this._featuresWidget.visibleElements.collapseButton=
!!v,y.initial),y.watch(()=>this.visibleElements.heading,v=>this._featuresWidget.visibleElements.heading=!!v,y.initial),y.watch(()=>this.visibleElements.spinner,v=>this._featuresWidget.visibleElements.spinner=!!v,y.initial),y.watch(()=>this.visibleElements.featureNavigation,v=>this._featuresWidget.visibleElements.featureNavigation=!!v,y.initial),y.on(()=>this._featuresWidget,"trigger-header-action",v=>{v.action===this._dockAction&&(this.dockEnabled=!this.dockEnabled)})])}normalizeCtorArgs(v){const e=
{...v};null!=v?.visibleElements&&(e.visibleElements=new g(v.visibleElements),null!=v.collapseEnabled&&(e.visibleElements.collapseButton=v.collapseEnabled),null!=v.spinnerEnabled&&(e.visibleElements.spinner=v.spinnerEnabled));return e}destroy(){this._dockAction.destroy();this._featuresWidget?.destroy()}get _featureNavigationTop(){const {currentAlignment:v,currentDockPosition:e}=this;return"bottom-left"===v||"bottom-center"===v||"bottom-right"===v||"top-left"===e||"top-center"===e||"top-right"===e}get actions(){return this.viewModel.actions}set actions(v){this.viewModel.actions=
v}get autoCloseEnabled(){return this.viewModel.autoCloseEnabled}set autoCloseEnabled(v){this.viewModel.autoCloseEnabled=v}get autoOpenEnabled(){k.deprecatedProperty(h.getLogger(this),"autoOpenEnabled",{replacement:"MapView/SceneView.popupEnabled",version:"4.27"});return this.viewModel.autoOpenEnabled}set autoOpenEnabled(v){k.deprecatedProperty(h.getLogger(this),"autoOpenEnabled",{replacement:"MapView/SceneView.popupEnabled",version:"4.27"});this.viewModel.autoOpenEnabled=v}get defaultPopupTemplateEnabled(){return this.viewModel.defaultPopupTemplateEnabled}set defaultPopupTemplateEnabled(v){this.viewModel.defaultPopupTemplateEnabled=
v}get content(){return this.viewModel.content}set content(v){this.viewModel.content=v}get collapseEnabled(){k.deprecatedProperty(h.getLogger(this),"collapseEnabled",{replacement:"PopupVisibleElements.collapseButton",version:"4.29"});return this.visibleElements.collapseButton}set collapseEnabled(v){k.deprecatedProperty(h.getLogger(this),"collapseEnabled",{replacement:"PopupVisibleElements.collapseButton",version:"4.29"});this.visibleElements.collapseButton=v}get currentAlignment(){return this._getCurrentAlignment()}get currentDockPosition(){return this._getCurrentDockPosition()}get dockOptions(){return this._get("dockOptions")||
D}set dockOptions(v){var e={...D};const d=this.viewModel?.view?.breakpoints;var a={};d&&(a.width=d.xsmall,a.height=d.xsmall);v={...e,...v};e={...e.breakpoint,...a};({breakpoint:a}=v);"object"===typeof a?v.breakpoint={...e,...a}:a&&(v.breakpoint=e);this._set("dockOptions",v);this._setCurrentDockPosition();this.reposition()}get featureCount(){return this.viewModel.featureCount}get featureMenuOpen(){return this.viewModel.featureMenuOpen}set featureMenuOpen(v){this.viewModel.featureMenuOpen=v}get features(){return this.viewModel.features}set features(v){this.viewModel.features=
v}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(v){this.viewModel.goToOverride=v}get highlightEnabled(){return this.viewModel.highlightEnabled}set highlightEnabled(v){this.viewModel.highlightEnabled=v}get location(){return this.viewModel.location}set location(v){this.viewModel.location=v}get label(){return this.messages?.widgetLabel??""}set label(v){this._overrideIfSome("label",v)}get promises(){return this.viewModel.promises}set promises(v){this.viewModel.promises=v}get selectedFeature(){return this.viewModel.selectedFeature}get selectedFeatureIndex(){return this.viewModel.selectedFeatureIndex}set selectedFeatureIndex(v){this.viewModel.selectedFeatureIndex=
v}get selectedFeatureWidget(){return this._featuresWidget.selectedFeatureWidget}get spinnerEnabled(){k.deprecatedProperty(h.getLogger(this),"spinnerEnabled",{replacement:"PopupVisibleElements.spinner",version:"4.29"});return this.visibleElements.spinner}set spinnerEnabled(v){k.deprecatedProperty(h.getLogger(this),"spinnerEnabled",{replacement:"PopupVisibleElements.spinner",version:"4.29"});this.visibleElements.spinner=v}get title(){return this.viewModel.title}set title(v){this.viewModel.title=v}get updateLocationEnabled(){return this.viewModel.updateLocationEnabled}set updateLocationEnabled(v){this.viewModel.updateLocationEnabled=
v}get view(){return this.viewModel.view}set view(v){this.viewModel.view=v}get visible(){return this.viewModel.visible}set visible(v){this.viewModel.visible=v}blur(){const {active:v}=this.viewModel;v||h.getLogger(this).warn("Popup can only be blurred when currently active.");this._featuresWidget.blur()}clear(){return this.viewModel.clear()}close(){this.visible=!1}fetchFeatures(v,e){return this.viewModel.fetchFeatures(v,e)}focus(){const {active:v}=this.viewModel;v||h.getLogger(this).warn("Popup can only be focused when currently active.");
this.reposition();requestAnimationFrame(()=>{this._featuresWidget.focus()})}next(){return this.viewModel.next()}open(v){this.set({collapsed:v?!!v.collapsed:!1,featureMenuOpen:v?!!v.featureMenuOpen:!1});this.viewModel.open(v);this._shouldFocus(v)}previous(){return this.viewModel.previous()}reposition(){this.renderNow();this._positionContainer();this._setCurrentAlignment()}triggerAction(v){return this.viewModel.triggerAction(v)}render(){const {dockEnabled:v,currentAlignment:e,currentDockPosition:d}=
this,{active:a}=this.viewModel,m=this.selectedFeature?.layer?.title,A=this.selectedFeature?.layer?.id;return p.tsx("div",{afterCreate:this._positionContainer,afterUpdate:this._positionContainer,bind:this,class:this.classes(c.css.base,{[c.css.alignTopCenter]:"top-center"===e,[c.css.alignBottomCenter]:"bottom-center"===e,[c.css.alignTopLeft]:"top-left"===e,[c.css.alignBottomLeft]:"bottom-left"===e,[c.css.alignTopRight]:"top-right"===e,[c.css.alignBottomRight]:"bottom-right"===e,[c.css.isDocked]:a&&
v,[c.css.shadow]:a&&!v,[c.css.isDockedTopLeft]:"top-left"===d,[c.css.isDockedTopCenter]:"top-center"===d,[c.css.isDockedTopRight]:"top-right"===d,[c.css.isDockedBottomLeft]:"bottom-left"===d,[c.css.isDockedBottomCenter]:"bottom-center"===d,[c.css.isDockedBottomRight]:"bottom-right"===d}),"data-layer-id":A,"data-layer-title":m,role:"presentation"},a?[this._renderMainContainer(),this._renderPointer()]:null)}_renderPointer(){return this.dockEnabled?null:p.tsx("div",{class:c.css.pointer,key:"popup-pointer",
role:"presentation"},p.tsx("div",{class:this.classes(c.css.pointerDirection,c.css.shadow)}))}_renderMainContainer(){const {dockEnabled:v}=this;return p.tsx("div",{afterCreate:this._setMainContainerNode,afterUpdate:this._setMainContainerNode,bind:this,class:this.classes(c.css.main,l.globalCss.widget,{[c.css.shadow]:v})},this._featuresWidget.render())}async _shouldFocus(v){v?.shouldFocus&&(await y.whenOnce(()=>!0===this.viewModel?.active),this.focus())}_isOutsideView(v){const {popupHeight:e,popupWidth:d,
screenLocation:a,side:m,view:A}=v;if(isNaN(d)||isNaN(e)||!A||!a)return!1;v=A.padding;return"right"===m&&a.x+d/2>A.width-v.right||"left"===m&&a.x-d/2<v.left||"top"===m&&a.y-e<v.top||"bottom"===m&&a.y+e>A.height-v.bottom?!0:!1}_calculateAutoAlignment(v){if("auto"!==v)return v;const {_pointerOffsetInPx:e,_containerNode:d,_mainContainerNode:a,viewModel:m}=this,{screenLocation:A,view:I}=m;if(null==A||!I||!d)return"top-center";var O=(v=a?window.getComputedStyle(a,null):null)?parseInt(v.getPropertyValue("max-height").replaceAll(/[^-\d\.]/g,
""),10):0,S=v?parseInt(v.getPropertyValue("height").replaceAll(/[^-\d\.]/g,""),10):0;const {height:f,width:B}=d.getBoundingClientRect();v=B+e;const G=Math.max(f,O,S)+e;O=this._isOutsideView({popupHeight:G,popupWidth:v,screenLocation:A,side:"right",view:I});S=this._isOutsideView({popupHeight:G,popupWidth:v,screenLocation:A,side:"left",view:I});const u=this._isOutsideView({popupHeight:G,popupWidth:v,screenLocation:A,side:"top",view:I});v=this._isOutsideView({popupHeight:G,popupWidth:v,screenLocation:A,
side:"bottom",view:I});return S?u?"bottom-right":"top-right":O?u?"bottom-left":"top-left":u?v?"top-center":"bottom-center":"top-center"}_callCurrentAlignment(v){return"function"===typeof v?v.call(this):v}_getCurrentAlignment(){const {alignment:v,dockEnabled:e}=this;return e||!this.viewModel.active?null:this._calculatePositionResult(this._calculateAutoAlignment(this._callCurrentAlignment(v)))}_setCurrentAlignment(){this._set("currentAlignment",this._getCurrentAlignment())}_setCurrentDockPosition(){this._set("currentDockPosition",
this._getCurrentDockPosition())}_calculatePositionResult(v){const e=["left","right"];x.isRTL(this.container)&&e.reverse();return v?.replace(/leading/gi,e[0]).replaceAll(/trailing/gi,e[1])}_callDockPosition(v){return"function"===typeof v?v.call(this):v}_getDockPosition(){return this._calculatePositionResult(this._calculateAutoDockPosition(this._callDockPosition(this.dockOptions?.position)))}_getCurrentDockPosition(){return this.dockEnabled&&this.viewModel.active?this._getDockPosition():null}_calculateAutoDockPosition(v){if("auto"!==
v)return v;var e=this.viewModel?.view;v=x.isRTL(this.container)?"top-left":"top-right";if(!e)return v;var d=e.padding||{left:0,right:0,top:0,bottom:0};d=e.width-d.left-d.right;({breakpoints:e}=e);return e&&d<=e.xsmall?"bottom-center":v}_getDockIcon(){const v=this._getDockPosition();if(this.dockEnabled)return"minimize";switch(v){case "top-left":case "bottom-left":return"dock-left";case "top-center":return"maximize";case "bottom-center":return"dock-bottom";default:return"dock-right"}}_handleDockIcon(){this._dockAction.icon=
this._getDockIcon()}_handleDockEnabled(){this._dockAction.title=this.dockEnabled?this.messages?.undock:this.messages?.dock}_setMainContainerNode(v){this._mainContainerNode=v}_positionContainer(v=this._containerNode){v&&(this._containerNode=v);if(this._containerNode){({screenLocation:v}=this.viewModel);var {width:e}=this._containerNode.getBoundingClientRect();(v=this._calculatePositionStyle(v,e))&&Object.assign(this._containerNode.style,v)}}_calculateFullWidth(v){const {currentAlignment:e,_pointerOffsetInPx:d}=
this;return"top-left"===e||"bottom-left"===e||"top-right"===e||"bottom-right"===e?v+d:v}_calculateAlignmentPosition(v,e,d,a){const {currentAlignment:m,_pointerOffsetInPx:A}=this;if(d){var {padding:I}=d;a/=2;var O=d.height-e;d=d.width-v;if("bottom-center"===m)return{top:e+A-I.top,left:v-a-I.left};if("top-left"===m)return{bottom:O+A-I.bottom,right:d+A-I.right};if("bottom-left"===m)return{top:e+A-I.top,right:d+A-I.right};if("top-right"===m)return{bottom:O+A-I.bottom,left:v+A-I.left};if("bottom-right"===
m)return{top:e+A-I.top,left:v+A-I.left};if("top-center"===m)return{bottom:O+A-I.bottom,left:v-a-I.left}}}_calculatePositionStyle(v,e){const {dockEnabled:d,view:a}=this;if(a){if(d)return{left:"",top:"",right:"",bottom:""};if(null!=v&&e&&(e=this._calculateFullWidth(e),v=this._calculateAlignmentPosition(v.x,v.y,a,e)))return{top:void 0!==v.top?`${v.top}px`:"auto",left:void 0!==v.left?`${v.left}px`:"auto",bottom:void 0!==v.bottom?`${v.bottom}px`:"auto",right:void 0!==v.right?`${v.right}px`:"auto"}}}_viewChange(v,
e){v&&e&&(this.close(),this.clear())}_viewReadyChange(v,e){v?this._wireUpView():e&&(this.close(),this.clear())}_wireUpView(){this._setDockEnabledForViewSize(this.dockOptions)}_dockingThresholdCrossed(v,e,d){const [a,m]=v,[A,I]=e,{width:O=0,height:S=0}=d??{};return a<=O&&A>O||a>O&&A<=O||m<=S&&I>S||m>S&&I<=S}_updateDockEnabledForViewSize(v,e){if(v&&e){var d=this.viewModel?.view?.padding||{left:0,right:0,top:0,bottom:0},a=d.left+d.right,m=d.top+d.bottom;d=[];var A=[];d[0]=v[0]-a;d[1]=v[1]-m;A[0]=e[0]-
a;A[1]=e[1]-m;({dockOptions:v}=this);this._dockingThresholdCrossed(d,A,v.breakpoint)&&this._setDockEnabledForViewSize(v);this._setCurrentDockPosition()}}_toggleScreenLocationEnabled(){const {dockEnabled:v,viewModel:e}=this;e&&(e.screenLocationEnabled=e.active&&!v)}_shouldDockAtCurrentViewSize(v){v=v.breakpoint;var e=this.viewModel?.view?.ui;if(!e)return!1;const {width:d,height:a}=e;if(isNaN(d)||isNaN(a)||!v)return!1;e=v.hasOwnProperty("width")&&d<=(v.width??0);v=v.hasOwnProperty("height")&&a<=(v.height??
0);return e||v}_setDockEnabledForViewSize(v){v.breakpoint&&(this.dockEnabled=this._shouldDockAtCurrentViewSize(v))}};b.__decorate([w.property({readOnly:!0})],C.prototype,"_featureNavigationTop",null);b.__decorate([w.property()],C.prototype,"actions",null);b.__decorate([w.property()],C.prototype,"alignment",void 0);b.__decorate([w.property()],C.prototype,"autoCloseEnabled",null);b.__decorate([w.property()],C.prototype,"autoOpenEnabled",null);b.__decorate([w.property()],C.prototype,"defaultPopupTemplateEnabled",
null);b.__decorate([w.property()],C.prototype,"content",null);b.__decorate([w.property()],C.prototype,"collapsed",void 0);b.__decorate([w.property()],C.prototype,"collapseEnabled",null);b.__decorate([w.property({readOnly:!0})],C.prototype,"currentAlignment",null);b.__decorate([w.property({readOnly:!0})],C.prototype,"currentDockPosition",null);b.__decorate([w.property()],C.prototype,"dockOptions",null);b.__decorate([w.property()],C.prototype,"dockEnabled",void 0);b.__decorate([w.property({readOnly:!0})],
C.prototype,"featureCount",null);b.__decorate([w.property()],C.prototype,"featureMenuOpen",null);b.__decorate([w.property()],C.prototype,"features",null);b.__decorate([w.property()],C.prototype,"goToOverride",null);b.__decorate([w.property()],C.prototype,"headingLevel",void 0);b.__decorate([w.property()],C.prototype,"highlightEnabled",null);b.__decorate([w.property()],C.prototype,"location",null);b.__decorate([w.property()],C.prototype,"label",null);b.__decorate([w.property(),q.messageBundle("esri/widgets/Popup/t9n/Popup")],
C.prototype,"messages",void 0);b.__decorate([w.property()],C.prototype,"promises",null);b.__decorate([w.property({readOnly:!0})],C.prototype,"selectedFeature",null);b.__decorate([w.property()],C.prototype,"selectedFeatureIndex",null);b.__decorate([w.property({readOnly:!0})],C.prototype,"selectedFeatureWidget",null);b.__decorate([w.property()],C.prototype,"spinnerEnabled",null);b.__decorate([w.property()],C.prototype,"title",null);b.__decorate([w.property()],C.prototype,"updateLocationEnabled",null);
b.__decorate([w.property()],C.prototype,"view",null);b.__decorate([w.property({type:n}),z.vmEvent(["triggerAction","trigger-action"])],C.prototype,"viewModel",void 0);b.__decorate([w.property()],C.prototype,"visible",null);b.__decorate([w.property({type:g,nonNullable:!0})],C.prototype,"visibleElements",void 0);return C=b.__decorate([K.subclass("esri.widgets.Popup")],C)});